{"version":3,"file":"chatkit.js","sources":["../../node_modules/@pusher/platform/dist/web/pusher-platform.js","../../node_modules/ramda/es/internal/_isPlaceholder.js","../../node_modules/ramda/es/internal/_curry1.js","../../node_modules/ramda/es/internal/_curry2.js","../../node_modules/ramda/es/internal/_concat.js","../../node_modules/ramda/es/internal/_arity.js","../../node_modules/ramda/es/internal/_curryN.js","../../node_modules/ramda/es/curryN.js","../../node_modules/ramda/es/internal/_curry3.js","../../node_modules/ramda/es/internal/_isArray.js","../../node_modules/ramda/es/internal/_dispatchable.js","../../node_modules/ramda/es/internal/_isTransformer.js","../../node_modules/ramda/es/internal/_xfBase.js","../../node_modules/ramda/es/max.js","../../node_modules/ramda/es/internal/_map.js","../../node_modules/ramda/es/internal/_isString.js","../../node_modules/ramda/es/internal/_isArrayLike.js","../../node_modules/ramda/es/internal/_xwrap.js","../../node_modules/ramda/es/bind.js","../../node_modules/ramda/es/internal/_reduce.js","../../node_modules/ramda/es/internal/_xmap.js","../../node_modules/ramda/es/internal/_has.js","../../node_modules/ramda/es/internal/_isArguments.js","../../node_modules/ramda/es/keys.js","../../node_modules/ramda/es/map.js","../../node_modules/ramda/es/path.js","../../node_modules/ramda/es/prop.js","../../node_modules/ramda/es/reduce.js","../../node_modules/ramda/es/append.js","../../node_modules/ramda/es/values.js","../../node_modules/ramda/es/type.js","../../node_modules/ramda/es/internal/_pipe.js","../../node_modules/ramda/es/internal/_checkForMethod.js","../../node_modules/ramda/es/slice.js","../../node_modules/ramda/es/tail.js","../../node_modules/ramda/es/pipe.js","../../node_modules/ramda/es/reverse.js","../../node_modules/ramda/es/compose.js","../../node_modules/ramda/es/internal/_arrayFromIterator.js","../../node_modules/ramda/es/internal/_containsWith.js","../../node_modules/ramda/es/identical.js","../../node_modules/ramda/es/internal/_equals.js","../../node_modules/ramda/es/internal/_functionName.js","../../node_modules/ramda/es/equals.js","../../node_modules/ramda/es/internal/_contains.js","../../node_modules/ramda/es/internal/_indexOf.js","../../node_modules/ramda/es/internal/_quote.js","../../node_modules/ramda/es/internal/_toISOString.js","../../node_modules/ramda/es/internal/_xfilter.js","../../node_modules/ramda/es/filter.js","../../node_modules/ramda/es/internal/_isObject.js","../../node_modules/ramda/es/internal/_filter.js","../../node_modules/ramda/es/reject.js","../../node_modules/ramda/es/internal/_complement.js","../../node_modules/ramda/es/toString.js","../../node_modules/ramda/es/internal/_toString.js","../../node_modules/ramda/es/contains.js","../../node_modules/ramda/es/difference.js","../../node_modules/ramda/es/forEach.js","../../node_modules/ramda/es/forEachObjIndexed.js","../../node_modules/ramda/es/has.js","../../node_modules/ramda/es/internal/_identity.js","../../node_modules/ramda/es/identity.js","../../node_modules/ramda/es/internal/_Set.js","../../node_modules/ramda/es/uniqBy.js","../../node_modules/ramda/es/uniq.js","../../node_modules/ramda/es/invoker.js","../../node_modules/ramda/es/internal/_isFunction.js","../../node_modules/ramda/es/join.js","../../node_modules/ramda/es/partialRight.js","../../node_modules/ramda/es/sort.js","../../node_modules/ramda/es/split.js","../../node_modules/ramda/es/toPairs.js","../../node_modules/ramda/es/trim.js","../../src/utils.js","../../src/token-provider.js","../../src/parsers.js","../../src/user.js","../../src/user-store.js","../../src/room.js","../../src/room-store.js","../../src/cursor.js","../../src/cursor-store.js","../../src/constants.js","../../src/typing-indicators.js","../../src/user-subscription.js","../../src/reconnection-handlers.js","../../src/presence-subscription.js","../../src/user-presence-subscription.js","../../src/cursor-subscription.js","../../src/attachment.js","../../src/message.js","../../src/message-subscription.js","../../src/membership-subscription.js","../../src/room-subscription.js","../../src/current-user.js","../../src/main.js","../../src/chat-manager.js"],"sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"PusherPlatform\"] = factory();\n\telse\n\t\troot[\"PusherPlatform\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 10);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nfunction responseToHeadersObject(headerStr) {\n    var headers = {};\n    if (!headerStr) {\n        return headers;\n    }\n    var headerPairs = headerStr.split('\\u000d\\u000a');\n    for (var _i = 0, headerPairs_1 = headerPairs; _i < headerPairs_1.length; _i++) {\n        var headerPair = headerPairs_1[_i];\n        var index = headerPair.indexOf('\\u003a\\u0020');\n        if (index > 0) {\n            var key = headerPair.substring(0, index);\n            var val = headerPair.substring(index + 2);\n            headers[key] = val;\n        }\n    }\n    return headers;\n}\nexports.responseToHeadersObject = responseToHeadersObject;\nvar ErrorResponse = (function () {\n    function ErrorResponse(statusCode, headers, info) {\n        this.statusCode = statusCode;\n        this.headers = headers;\n        this.info = info;\n    }\n    ErrorResponse.fromXHR = function (xhr) {\n        var errorInfo = xhr.responseText;\n        try {\n            errorInfo = JSON.parse(xhr.responseText);\n        }\n        catch (e) {\n        }\n        return new ErrorResponse(xhr.status, responseToHeadersObject(xhr.getAllResponseHeaders()), errorInfo);\n    };\n    return ErrorResponse;\n}());\nexports.ErrorResponse = ErrorResponse;\nvar NetworkError = (function () {\n    function NetworkError(error) {\n        this.error = error;\n    }\n    return NetworkError;\n}());\nexports.NetworkError = NetworkError;\nvar ProtocolError = (function () {\n    function ProtocolError(error) {\n        this.error = error;\n    }\n    return ProtocolError;\n}());\nexports.ProtocolError = ProtocolError;\nvar XhrReadyState;\n(function (XhrReadyState) {\n    XhrReadyState[XhrReadyState[\"UNSENT\"] = 0] = \"UNSENT\";\n    XhrReadyState[XhrReadyState[\"OPENED\"] = 1] = \"OPENED\";\n    XhrReadyState[XhrReadyState[\"HEADERS_RECEIVED\"] = 2] = \"HEADERS_RECEIVED\";\n    XhrReadyState[XhrReadyState[\"LOADING\"] = 3] = \"LOADING\";\n    XhrReadyState[XhrReadyState[\"DONE\"] = 4] = \"DONE\";\n})(XhrReadyState = exports.XhrReadyState || (exports.XhrReadyState = {}));\n\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar LogLevel;\n(function (LogLevel) {\n    LogLevel[LogLevel[\"VERBOSE\"] = 1] = \"VERBOSE\";\n    LogLevel[LogLevel[\"DEBUG\"] = 2] = \"DEBUG\";\n    LogLevel[LogLevel[\"INFO\"] = 3] = \"INFO\";\n    LogLevel[LogLevel[\"WARNING\"] = 4] = \"WARNING\";\n    LogLevel[LogLevel[\"ERROR\"] = 5] = \"ERROR\";\n})(LogLevel = exports.LogLevel || (exports.LogLevel = {}));\nvar ConsoleLogger = (function () {\n    function ConsoleLogger(threshold) {\n        if (threshold === void 0) { threshold = 2; }\n        this.threshold = threshold;\n        var groups = Array();\n        var hr = '--------------------------------------------------------------------------------';\n        if (!window.console.group) {\n            window.console.group = function (label) {\n                groups.push(label);\n                window.console.log('%c \\nBEGIN GROUP: %c', hr, label);\n            };\n        }\n        if (!window.console.groupEnd) {\n            window.console.groupEnd = function () {\n                window.console.log('END GROUP: %c\\n%c', groups.pop(), hr);\n            };\n        }\n    }\n    ConsoleLogger.prototype.verbose = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        this.log(window.console.log, LogLevel.VERBOSE, items);\n    };\n    ConsoleLogger.prototype.debug = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        this.log(window.console.log, LogLevel.DEBUG, items);\n    };\n    ConsoleLogger.prototype.info = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        this.log(window.console.info, LogLevel.INFO, items);\n    };\n    ConsoleLogger.prototype.warn = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        this.log(window.console.warn, LogLevel.WARNING, items);\n    };\n    ConsoleLogger.prototype.error = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n        this.log(window.console.error, LogLevel.ERROR, items);\n    };\n    ConsoleLogger.prototype.log = function (logFunction, level, items) {\n        var _this = this;\n        if (level >= this.threshold) {\n            var loggerSignature_1 = \"Logger.\" + LogLevel[level];\n            if (items.length > 1) {\n                window.console.group();\n                items.forEach(function (item) {\n                    _this.errorAwareLog(logFunction, item, loggerSignature_1);\n                });\n                window.console.groupEnd();\n            }\n            else {\n                this.errorAwareLog(logFunction, items[0], loggerSignature_1);\n            }\n        }\n    };\n    ConsoleLogger.prototype.errorAwareLog = function (logFunction, item, loggerSignature) {\n        if (item != null && item.info && item.info.error_uri) {\n            var errorDesc = item.info.error_description;\n            var errorIntro = errorDesc ? errorDesc : 'An error has occurred';\n            logFunction(errorIntro + \". More information can be found at \" + item.info.error_uri + \". Error object: \", item);\n        }\n        else {\n            logFunction(loggerSignature + \": \", item);\n        }\n    };\n    return ConsoleLogger;\n}());\nexports.ConsoleLogger = ConsoleLogger;\nvar EmptyLogger = (function () {\n    function EmptyLogger() {\n    }\n    EmptyLogger.prototype.verbose = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n    };\n    EmptyLogger.prototype.debug = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n    };\n    EmptyLogger.prototype.info = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n    };\n    EmptyLogger.prototype.warn = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n    };\n    EmptyLogger.prototype.error = function () {\n        var items = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            items[_i] = arguments[_i];\n        }\n    };\n    return EmptyLogger;\n}());\nexports.EmptyLogger = EmptyLogger;\n\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nexports.createRetryStrategyOptionsOrDefault = function (options) {\n    var initialTimeoutMillis = options.initialTimeoutMillis || 1000;\n    var maxTimeoutMillis = options.maxTimeoutMillis || 5000;\n    var limit = -1;\n    if (options.limit !== undefined && options.limit != null) {\n        limit = options.limit;\n    }\n    var increaseTimeout;\n    if (options.increaseTimeout !== undefined) {\n        increaseTimeout = options.increaseTimeout;\n    }\n    else {\n        increaseTimeout = function (currentTimeout) {\n            if (currentTimeout * 2 > maxTimeoutMillis) {\n                return maxTimeoutMillis;\n            }\n            else {\n                return currentTimeout * 2;\n            }\n        };\n    }\n    return {\n        increaseTimeout: increaseTimeout,\n        initialTimeoutMillis: initialTimeoutMillis,\n        limit: limit,\n        maxTimeoutMillis: maxTimeoutMillis,\n    };\n};\nvar Retry = (function () {\n    function Retry(waitTimeMillis) {\n        this.waitTimeMillis = waitTimeMillis;\n    }\n    return Retry;\n}());\nexports.Retry = Retry;\nvar DoNotRetry = (function () {\n    function DoNotRetry(error) {\n        this.error = error;\n    }\n    return DoNotRetry;\n}());\nexports.DoNotRetry = DoNotRetry;\nvar requestMethodIsSafe = function (method) {\n    method = method.toUpperCase();\n    return (method === 'GET' ||\n        method === 'HEAD' ||\n        method === 'OPTIONS' ||\n        method === 'SUBSCRIBE');\n};\nvar RetryResolution = (function () {\n    function RetryResolution(options, logger, retryUnsafeRequests) {\n        this.options = options;\n        this.logger = logger;\n        this.retryUnsafeRequests = retryUnsafeRequests;\n        this.currentRetryCount = 0;\n        this.initialTimeoutMillis = options.initialTimeoutMillis;\n        this.maxTimeoutMillis = options.maxTimeoutMillis;\n        this.limit = options.limit;\n        this.increaseTimeoutFunction = options.increaseTimeout;\n        this.currentBackoffMillis = this.initialTimeoutMillis;\n    }\n    RetryResolution.prototype.attemptRetry = function (error) {\n        this.logger.verbose(this.constructor.name + \": Error received\", error);\n        if (this.currentRetryCount >= this.limit && this.limit >= 0) {\n            this.logger.verbose(this.constructor.name + \": Retry count is over the maximum limit: \" + this.limit);\n            return new DoNotRetry(error);\n        }\n        if (error == null) {\n            return new Retry(this.calculateMillisToRetry());\n        }\n        if (error instanceof network_1.ErrorResponse && error.headers['Retry-After']) {\n            this.logger.verbose(this.constructor.name + \": Retry-After header is present, retrying in \" + error.headers['Retry-After']);\n            return new Retry(parseInt(error.headers['Retry-After'], 10) * 1000);\n        }\n        if (this.retryUnsafeRequests) {\n            return new Retry(this.calculateMillisToRetry());\n        }\n        switch (error.constructor) {\n            case network_1.ErrorResponse:\n                var statusCode = error.statusCode, headers = error.headers;\n                var requestMethod = headers['Request-Method'];\n                if (statusCode >= 500 &&\n                    statusCode < 600 &&\n                    requestMethodIsSafe(requestMethod)) {\n                    this.logger.verbose(this.constructor.name + \": Encountered an error with status code \" + statusCode + \" and request method \" + requestMethod + \", will retry\");\n                    return new Retry(this.calculateMillisToRetry());\n                }\n                else {\n                    this.logger.verbose(this.constructor.name + \": Encountered an error with status code \" + statusCode + \" and request method \" + requestMethod + \", will not retry\", error);\n                    return new DoNotRetry(error);\n                }\n            case network_1.NetworkError:\n                this.logger.verbose(this.constructor.name + \": Encountered a network error, will retry\", error);\n                return new Retry(this.calculateMillisToRetry());\n            case network_1.ProtocolError:\n                this.logger.verbose(this.constructor.name + \": Encountered a protocol error, will retry\", error);\n                return new Retry(this.calculateMillisToRetry());\n            default:\n                this.logger.verbose(this.constructor.name + \": Encountered an error, will retry\", error);\n                return new Retry(this.calculateMillisToRetry());\n        }\n    };\n    RetryResolution.prototype.calculateMillisToRetry = function () {\n        this.currentBackoffMillis = this.increaseTimeoutFunction(this.currentBackoffMillis);\n        this.logger.verbose(this.constructor.name + \": Retrying in \" + this.currentBackoffMillis + \"ms\");\n        return this.currentBackoffMillis;\n    };\n    return RetryResolution;\n}());\nexports.RetryResolution = RetryResolution;\n\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar logger_1 = __webpack_require__(1);\nvar request_1 = __webpack_require__(4);\nvar resuming_subscription_1 = __webpack_require__(5);\nvar retrying_subscription_1 = __webpack_require__(6);\nvar subscribe_strategy_1 = __webpack_require__(11);\nvar subscription_1 = __webpack_require__(12);\nvar token_providing_subscription_1 = __webpack_require__(7);\nvar http_1 = __webpack_require__(13);\nvar websocket_1 = __webpack_require__(14);\nvar transports_1 = __webpack_require__(8);\nvar BaseClient = (function () {\n    function BaseClient(options) {\n        this.options = options;\n        this.host = options.host.replace(/(\\/)+$/, '');\n        var logger = options.logger || new logger_1.ConsoleLogger();\n        this.logger = logger;\n        this.websocketTransport = new websocket_1.default(this.host, logger);\n        this.httpTransport = new http_1.default(this.host, options.encrypted);\n        this.sdkProduct = options.sdkProduct || 'unknown';\n        this.sdkVersion = options.sdkVersion || 'unknown';\n        this.sdkPlatform = navigator\n            ? navigator.product === 'ReactNative' ? 'react-native' : 'web'\n            : 'node';\n    }\n    BaseClient.prototype.request = function (options, tokenParams) {\n        var _this = this;\n        if (options.tokenProvider) {\n            return options.tokenProvider\n                .fetchToken(tokenParams)\n                .then(function (token) {\n                var _a;\n                if (options.headers !== undefined) {\n                    options.headers['Authorization'] = \"Bearer \" + token;\n                }\n                else {\n                    options.headers = (_a = {},\n                        _a['Authorization'] = \"Bearer \" + token,\n                        _a);\n                }\n                return options;\n            })\n                .then(function (optionsWithToken) { return _this.makeRequest(optionsWithToken); });\n        }\n        return this.makeRequest(options);\n    };\n    BaseClient.prototype.subscribeResuming = function (path, headers, listeners, retryStrategyOptions, initialEventId, tokenProvider) {\n        var completeListeners = subscription_1.replaceMissingListenersWithNoOps(listeners);\n        var subscribeStrategyListeners = subscribe_strategy_1.subscribeStrategyListenersFromSubscriptionListeners(completeListeners);\n        var subscriptionStrategy = resuming_subscription_1.createResumingStrategy(retryStrategyOptions, token_providing_subscription_1.createTokenProvidingStrategy(transports_1.createTransportStrategy(path, this.websocketTransport, this.logger), this.logger, tokenProvider), this.logger, initialEventId);\n        var opened = false;\n        return subscriptionStrategy({\n            onEnd: subscribeStrategyListeners.onEnd,\n            onError: subscribeStrategyListeners.onError,\n            onEvent: subscribeStrategyListeners.onEvent,\n            onOpen: function (subHeaders) {\n                if (!opened) {\n                    opened = true;\n                    subscribeStrategyListeners.onOpen(subHeaders);\n                }\n                completeListeners.onSubscribe();\n            },\n            onRetrying: subscribeStrategyListeners.onRetrying,\n        }, __assign({}, headers, this.infoHeaders()));\n    };\n    BaseClient.prototype.subscribeNonResuming = function (path, headers, listeners, retryStrategyOptions, tokenProvider) {\n        var completeListeners = subscription_1.replaceMissingListenersWithNoOps(listeners);\n        var subscribeStrategyListeners = subscribe_strategy_1.subscribeStrategyListenersFromSubscriptionListeners(completeListeners);\n        var subscriptionStrategy = retrying_subscription_1.createRetryingStrategy(retryStrategyOptions, token_providing_subscription_1.createTokenProvidingStrategy(transports_1.createTransportStrategy(path, this.websocketTransport, this.logger), this.logger, tokenProvider), this.logger);\n        var opened = false;\n        return subscriptionStrategy({\n            onEnd: subscribeStrategyListeners.onEnd,\n            onError: subscribeStrategyListeners.onError,\n            onEvent: subscribeStrategyListeners.onEvent,\n            onOpen: function (subHeaders) {\n                if (!opened) {\n                    opened = true;\n                    subscribeStrategyListeners.onOpen(subHeaders);\n                }\n                completeListeners.onSubscribe();\n            },\n            onRetrying: subscribeStrategyListeners.onRetrying,\n        }, __assign({}, headers, this.infoHeaders()));\n    };\n    BaseClient.prototype.infoHeaders = function () {\n        return {\n            'X-SDK-Language': 'javascript',\n            'X-SDK-Platform': this.sdkPlatform,\n            'X-SDK-Product': this.sdkProduct,\n            'X-SDK-Version': this.sdkVersion,\n        };\n    };\n    BaseClient.prototype.makeRequest = function (options) {\n        var _this = this;\n        return request_1.executeNetworkRequest(function () {\n            return _this.httpTransport.request(__assign({}, options, { headers: __assign({}, options.headers, _this.infoHeaders()) }));\n        }, options).catch(function (error) {\n            _this.logger.error(error);\n            throw error;\n        });\n    };\n    return BaseClient;\n}());\nexports.BaseClient = BaseClient;\n\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nfunction executeNetworkRequest(createXhr, options) {\n    return new Promise(function (resolve, reject) {\n        var xhr = attachOnReadyStateChangeHandler(createXhr(), resolve, reject);\n        sendBody(xhr, options);\n    });\n}\nexports.executeNetworkRequest = executeNetworkRequest;\nfunction sendBody(xhr, options) {\n    if (options.json) {\n        xhr.send(JSON.stringify(options.json));\n    }\n    else {\n        xhr.send(options.body);\n    }\n}\nfunction sendRawRequest(options) {\n    return new Promise(function (resolve, reject) {\n        var xhr = attachOnReadyStateChangeHandler(new window.XMLHttpRequest(), resolve, reject);\n        xhr.open(options.method.toUpperCase(), options.url, true);\n        if (options.headers) {\n            for (var key in options.headers) {\n                if (options.headers.hasOwnProperty(key)) {\n                    xhr.setRequestHeader(key, options.headers[key]);\n                }\n            }\n        }\n        xhr.send(options.body);\n    });\n}\nexports.sendRawRequest = sendRawRequest;\nfunction attachOnReadyStateChangeHandler(xhr, resolve, reject) {\n    xhr.onreadystatechange = function () {\n        if (xhr.readyState === 4) {\n            if (xhr.status >= 200 && xhr.status < 300) {\n                resolve(xhr.response);\n            }\n            else if (xhr.status !== 0) {\n                reject(network_1.ErrorResponse.fromXHR(xhr));\n            }\n            else {\n                reject(new network_1.NetworkError('No Connection'));\n            }\n        }\n    };\n    return xhr;\n}\n\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nvar retry_strategy_1 = __webpack_require__(2);\nexports.createResumingStrategy = function (retryOptions, nextSubscribeStrategy, logger, initialEventId) {\n    var completeRetryOptions = retry_strategy_1.createRetryStrategyOptionsOrDefault(retryOptions);\n    var retryResolution = new retry_strategy_1.RetryResolution(completeRetryOptions, logger);\n    return function (listeners, headers) {\n        return new ResumingSubscription(logger, headers, nextSubscribeStrategy, listeners, retryResolution);\n    };\n};\nvar ResumingSubscription = (function () {\n    function ResumingSubscription(logger, headers, nextSubscribeStrategy, listeners, retryResolution) {\n        var _this = this;\n        this.unsubscribe = function () {\n            _this.state.unsubscribe();\n        };\n        this.onTransition = function (newState) {\n            _this.state = newState;\n        };\n        this.state = new OpeningSubscriptionState(this.onTransition, logger, headers, nextSubscribeStrategy, listeners, retryResolution);\n    }\n    return ResumingSubscription;\n}());\nvar OpeningSubscriptionState = (function () {\n    function OpeningSubscriptionState(onTransition, logger, headers, nextSubscribeStrategy, listeners, retryResolution, initialEventId) {\n        var _this = this;\n        this.onTransition = onTransition;\n        this.logger = logger;\n        this.headers = headers;\n        this.nextSubscribeStrategy = nextSubscribeStrategy;\n        this.listeners = listeners;\n        this.retryResolution = retryResolution;\n        this.initialEventId = initialEventId;\n        var lastEventId = initialEventId;\n        logger.verbose(\"ResumingSubscription: transitioning to OpeningSubscriptionState\");\n        if (lastEventId) {\n            headers['Last-Event-Id'] = lastEventId;\n            logger.verbose(\"ResumingSubscription: initialEventId is \" + lastEventId);\n        }\n        this.underlyingSubscription = nextSubscribeStrategy({\n            onEnd: function (error) {\n                onTransition(new EndedSubscriptionState(logger, listeners, error));\n            },\n            onError: function (error) {\n                onTransition(new ResumingSubscriptionState(error, onTransition, logger, headers, listeners, nextSubscribeStrategy, retryResolution, lastEventId));\n            },\n            onEvent: function (event) {\n                lastEventId = event.eventId;\n                listeners.onEvent(event);\n            },\n            onOpen: function (subHeaders) {\n                onTransition(new OpenSubscriptionState(logger, subHeaders, listeners, _this.underlyingSubscription, onTransition));\n            },\n            onRetrying: listeners.onRetrying,\n        }, headers);\n    }\n    OpeningSubscriptionState.prototype.unsubscribe = function () {\n        this.onTransition(new EndingSubscriptionState(this.logger));\n        if (this.underlyingSubscription != null) {\n            this.underlyingSubscription.unsubscribe();\n        }\n    };\n    return OpeningSubscriptionState;\n}());\nvar OpenSubscriptionState = (function () {\n    function OpenSubscriptionState(logger, headers, listeners, underlyingSubscription, onTransition) {\n        this.logger = logger;\n        this.headers = headers;\n        this.listeners = listeners;\n        this.underlyingSubscription = underlyingSubscription;\n        this.onTransition = onTransition;\n        logger.verbose(\"ResumingSubscription: transitioning to OpenSubscriptionState\");\n        listeners.onOpen(headers);\n    }\n    OpenSubscriptionState.prototype.unsubscribe = function () {\n        this.onTransition(new EndingSubscriptionState(this.logger));\n        this.underlyingSubscription.unsubscribe();\n    };\n    return OpenSubscriptionState;\n}());\nvar ResumingSubscriptionState = (function () {\n    function ResumingSubscriptionState(error, onTransition, logger, headers, listeners, nextSubscribeStrategy, retryResolution, lastEventId) {\n        var _this = this;\n        this.onTransition = onTransition;\n        this.logger = logger;\n        this.headers = headers;\n        this.listeners = listeners;\n        this.nextSubscribeStrategy = nextSubscribeStrategy;\n        this.retryResolution = retryResolution;\n        this.timeout = -1;\n        logger.verbose(\"ResumingSubscription: transitioning to ResumingSubscriptionState\");\n        var executeSubscriptionOnce = function (subError, subLastEventId) {\n            listeners.onRetrying();\n            var resolveError = function (errToResolve) {\n                if (errToResolve instanceof network_1.ErrorResponse) {\n                    errToResolve.headers['Request-Method'] = 'SUBSCRIBE';\n                }\n                return retryResolution.attemptRetry(errToResolve);\n            };\n            var errorResolution = resolveError(subError);\n            if (errorResolution instanceof retry_strategy_1.Retry) {\n                _this.timeout = window.setTimeout(function () {\n                    executeNextSubscribeStrategy(subLastEventId);\n                }, errorResolution.waitTimeMillis);\n            }\n            else {\n                onTransition(new FailedSubscriptionState(logger, listeners, subError));\n            }\n        };\n        var executeNextSubscribeStrategy = function (subLastEventId) {\n            logger.verbose(\"ResumingSubscription: trying to re-establish the subscription\");\n            if (subLastEventId) {\n                logger.verbose(\"ResumingSubscription: lastEventId: \" + subLastEventId);\n                headers['Last-Event-Id'] = subLastEventId;\n            }\n            _this.underlyingSubscription = nextSubscribeStrategy({\n                onEnd: function (endError) {\n                    onTransition(new EndedSubscriptionState(logger, listeners, endError));\n                },\n                onError: function (subError) {\n                    executeSubscriptionOnce(subError, lastEventId);\n                },\n                onEvent: function (event) {\n                    lastEventId = event.eventId;\n                    listeners.onEvent(event);\n                },\n                onOpen: function (openHeaders) {\n                    onTransition(new OpenSubscriptionState(logger, openHeaders, listeners, _this.underlyingSubscription, onTransition));\n                },\n                onRetrying: listeners.onRetrying,\n            }, headers);\n        };\n        executeSubscriptionOnce(error, lastEventId);\n    }\n    ResumingSubscriptionState.prototype.unsubscribe = function () {\n        this.onTransition(new EndingSubscriptionState(this.logger));\n        window.clearTimeout(this.timeout);\n        if (this.underlyingSubscription != null) {\n            this.underlyingSubscription.unsubscribe();\n        }\n    };\n    return ResumingSubscriptionState;\n}());\nvar EndingSubscriptionState = (function () {\n    function EndingSubscriptionState(logger, error) {\n        this.logger = logger;\n        logger.verbose(\"ResumingSubscription: transitioning to EndingSubscriptionState\");\n    }\n    EndingSubscriptionState.prototype.unsubscribe = function () {\n        throw new Error('Subscription is already ending');\n    };\n    return EndingSubscriptionState;\n}());\nvar EndedSubscriptionState = (function () {\n    function EndedSubscriptionState(logger, listeners, error) {\n        this.logger = logger;\n        this.listeners = listeners;\n        logger.verbose(\"ResumingSubscription: transitioning to EndedSubscriptionState\");\n        listeners.onEnd(error);\n    }\n    EndedSubscriptionState.prototype.unsubscribe = function () {\n        throw new Error('Subscription has already ended');\n    };\n    return EndedSubscriptionState;\n}());\nvar FailedSubscriptionState = (function () {\n    function FailedSubscriptionState(logger, listeners, error) {\n        this.logger = logger;\n        this.listeners = listeners;\n        logger.verbose(\"ResumingSubscription: transitioning to FailedSubscriptionState\", error);\n        listeners.onError(error);\n    }\n    FailedSubscriptionState.prototype.unsubscribe = function () {\n        throw new Error('Subscription has already ended');\n    };\n    return FailedSubscriptionState;\n}());\n\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nvar retry_strategy_1 = __webpack_require__(2);\nexports.createRetryingStrategy = function (retryOptions, nextSubscribeStrategy, logger) {\n    var enrichedRetryOptions = retry_strategy_1.createRetryStrategyOptionsOrDefault(retryOptions);\n    var retryResolution = new retry_strategy_1.RetryResolution(enrichedRetryOptions, logger);\n    return function (listeners, headers) {\n        return new RetryingSubscription(logger, headers, listeners, nextSubscribeStrategy, retryResolution);\n    };\n};\nvar RetryingSubscription = (function () {\n    function RetryingSubscription(logger, headers, listeners, nextSubscribeStrategy, retryResolution) {\n        var _this = this;\n        this.unsubscribe = function () {\n            _this.state.unsubscribe();\n        };\n        this.onTransition = function (newState) {\n            _this.state = newState;\n        };\n        this.state = new OpeningSubscriptionState(this.onTransition, logger, headers, listeners, nextSubscribeStrategy, retryResolution);\n    }\n    return RetryingSubscription;\n}());\nvar OpeningSubscriptionState = (function () {\n    function OpeningSubscriptionState(onTransition, logger, headers, listeners, nextSubscribeStrategy, retryResolution) {\n        var _this = this;\n        this.logger = logger;\n        this.headers = headers;\n        this.listeners = listeners;\n        this.nextSubscribeStrategy = nextSubscribeStrategy;\n        this.retryResolution = retryResolution;\n        logger.verbose(\"RetryingSubscription: transitioning to OpeningSubscriptionState\");\n        this.underlyingSubscription = nextSubscribeStrategy({\n            onEnd: function (error) {\n                return onTransition(new EndedSubscriptionState(logger, listeners, error));\n            },\n            onError: function (error) {\n                return onTransition(new RetryingSubscriptionState(error, onTransition, logger, headers, listeners, nextSubscribeStrategy, retryResolution));\n            },\n            onEvent: listeners.onEvent,\n            onOpen: function (subHeaders) {\n                return onTransition(new OpenSubscriptionState(logger, listeners, subHeaders, _this.underlyingSubscription, onTransition));\n            },\n            onRetrying: listeners.onRetrying,\n        }, headers);\n    }\n    OpeningSubscriptionState.prototype.unsubscribe = function () {\n        this.underlyingSubscription.unsubscribe();\n        throw new Error('Method not implemented.');\n    };\n    return OpeningSubscriptionState;\n}());\nvar RetryingSubscriptionState = (function () {\n    function RetryingSubscriptionState(error, onTransition, logger, headers, listeners, nextSubscribeStrategy, retryResolution) {\n        var _this = this;\n        this.onTransition = onTransition;\n        this.logger = logger;\n        this.headers = headers;\n        this.listeners = listeners;\n        this.nextSubscribeStrategy = nextSubscribeStrategy;\n        this.retryResolution = retryResolution;\n        this.timeout = -1;\n        logger.verbose(\"RetryingSubscription: transitioning to RetryingSubscriptionState\");\n        var executeSubscriptionOnce = function (subError) {\n            listeners.onRetrying();\n            var resolveError = function (errToResolve) {\n                if (errToResolve instanceof network_1.ErrorResponse) {\n                    errToResolve.headers['Request-Method'] = 'SUBSCRIBE';\n                }\n                return retryResolution.attemptRetry(errToResolve);\n            };\n            var errorResolution = resolveError(subError);\n            if (errorResolution instanceof retry_strategy_1.Retry) {\n                _this.timeout = window.setTimeout(function () {\n                    executeNextSubscribeStrategy();\n                }, errorResolution.waitTimeMillis);\n            }\n            else {\n                onTransition(new FailedSubscriptionState(logger, listeners, subError));\n            }\n        };\n        var executeNextSubscribeStrategy = function () {\n            logger.verbose(\"RetryingSubscription: trying to re-establish the subscription\");\n            var underlyingSubscription = nextSubscribeStrategy({\n                onEnd: function (endError) {\n                    return onTransition(new EndedSubscriptionState(logger, listeners, endError));\n                },\n                onError: function (subError) { return executeSubscriptionOnce(subError); },\n                onEvent: listeners.onEvent,\n                onOpen: function (openHeaders) {\n                    onTransition(new OpenSubscriptionState(logger, listeners, openHeaders, underlyingSubscription, onTransition));\n                },\n                onRetrying: listeners.onRetrying,\n            }, headers);\n        };\n        executeSubscriptionOnce(error);\n    }\n    RetryingSubscriptionState.prototype.unsubscribe = function () {\n        window.clearTimeout(this.timeout);\n        this.onTransition(new EndedSubscriptionState(this.logger, this.listeners));\n    };\n    return RetryingSubscriptionState;\n}());\nvar OpenSubscriptionState = (function () {\n    function OpenSubscriptionState(logger, listeners, headers, underlyingSubscription, onTransition) {\n        this.logger = logger;\n        this.listeners = listeners;\n        this.headers = headers;\n        this.underlyingSubscription = underlyingSubscription;\n        this.onTransition = onTransition;\n        logger.verbose(\"RetryingSubscription: transitioning to OpenSubscriptionState\");\n        listeners.onOpen(headers);\n    }\n    OpenSubscriptionState.prototype.unsubscribe = function () {\n        this.underlyingSubscription.unsubscribe();\n        this.onTransition(new EndedSubscriptionState(this.logger, this.listeners));\n    };\n    return OpenSubscriptionState;\n}());\nvar EndedSubscriptionState = (function () {\n    function EndedSubscriptionState(logger, listeners, error) {\n        this.logger = logger;\n        this.listeners = listeners;\n        logger.verbose(\"RetryingSubscription: transitioning to EndedSubscriptionState\");\n        listeners.onEnd(error);\n    }\n    EndedSubscriptionState.prototype.unsubscribe = function () {\n        throw new Error('Subscription has already ended');\n    };\n    return EndedSubscriptionState;\n}());\nvar FailedSubscriptionState = (function () {\n    function FailedSubscriptionState(logger, listeners, error) {\n        this.logger = logger;\n        this.listeners = listeners;\n        logger.verbose(\"RetryingSubscription: transitioning to FailedSubscriptionState\", error);\n        listeners.onError(error);\n    }\n    FailedSubscriptionState.prototype.unsubscribe = function () {\n        throw new Error('Subscription has already ended');\n    };\n    return FailedSubscriptionState;\n}());\n\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nexports.createTokenProvidingStrategy = function (nextSubscribeStrategy, logger, tokenProvider) {\n    if (tokenProvider) {\n        return function (listeners, headers) {\n            return new TokenProvidingSubscription(logger, listeners, headers, tokenProvider, nextSubscribeStrategy);\n        };\n    }\n    return nextSubscribeStrategy;\n};\nvar TokenProvidingSubscription = (function () {\n    function TokenProvidingSubscription(logger, listeners, headers, tokenProvider, nextSubscribeStrategy) {\n        var _this = this;\n        this.logger = logger;\n        this.listeners = listeners;\n        this.headers = headers;\n        this.tokenProvider = tokenProvider;\n        this.nextSubscribeStrategy = nextSubscribeStrategy;\n        this.unsubscribe = function () {\n            _this.state.unsubscribe();\n            _this.state = new InactiveState(_this.logger);\n        };\n        this.state = new ActiveState(logger, headers, nextSubscribeStrategy);\n        this.subscribe();\n    }\n    TokenProvidingSubscription.prototype.subscribe = function () {\n        var _this = this;\n        this.tokenProvider\n            .fetchToken()\n            .then(function (token) {\n            var existingListeners = Object.assign({}, _this.listeners);\n            _this.state.subscribe(token, {\n                onEnd: function (error) {\n                    _this.state = new InactiveState(_this.logger);\n                    existingListeners.onEnd(error);\n                },\n                onError: function (error) {\n                    if (_this.isTokenExpiredError(error)) {\n                        _this.tokenProvider.clearToken(token);\n                        _this.subscribe();\n                    }\n                    else {\n                        _this.state = new InactiveState(_this.logger);\n                        existingListeners.onError(error);\n                    }\n                },\n                onEvent: _this.listeners.onEvent,\n                onOpen: _this.listeners.onOpen,\n            });\n        })\n            .catch(function (error) {\n            _this.logger.debug('TokenProvidingSubscription: error when fetching token:', error);\n            _this.state = new InactiveState(_this.logger);\n            _this.listeners.onError(error);\n        });\n    };\n    TokenProvidingSubscription.prototype.isTokenExpiredError = function (error) {\n        return (error instanceof network_1.ErrorResponse &&\n            error.statusCode === 401 &&\n            error.info === 'authentication/expired');\n    };\n    return TokenProvidingSubscription;\n}());\nvar ActiveState = (function () {\n    function ActiveState(logger, headers, nextSubscribeStrategy) {\n        this.logger = logger;\n        this.headers = headers;\n        this.nextSubscribeStrategy = nextSubscribeStrategy;\n        logger.verbose('TokenProvidingSubscription: transitioning to ActiveState');\n    }\n    ActiveState.prototype.subscribe = function (token, listeners) {\n        var _this = this;\n        this.putTokenIntoHeader(token);\n        this.underlyingSubscription = this.nextSubscribeStrategy({\n            onEnd: function (error) {\n                _this.logger.verbose('TokenProvidingSubscription: subscription ended');\n                listeners.onEnd(error);\n            },\n            onError: function (error) {\n                _this.logger.verbose('TokenProvidingSubscription: subscription errored:', error);\n                listeners.onError(error);\n            },\n            onEvent: listeners.onEvent,\n            onOpen: function (headers) {\n                _this.logger.verbose(\"TokenProvidingSubscription: subscription opened\");\n                listeners.onOpen(headers);\n            },\n            onRetrying: listeners.onRetrying,\n        }, this.headers);\n    };\n    ActiveState.prototype.unsubscribe = function () {\n        if (this.underlyingSubscription != null) {\n            this.underlyingSubscription.unsubscribe();\n        }\n    };\n    ActiveState.prototype.putTokenIntoHeader = function (token) {\n        this.headers['Authorization'] = \"Bearer \" + token;\n        this.logger.verbose(\"TokenProvidingSubscription: token fetched: \" + token);\n    };\n    return ActiveState;\n}());\nvar InactiveState = (function () {\n    function InactiveState(logger) {\n        this.logger = logger;\n        logger.verbose('TokenProvidingSubscription: transitioning to InactiveState');\n    }\n    InactiveState.prototype.subscribe = function (token, listeners) {\n        this.logger.verbose('TokenProvidingSubscription: subscribe called in Inactive state; doing nothing');\n    };\n    InactiveState.prototype.unsubscribe = function () {\n        this.logger.verbose('TokenProvidingSubscription: unsubscribe called in Inactive state; doing nothing');\n    };\n    return InactiveState;\n}());\n\n\n/***/ }),\n/* 8 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.createTransportStrategy = function (path, transport, logger) {\n    return function (listeners, headers) { return transport.subscribe(path, listeners, headers); };\n};\n\n\n/***/ }),\n/* 9 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.HOST_BASE = 'pusherplatform.io';\n\n\n/***/ }),\n/* 10 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(3);\nexports.BaseClient = base_client_1.BaseClient;\nvar host_base_1 = __webpack_require__(9);\nexports.HOST_BASE = host_base_1.HOST_BASE;\nvar instance_1 = __webpack_require__(15);\nexports.Instance = instance_1.default;\nvar logger_1 = __webpack_require__(1);\nexports.ConsoleLogger = logger_1.ConsoleLogger;\nexports.EmptyLogger = logger_1.EmptyLogger;\nvar network_1 = __webpack_require__(0);\nexports.ErrorResponse = network_1.ErrorResponse;\nexports.NetworkError = network_1.NetworkError;\nexports.responseToHeadersObject = network_1.responseToHeadersObject;\nexports.XhrReadyState = network_1.XhrReadyState;\nvar request_1 = __webpack_require__(4);\nexports.executeNetworkRequest = request_1.executeNetworkRequest;\nexports.sendRawRequest = request_1.sendRawRequest;\nvar resuming_subscription_1 = __webpack_require__(5);\nexports.createResumingStrategy = resuming_subscription_1.createResumingStrategy;\nvar retry_strategy_1 = __webpack_require__(2);\nexports.createRetryStrategyOptionsOrDefault = retry_strategy_1.createRetryStrategyOptionsOrDefault;\nexports.DoNotRetry = retry_strategy_1.DoNotRetry;\nexports.Retry = retry_strategy_1.Retry;\nexports.RetryResolution = retry_strategy_1.RetryResolution;\nvar retrying_subscription_1 = __webpack_require__(6);\nexports.createRetryingStrategy = retrying_subscription_1.createRetryingStrategy;\nvar token_providing_subscription_1 = __webpack_require__(7);\nexports.createTokenProvidingStrategy = token_providing_subscription_1.createTokenProvidingStrategy;\nvar transports_1 = __webpack_require__(8);\nexports.createTransportStrategy = transports_1.createTransportStrategy;\nexports.default = {\n    BaseClient: base_client_1.BaseClient,\n    ConsoleLogger: logger_1.ConsoleLogger,\n    EmptyLogger: logger_1.EmptyLogger,\n    Instance: instance_1.default,\n};\n\n\n/***/ }),\n/* 11 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.subscribeStrategyListenersFromSubscriptionListeners = function (subListeners) {\n    return {\n        onEnd: subListeners.onEnd,\n        onError: subListeners.onError,\n        onEvent: subListeners.onEvent,\n        onOpen: subListeners.onOpen,\n        onRetrying: subListeners.onRetrying,\n    };\n};\n\n\n/***/ }),\n/* 12 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.replaceMissingListenersWithNoOps = function (listeners) {\n    var onEndNoOp = function (error) { };\n    var onEnd = listeners.onEnd || onEndNoOp;\n    var onErrorNoOp = function (error) { };\n    var onError = listeners.onError || onErrorNoOp;\n    var onEventNoOp = function (event) { };\n    var onEvent = listeners.onEvent || onEventNoOp;\n    var onOpenNoOp = function (headers) { };\n    var onOpen = listeners.onOpen || onOpenNoOp;\n    var onRetryingNoOp = function () { };\n    var onRetrying = listeners.onRetrying || onRetryingNoOp;\n    var onSubscribeNoOp = function () { };\n    var onSubscribe = listeners.onSubscribe || onSubscribeNoOp;\n    return {\n        onEnd: onEnd,\n        onError: onError,\n        onEvent: onEvent,\n        onOpen: onOpen,\n        onRetrying: onRetrying,\n        onSubscribe: onSubscribe,\n    };\n};\n\n\n/***/ }),\n/* 13 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nvar HttpTransportState;\n(function (HttpTransportState) {\n    HttpTransportState[HttpTransportState[\"UNOPENED\"] = 0] = \"UNOPENED\";\n    HttpTransportState[HttpTransportState[\"OPENING\"] = 1] = \"OPENING\";\n    HttpTransportState[HttpTransportState[\"OPEN\"] = 2] = \"OPEN\";\n    HttpTransportState[HttpTransportState[\"ENDING\"] = 3] = \"ENDING\";\n    HttpTransportState[HttpTransportState[\"ENDED\"] = 4] = \"ENDED\";\n})(HttpTransportState = exports.HttpTransportState || (exports.HttpTransportState = {}));\nvar HttpSubscription = (function () {\n    function HttpSubscription(xhr, listeners) {\n        var _this = this;\n        this.gotEOS = false;\n        this.lastNewlineIndex = 0;\n        this.state = HttpTransportState.UNOPENED;\n        this.xhr = xhr;\n        this.listeners = listeners;\n        this.xhr.onreadystatechange = function () {\n            switch (_this.xhr.readyState) {\n                case network_1.XhrReadyState.UNSENT:\n                case network_1.XhrReadyState.OPENED:\n                case network_1.XhrReadyState.HEADERS_RECEIVED:\n                    _this.assertStateIsIn(HttpTransportState.OPENING);\n                    break;\n                case network_1.XhrReadyState.LOADING:\n                    _this.onLoading();\n                    break;\n                case network_1.XhrReadyState.DONE:\n                    _this.onDone();\n                    break;\n            }\n        };\n        this.state = HttpTransportState.OPENING;\n        this.xhr.send();\n        return this;\n    }\n    HttpSubscription.prototype.unsubscribe = function () {\n        this.state = HttpTransportState.ENDED;\n        this.xhr.abort();\n        if (this.listeners.onEnd) {\n            this.listeners.onEnd(null);\n        }\n    };\n    HttpSubscription.prototype.onLoading = function () {\n        this.assertStateIsIn(HttpTransportState.OPENING, HttpTransportState.OPEN, HttpTransportState.ENDING);\n        if (this.xhr.status === 200) {\n            if (this.state === HttpTransportState.OPENING) {\n                this.state = HttpTransportState.OPEN;\n                window.console.log(network_1.responseToHeadersObject(this.xhr.getAllResponseHeaders()));\n                if (this.listeners.onOpen) {\n                    this.listeners.onOpen(network_1.responseToHeadersObject(this.xhr.getAllResponseHeaders()));\n                }\n            }\n            this.assertStateIsIn(HttpTransportState.OPEN);\n            var err = this.onChunk();\n            this.assertStateIsIn(HttpTransportState.OPEN, HttpTransportState.ENDING);\n            if (err) {\n                this.state = HttpTransportState.ENDED;\n                if (err instanceof network_1.ErrorResponse && err.statusCode !== 204) {\n                    if (this.listeners.onError) {\n                        this.listeners.onError(err);\n                    }\n                }\n            }\n            else {\n            }\n        }\n    };\n    HttpSubscription.prototype.onDone = function () {\n        if (this.xhr.status === 200) {\n            if (this.state === HttpTransportState.OPENING) {\n                this.state = HttpTransportState.OPEN;\n                if (this.listeners.onOpen) {\n                    this.listeners.onOpen(network_1.responseToHeadersObject(this.xhr.getAllResponseHeaders()));\n                }\n            }\n            this.assertStateIsIn(HttpTransportState.OPEN, HttpTransportState.ENDING);\n            var err = this.onChunk();\n            if (err) {\n                this.state = HttpTransportState.ENDED;\n                if (err.statusCode === 204) {\n                    if (this.listeners.onEnd) {\n                        this.listeners.onEnd(null);\n                    }\n                }\n                else {\n                    if (this.listeners.onError) {\n                        this.listeners.onError(err);\n                    }\n                }\n            }\n            else if (this.state <= HttpTransportState.ENDING) {\n                if (this.listeners.onError) {\n                    this.listeners.onError(new Error('HTTP response ended without receiving EOS message'));\n                }\n            }\n            else {\n                if (this.listeners.onEnd) {\n                    this.listeners.onEnd(null);\n                }\n            }\n        }\n        else {\n            this.assertStateIsIn(HttpTransportState.OPENING, HttpTransportState.OPEN, HttpTransportState.ENDED);\n            if (this.state === HttpTransportState.ENDED) {\n                return;\n            }\n            else if (this.xhr.status === 0) {\n                if (this.listeners.onError) {\n                    this.listeners.onError(new network_1.NetworkError('Connection lost.'));\n                }\n            }\n            else {\n                if (this.listeners.onError) {\n                    this.listeners.onError(network_1.ErrorResponse.fromXHR(this.xhr));\n                }\n            }\n        }\n    };\n    HttpSubscription.prototype.onChunk = function () {\n        this.assertStateIsIn(HttpTransportState.OPEN);\n        var response = this.xhr.responseText;\n        var newlineIndex = response.lastIndexOf('\\n');\n        if (newlineIndex > this.lastNewlineIndex) {\n            var rawEvents = response\n                .slice(this.lastNewlineIndex, newlineIndex)\n                .split('\\n');\n            this.lastNewlineIndex = newlineIndex;\n            for (var _i = 0, rawEvents_1 = rawEvents; _i < rawEvents_1.length; _i++) {\n                var rawEvent = rawEvents_1[_i];\n                if (rawEvent.length === 0) {\n                    continue;\n                }\n                var data = JSON.parse(rawEvent);\n                var err = this.onMessage(data);\n                if (err != null) {\n                    return err;\n                }\n            }\n        }\n    };\n    HttpSubscription.prototype.assertStateIsIn = function () {\n        var _this = this;\n        var validStates = [];\n        for (var _i = 0; _i < arguments.length; _i++) {\n            validStates[_i] = arguments[_i];\n        }\n        var stateIsValid = validStates.some(function (validState) { return validState === _this.state; });\n        if (!stateIsValid) {\n            var expectedStates = validStates\n                .map(function (state) { return HttpTransportState[state]; })\n                .join(', ');\n            var actualState = HttpTransportState[this.state];\n            window.console.warn(\"Expected this.state to be one of [\" + expectedStates + \"] but it is \" + actualState);\n        }\n    };\n    HttpSubscription.prototype.onMessage = function (message) {\n        this.assertStateIsIn(HttpTransportState.OPEN);\n        this.verifyMessage(message);\n        switch (message[0]) {\n            case 0:\n                return null;\n            case 1:\n                return this.onEventMessage(message);\n            case 255:\n                return this.onEOSMessage(message);\n            default:\n                return new Error('Unknown Message: ' + JSON.stringify(message));\n        }\n    };\n    HttpSubscription.prototype.onEventMessage = function (eventMessage) {\n        this.assertStateIsIn(HttpTransportState.OPEN);\n        if (eventMessage.length !== 4) {\n            return new Error('Event message has ' + eventMessage.length + ' elements (expected 4)');\n        }\n        var _ = eventMessage[0], id = eventMessage[1], headers = eventMessage[2], body = eventMessage[3];\n        if (typeof id !== 'string') {\n            return new Error('Invalid event ID in message: ' + JSON.stringify(eventMessage));\n        }\n        if (typeof headers !== 'object' || Array.isArray(headers)) {\n            return new Error('Invalid event headers in message: ' + JSON.stringify(eventMessage));\n        }\n        if (this.listeners.onEvent) {\n            this.listeners.onEvent({ body: body, headers: headers, eventId: id });\n        }\n        return null;\n    };\n    HttpSubscription.prototype.onEOSMessage = function (eosMessage) {\n        this.assertStateIsIn(HttpTransportState.OPEN);\n        if (eosMessage.length !== 4) {\n            return new Error('EOS message has ' + eosMessage.length + ' elements (expected 4)');\n        }\n        var _ = eosMessage[0], statusCode = eosMessage[1], headers = eosMessage[2], info = eosMessage[3];\n        if (typeof statusCode !== 'number') {\n            return new Error('Invalid EOS Status Code');\n        }\n        if (typeof headers !== 'object' || Array.isArray(headers)) {\n            return new Error('Invalid EOS ElementsHeaders');\n        }\n        this.state = HttpTransportState.ENDING;\n        return new network_1.ErrorResponse(statusCode, headers, info);\n    };\n    HttpSubscription.prototype.verifyMessage = function (message) {\n        if (this.gotEOS) {\n            return new Error('Got another message after EOS message');\n        }\n        if (!Array.isArray(message)) {\n            return new Error('Message is not an array');\n        }\n        if (message.length < 1) {\n            return new Error('Message is empty array');\n        }\n    };\n    return HttpSubscription;\n}());\nvar HttpTransport = (function () {\n    function HttpTransport(host, encrypted) {\n        if (encrypted === void 0) { encrypted = true; }\n        this.baseURL = (encrypted ? 'https' : 'http') + \"://\" + host;\n    }\n    HttpTransport.prototype.request = function (requestOptions) {\n        return this.createXHR(this.baseURL, requestOptions);\n    };\n    HttpTransport.prototype.subscribe = function (path, listeners, headers) {\n        var requestOptions = {\n            headers: headers,\n            method: 'SUBSCRIBE',\n            path: path,\n        };\n        return new HttpSubscription(this.createXHR(this.baseURL, requestOptions), listeners);\n    };\n    HttpTransport.prototype.createXHR = function (baseURL, options) {\n        var xhr = new window.XMLHttpRequest();\n        var path = options.path.replace(/^\\/+/, '');\n        var endpoint = baseURL + \"/\" + path;\n        xhr.open(options.method.toUpperCase(), endpoint, true);\n        xhr = this.setJSONHeaderIfAppropriate(xhr, options);\n        if (options.jwt) {\n            xhr.setRequestHeader('authorization', \"Bearer \" + options.jwt);\n        }\n        if (options.headers) {\n            for (var key in options.headers) {\n                if (options.headers.hasOwnProperty(key)) {\n                    xhr.setRequestHeader(key, options.headers[key]);\n                }\n            }\n        }\n        return xhr;\n    };\n    HttpTransport.prototype.setJSONHeaderIfAppropriate = function (xhr, options) {\n        if (options.json) {\n            xhr.setRequestHeader('content-type', 'application/json');\n        }\n        return xhr;\n    };\n    return HttpTransport;\n}());\nexports.default = HttpTransport;\n\n\n/***/ }),\n/* 14 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nvar __assign = (this && this.__assign) || Object.assign || function(t) {\n    for (var s, i = 1, n = arguments.length; i < n; i++) {\n        s = arguments[i];\n        for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p))\n            t[p] = s[p];\n    }\n    return t;\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar network_1 = __webpack_require__(0);\nvar SubscribeMessageType = 100;\nvar OpenMessageType = 101;\nvar EventMessageType = 102;\nvar UnsubscribeMessageType = 198;\nvar EosMessageType = 199;\nvar PingMessageType = 16;\nvar PongMessageType = 17;\nvar CloseMessageType = 99;\nvar WSReadyState;\n(function (WSReadyState) {\n    WSReadyState[WSReadyState[\"Connecting\"] = 0] = \"Connecting\";\n    WSReadyState[WSReadyState[\"Open\"] = 1] = \"Open\";\n    WSReadyState[WSReadyState[\"Closing\"] = 2] = \"Closing\";\n    WSReadyState[WSReadyState[\"Closed\"] = 3] = \"Closed\";\n})(WSReadyState = exports.WSReadyState || (exports.WSReadyState = {}));\nvar WsSubscriptions = (function () {\n    function WsSubscriptions() {\n        this.subscriptions = {};\n    }\n    WsSubscriptions.prototype.add = function (subID, path, listeners, headers) {\n        this.subscriptions[subID] = {\n            headers: headers,\n            listeners: listeners,\n            path: path,\n        };\n        return subID;\n    };\n    WsSubscriptions.prototype.has = function (subID) {\n        return this.subscriptions[subID] !== undefined;\n    };\n    WsSubscriptions.prototype.isEmpty = function () {\n        return Object.keys(this.subscriptions).length === 0;\n    };\n    WsSubscriptions.prototype.remove = function (subID) {\n        return delete this.subscriptions[subID];\n    };\n    WsSubscriptions.prototype.get = function (subID) {\n        return this.subscriptions[subID];\n    };\n    WsSubscriptions.prototype.getAll = function () {\n        return this.subscriptions;\n    };\n    WsSubscriptions.prototype.getAllAsArray = function () {\n        var _this = this;\n        return Object.keys(this.subscriptions).map(function (subID) { return (__assign({ subID: parseInt(subID, 10) }, _this.subscriptions[parseInt(subID, 10)])); });\n    };\n    WsSubscriptions.prototype.removeAll = function () {\n        this.subscriptions = {};\n    };\n    return WsSubscriptions;\n}());\nvar WsSubscription = (function () {\n    function WsSubscription(wsTransport, subID) {\n        this.wsTransport = wsTransport;\n        this.subID = subID;\n    }\n    WsSubscription.prototype.unsubscribe = function () {\n        this.wsTransport.unsubscribe(this.subID);\n    };\n    return WsSubscription;\n}());\nvar pingIntervalMs = 30000;\nvar pingTimeoutMs = 10000;\nvar WebSocketTransport = (function () {\n    function WebSocketTransport(host, logger) {\n        this.webSocketPath = '/ws';\n        this.forcedClose = false;\n        this.closedError = null;\n        this.lastSentPingID = null;\n        this.baseURL = \"wss://\" + host + this.webSocketPath;\n        this.lastSubscriptionID = 0;\n        this.logger = logger;\n        this.subscriptions = new WsSubscriptions();\n        this.pendingSubscriptions = new WsSubscriptions();\n        this.connect();\n    }\n    WebSocketTransport.prototype.subscribe = function (path, listeners, headers) {\n        this.tryReconnectIfNeeded();\n        var subID = this.lastSubscriptionID++;\n        if (this.socket.readyState !== WSReadyState.Open) {\n            this.pendingSubscriptions.add(subID, path, listeners, headers);\n            return new WsSubscription(this, subID);\n        }\n        this.subscriptions.add(subID, path, listeners, headers);\n        this.sendMessage(this.getMessage(SubscribeMessageType, subID, path, headers));\n        return new WsSubscription(this, subID);\n    };\n    WebSocketTransport.prototype.unsubscribe = function (subID) {\n        this.sendMessage(this.getMessage(UnsubscribeMessageType, subID));\n        var subscription = this.subscriptions.get(subID);\n        if (subscription.listeners.onEnd) {\n            subscription.listeners.onEnd(null);\n        }\n        this.subscriptions.remove(subID);\n    };\n    WebSocketTransport.prototype.connect = function () {\n        var _this = this;\n        this.forcedClose = false;\n        this.closedError = null;\n        this.socket = new window.WebSocket(this.baseURL);\n        this.socket.onopen = function (event) {\n            var allPendingSubscriptions = _this.pendingSubscriptions.getAllAsArray();\n            allPendingSubscriptions.forEach(function (subscription) {\n                var subID = subscription.subID, path = subscription.path, listeners = subscription.listeners, headers = subscription.headers;\n                _this.subscribePending(path, listeners, headers, subID);\n            });\n            _this.pendingSubscriptions.removeAll();\n            _this.pingInterval = window.setInterval(function () {\n                if (_this.pongTimeout) {\n                    return;\n                }\n                var now = new Date().getTime();\n                if (pingTimeoutMs > now - _this.lastMessageReceivedTimestamp) {\n                    return;\n                }\n                _this.sendMessage(_this.getMessage(PingMessageType, now));\n                _this.lastSentPingID = now;\n                _this.pongTimeout = window.setTimeout(function () {\n                    var pongNow = new Date().getTime();\n                    if (pingTimeoutMs > pongNow - _this.lastMessageReceivedTimestamp) {\n                        _this.pongTimeout = null;\n                        return;\n                    }\n                    _this.close(new network_1.NetworkError(\"Pong response wasn't received within timeout\"));\n                }, pingTimeoutMs);\n            }, pingIntervalMs);\n        };\n        this.socket.onmessage = function (event) { return _this.receiveMessage(event); };\n        this.socket.onerror = function (event) {\n            _this.logger.verbose('WebSocket encountered an error event', event);\n        };\n        this.socket.onclose = function (event) {\n            _this.logger.verbose('WebSocket encountered a close event', event);\n            var allSubscriptions = _this.subscriptions\n                .getAllAsArray()\n                .concat(_this.pendingSubscriptions.getAllAsArray());\n            _this.subscriptions.removeAll();\n            _this.pendingSubscriptions.removeAll();\n            allSubscriptions.forEach(function (sub) {\n                if (sub.listeners.onError) {\n                    sub.listeners.onError(_this.closedError);\n                }\n            });\n            _this.tryReconnectIfNeeded();\n        };\n    };\n    WebSocketTransport.prototype.close = function (error) {\n        if (!(this.socket instanceof window.WebSocket)) {\n            return;\n        }\n        var onClose = function (event) { };\n        if (this.socket.onclose != null) {\n            onClose = this.socket.onclose.bind(this);\n        }\n        this.socket.onclose = function () { };\n        this.socket.onerror = function () { };\n        this.socket.onmessage = function () { };\n        this.socket.onopen = function () { };\n        this.forcedClose = true;\n        this.closedError = error;\n        this.socket.close();\n        window.clearTimeout(this.pingInterval);\n        window.clearTimeout(this.pongTimeout);\n        this.pongTimeout = null;\n        this.pingInterval = null;\n        this.lastSentPingID = null;\n        onClose();\n    };\n    WebSocketTransport.prototype.tryReconnectIfNeeded = function () {\n        if (this.forcedClose || this.socket.readyState === WSReadyState.Closed) {\n            this.connect();\n        }\n    };\n    WebSocketTransport.prototype.subscribePending = function (path, listeners, headers, subID) {\n        if (subID === undefined) {\n            this.logger.debug(\"Subscription to path \" + path + \" has an undefined ID\");\n            return;\n        }\n        this.subscriptions.add(subID, path, listeners, headers);\n        this.sendMessage(this.getMessage(SubscribeMessageType, subID, path, headers));\n    };\n    WebSocketTransport.prototype.getMessage = function (messageType, id, path, headers) {\n        return [messageType, id, path, headers];\n    };\n    WebSocketTransport.prototype.sendMessage = function (message) {\n        if (this.socket.readyState !== WSReadyState.Open) {\n            this.logger.warn(\"Can't send on socket in \\\"\" + WSReadyState[this.socket.readyState] + \"\\\" state\");\n            return;\n        }\n        this.socket.send(JSON.stringify(message));\n    };\n    WebSocketTransport.prototype.subscription = function (subID) {\n        return this.subscriptions.get(subID);\n    };\n    WebSocketTransport.prototype.receiveMessage = function (event) {\n        this.lastMessageReceivedTimestamp = new Date().getTime();\n        var message;\n        try {\n            message = JSON.parse(event.data);\n        }\n        catch (err) {\n            this.close(new network_1.ProtocolError(\"Message is not valid JSON format. Getting \" + event.data));\n            return;\n        }\n        var nonValidMessageError = this.validateMessage(message);\n        if (nonValidMessageError) {\n            this.close(nonValidMessageError);\n            return;\n        }\n        var messageType = message.shift();\n        switch (messageType) {\n            case PongMessageType:\n                this.onPongMessage(message);\n                return;\n            case PingMessageType:\n                this.onPingMessage(message);\n                return;\n            case CloseMessageType:\n                this.onCloseMessage(message);\n                return;\n        }\n        var subID = message.shift();\n        var subscription = this.subscription(subID);\n        if (!subscription) {\n            this.close(new Error(\"Received message for unknown subscription ID: \" + subID));\n            return;\n        }\n        var listeners = subscription.listeners;\n        switch (messageType) {\n            case OpenMessageType:\n                this.onOpenMessage(message, subID, listeners);\n                break;\n            case EventMessageType:\n                this.onEventMessage(message, listeners);\n                break;\n            case EosMessageType:\n                this.onEOSMessage(message, subID, listeners);\n                break;\n            default:\n                this.close(new network_1.ProtocolError('Received unknown type of message.'));\n        }\n    };\n    WebSocketTransport.prototype.validateMessage = function (message) {\n        if (!Array.isArray(message)) {\n            return new network_1.ProtocolError(\"Message is expected to be an array. Getting: \" + JSON.stringify(message));\n        }\n        if (message.length < 1) {\n            return new network_1.ProtocolError(\"Message is empty array: \" + JSON.stringify(message));\n        }\n        return null;\n    };\n    WebSocketTransport.prototype.onOpenMessage = function (message, subID, subscriptionListeners) {\n        if (subscriptionListeners.onOpen) {\n            subscriptionListeners.onOpen(message[1]);\n        }\n    };\n    WebSocketTransport.prototype.onEventMessage = function (eventMessage, subscriptionListeners) {\n        if (eventMessage.length !== 3) {\n            if (subscriptionListeners.onError) {\n                subscriptionListeners.onError(new network_1.ProtocolError('Event message has ' +\n                    eventMessage.length +\n                    ' elements (expected 4)'));\n            }\n            return;\n        }\n        var eventId = eventMessage[0], headers = eventMessage[1], body = eventMessage[2];\n        if (typeof eventId !== 'string') {\n            if (subscriptionListeners.onError) {\n                subscriptionListeners.onError(new network_1.ProtocolError(\"Invalid event ID in message: \" + JSON.stringify(eventMessage)));\n            }\n            return;\n        }\n        if (typeof headers !== 'object' || Array.isArray(headers)) {\n            if (subscriptionListeners.onError) {\n                subscriptionListeners.onError(new network_1.ProtocolError(\"Invalid event headers in message: \" + JSON.stringify(eventMessage)));\n            }\n            return;\n        }\n        if (subscriptionListeners.onEvent) {\n            subscriptionListeners.onEvent({ eventId: eventId, headers: headers, body: body });\n        }\n    };\n    WebSocketTransport.prototype.onEOSMessage = function (eosMessage, subID, subscriptionListeners) {\n        this.subscriptions.remove(subID);\n        if (eosMessage.length !== 3) {\n            if (subscriptionListeners.onError) {\n                subscriptionListeners.onError(new network_1.ProtocolError(\"EOS message has \" + eosMessage.length + \" elements (expected 4)\"));\n            }\n            return;\n        }\n        var statusCode = eosMessage[0], headers = eosMessage[1], body = eosMessage[2];\n        if (typeof statusCode !== 'number') {\n            if (subscriptionListeners.onError) {\n                subscriptionListeners.onError(new network_1.ProtocolError('Invalid EOS Status Code'));\n            }\n            return;\n        }\n        if (typeof headers !== 'object' || Array.isArray(headers)) {\n            if (subscriptionListeners.onError) {\n                subscriptionListeners.onError(new network_1.ProtocolError('Invalid EOS ElementsHeaders'));\n            }\n            return;\n        }\n        if (statusCode === 204) {\n            if (subscriptionListeners.onEnd) {\n                subscriptionListeners.onEnd(null);\n            }\n            return;\n        }\n        if (subscriptionListeners.onError) {\n            subscriptionListeners.onError(new network_1.ErrorResponse(statusCode, headers, body));\n        }\n        return;\n    };\n    WebSocketTransport.prototype.onCloseMessage = function (closeMessage) {\n        var statusCode = closeMessage[0], headers = closeMessage[1], body = closeMessage[2];\n        if (typeof statusCode !== 'number') {\n            this.close(new network_1.ProtocolError('Close message: Invalid EOS Status Code'));\n            return;\n        }\n        if (typeof headers !== 'object' || Array.isArray(headers)) {\n            this.close(new network_1.ProtocolError('Close message: Invalid EOS ElementsHeaders'));\n            return;\n        }\n        var errorInfo = {\n            error: body.error || 'network_error',\n            error_description: body.error_description || 'Network error',\n        };\n        this.close(new network_1.ErrorResponse(statusCode, headers, errorInfo));\n    };\n    WebSocketTransport.prototype.onPongMessage = function (message) {\n        var receviedPongID = message[0];\n        if (this.lastSentPingID !== receviedPongID) {\n            this.close(new network_1.ProtocolError(\"Received pong with ID \" + receviedPongID + \" but last sent ping ID was \" + this.lastSentPingID));\n        }\n        window.clearTimeout(this.pongTimeout);\n        delete this.pongTimeout;\n        this.lastSentPingID = null;\n    };\n    WebSocketTransport.prototype.onPingMessage = function (message) {\n        var receviedPingID = message[0];\n        this.sendMessage(this.getMessage(PongMessageType, receviedPingID));\n    };\n    return WebSocketTransport;\n}());\nexports.default = WebSocketTransport;\n\n\n/***/ }),\n/* 15 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", { value: true });\nvar base_client_1 = __webpack_require__(3);\nvar host_base_1 = __webpack_require__(9);\nvar logger_1 = __webpack_require__(1);\nvar Instance = (function () {\n    function Instance(options) {\n        if (!options.locator) {\n            throw new Error('Expected `locator` property in Instance options!');\n        }\n        var splitInstanceLocator = options.locator.split(':');\n        if (splitInstanceLocator.length !== 3) {\n            throw new Error('The instance locator supplied is invalid. Did you copy it correctly from the Pusher dashboard?');\n        }\n        if (!options.serviceName) {\n            throw new Error('Expected `serviceName` property in Instance options!');\n        }\n        if (!options.serviceVersion) {\n            throw new Error('Expected `serviceVersion` property in Instance options!');\n        }\n        this.platformVersion = splitInstanceLocator[0];\n        this.cluster = splitInstanceLocator[1];\n        this.id = splitInstanceLocator[2];\n        this.serviceName = options.serviceName;\n        this.serviceVersion = options.serviceVersion;\n        this.host = options.host || this.cluster + \".\" + host_base_1.HOST_BASE;\n        this.logger = options.logger || new logger_1.ConsoleLogger();\n        this.client =\n            options.client ||\n                new base_client_1.BaseClient({\n                    encrypted: options.encrypted,\n                    host: this.host,\n                    logger: this.logger,\n                });\n        this.tokenProvider = options.tokenProvider;\n    }\n    Instance.prototype.request = function (options, tokenParams) {\n        options.path = this.absPath(options.path);\n        if (options.headers == null || options.headers === undefined) {\n            options.headers = {};\n        }\n        options.tokenProvider = options.tokenProvider || this.tokenProvider;\n        return this.client.request(options, tokenParams);\n    };\n    Instance.prototype.subscribeNonResuming = function (options) {\n        var headers = options.headers || {};\n        var retryStrategyOptions = options.retryStrategyOptions || {};\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        return this.client.subscribeNonResuming(this.absPath(options.path), headers, options.listeners, retryStrategyOptions, tokenProvider);\n    };\n    Instance.prototype.subscribeResuming = function (options) {\n        var headers = options.headers || {};\n        var retryStrategyOptions = options.retryStrategyOptions || {};\n        var tokenProvider = options.tokenProvider || this.tokenProvider;\n        return this.client.subscribeResuming(this.absPath(options.path), headers, options.listeners, retryStrategyOptions, options.initialEventId, tokenProvider);\n    };\n    Instance.prototype.absPath = function (relativePath) {\n        return (\"/services/\" + this.serviceName + \"/\" + this.serviceVersion + \"/\" + this.id + \"/\" + relativePath)\n            .replace(/\\/+/g, '/')\n            .replace(/\\/+$/, '');\n    };\n    return Instance;\n}());\nexports.default = Instance;\n\n\n/***/ })\n/******/ ]);\n});","export default function _isPlaceholder(a) {\n       return a != null && typeof a === 'object' && a['@@functional/placeholder'] === true;\n}","import _isPlaceholder from './_isPlaceholder';\n\n/**\n * Optimized internal one-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curry1(fn) {\n  return function f1(a) {\n    if (arguments.length === 0 || _isPlaceholder(a)) {\n      return f1;\n    } else {\n      return fn.apply(this, arguments);\n    }\n  };\n}","import _curry1 from './_curry1';\nimport _isPlaceholder from './_isPlaceholder';\n\n/**\n * Optimized internal two-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curry2(fn) {\n  return function f2(a, b) {\n    switch (arguments.length) {\n      case 0:\n        return f2;\n      case 1:\n        return _isPlaceholder(a) ? f2 : _curry1(function (_b) {\n          return fn(a, _b);\n        });\n      default:\n        return _isPlaceholder(a) && _isPlaceholder(b) ? f2 : _isPlaceholder(a) ? _curry1(function (_a) {\n          return fn(_a, b);\n        }) : _isPlaceholder(b) ? _curry1(function (_b) {\n          return fn(a, _b);\n        }) : fn(a, b);\n    }\n  };\n}","/**\n * Private `concat` function to merge two array-like objects.\n *\n * @private\n * @param {Array|Arguments} [set1=[]] An array-like object.\n * @param {Array|Arguments} [set2=[]] An array-like object.\n * @return {Array} A new, merged array.\n * @example\n *\n *      _concat([4, 5, 6], [1, 2, 3]); //=> [4, 5, 6, 1, 2, 3]\n */\nexport default function _concat(set1, set2) {\n  set1 = set1 || [];\n  set2 = set2 || [];\n  var idx;\n  var len1 = set1.length;\n  var len2 = set2.length;\n  var result = [];\n\n  idx = 0;\n  while (idx < len1) {\n    result[result.length] = set1[idx];\n    idx += 1;\n  }\n  idx = 0;\n  while (idx < len2) {\n    result[result.length] = set2[idx];\n    idx += 1;\n  }\n  return result;\n}","export default function _arity(n, fn) {\n  /* eslint-disable no-unused-vars */\n  switch (n) {\n    case 0:\n      return function () {\n        return fn.apply(this, arguments);\n      };\n    case 1:\n      return function (a0) {\n        return fn.apply(this, arguments);\n      };\n    case 2:\n      return function (a0, a1) {\n        return fn.apply(this, arguments);\n      };\n    case 3:\n      return function (a0, a1, a2) {\n        return fn.apply(this, arguments);\n      };\n    case 4:\n      return function (a0, a1, a2, a3) {\n        return fn.apply(this, arguments);\n      };\n    case 5:\n      return function (a0, a1, a2, a3, a4) {\n        return fn.apply(this, arguments);\n      };\n    case 6:\n      return function (a0, a1, a2, a3, a4, a5) {\n        return fn.apply(this, arguments);\n      };\n    case 7:\n      return function (a0, a1, a2, a3, a4, a5, a6) {\n        return fn.apply(this, arguments);\n      };\n    case 8:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7) {\n        return fn.apply(this, arguments);\n      };\n    case 9:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8) {\n        return fn.apply(this, arguments);\n      };\n    case 10:\n      return function (a0, a1, a2, a3, a4, a5, a6, a7, a8, a9) {\n        return fn.apply(this, arguments);\n      };\n    default:\n      throw new Error('First argument to _arity must be a non-negative integer no greater than ten');\n  }\n}","import _arity from './_arity';\nimport _isPlaceholder from './_isPlaceholder';\n\n/**\n * Internal curryN function.\n *\n * @private\n * @category Function\n * @param {Number} length The arity of the curried function.\n * @param {Array} received An array of arguments received thus far.\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curryN(length, received, fn) {\n  return function () {\n    var combined = [];\n    var argsIdx = 0;\n    var left = length;\n    var combinedIdx = 0;\n    while (combinedIdx < received.length || argsIdx < arguments.length) {\n      var result;\n      if (combinedIdx < received.length && (!_isPlaceholder(received[combinedIdx]) || argsIdx >= arguments.length)) {\n        result = received[combinedIdx];\n      } else {\n        result = arguments[argsIdx];\n        argsIdx += 1;\n      }\n      combined[combinedIdx] = result;\n      if (!_isPlaceholder(result)) {\n        left -= 1;\n      }\n      combinedIdx += 1;\n    }\n    return left <= 0 ? fn.apply(this, combined) : _arity(left, _curryN(length, combined, fn));\n  };\n}","import _arity from './internal/_arity';\nimport _curry1 from './internal/_curry1';\nimport _curry2 from './internal/_curry2';\nimport _curryN from './internal/_curryN';\n\n/**\n * Returns a curried equivalent of the provided function, with the specified\n * arity. The curried function has two unusual capabilities. First, its\n * arguments needn't be provided one at a time. If `g` is `R.curryN(3, f)`, the\n * following are equivalent:\n *\n *   - `g(1)(2)(3)`\n *   - `g(1)(2, 3)`\n *   - `g(1, 2)(3)`\n *   - `g(1, 2, 3)`\n *\n * Secondly, the special placeholder value [`R.__`](#__) may be used to specify\n * \"gaps\", allowing partial application of any combination of arguments,\n * regardless of their positions. If `g` is as above and `_` is [`R.__`](#__),\n * the following are equivalent:\n *\n *   - `g(1, 2, 3)`\n *   - `g(_, 2, 3)(1)`\n *   - `g(_, _, 3)(1)(2)`\n *   - `g(_, _, 3)(1, 2)`\n *   - `g(_, 2)(1)(3)`\n *   - `g(_, 2)(1, 3)`\n *   - `g(_, 2)(_, 3)(1)`\n *\n * @func\n * @memberOf R\n * @since v0.5.0\n * @category Function\n * @sig Number -> (* -> a) -> (* -> a)\n * @param {Number} length The arity for the returned function.\n * @param {Function} fn The function to curry.\n * @return {Function} A new, curried function.\n * @see R.curry\n * @example\n *\n *      var sumArgs = (...args) => R.sum(args);\n *\n *      var curriedAddFourNumbers = R.curryN(4, sumArgs);\n *      var f = curriedAddFourNumbers(1, 2);\n *      var g = f(3);\n *      g(4); //=> 10\n */\nvar curryN = /*#__PURE__*/_curry2(function curryN(length, fn) {\n  if (length === 1) {\n    return _curry1(fn);\n  }\n  return _arity(length, _curryN(length, [], fn));\n});\nexport default curryN;","import _curry1 from './_curry1';\nimport _curry2 from './_curry2';\nimport _isPlaceholder from './_isPlaceholder';\n\n/**\n * Optimized internal three-arity curry function.\n *\n * @private\n * @category Function\n * @param {Function} fn The function to curry.\n * @return {Function} The curried function.\n */\nexport default function _curry3(fn) {\n  return function f3(a, b, c) {\n    switch (arguments.length) {\n      case 0:\n        return f3;\n      case 1:\n        return _isPlaceholder(a) ? f3 : _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        });\n      case 2:\n        return _isPlaceholder(a) && _isPlaceholder(b) ? f3 : _isPlaceholder(a) ? _curry2(function (_a, _c) {\n          return fn(_a, b, _c);\n        }) : _isPlaceholder(b) ? _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        }) : _curry1(function (_c) {\n          return fn(a, b, _c);\n        });\n      default:\n        return _isPlaceholder(a) && _isPlaceholder(b) && _isPlaceholder(c) ? f3 : _isPlaceholder(a) && _isPlaceholder(b) ? _curry2(function (_a, _b) {\n          return fn(_a, _b, c);\n        }) : _isPlaceholder(a) && _isPlaceholder(c) ? _curry2(function (_a, _c) {\n          return fn(_a, b, _c);\n        }) : _isPlaceholder(b) && _isPlaceholder(c) ? _curry2(function (_b, _c) {\n          return fn(a, _b, _c);\n        }) : _isPlaceholder(a) ? _curry1(function (_a) {\n          return fn(_a, b, c);\n        }) : _isPlaceholder(b) ? _curry1(function (_b) {\n          return fn(a, _b, c);\n        }) : _isPlaceholder(c) ? _curry1(function (_c) {\n          return fn(a, b, _c);\n        }) : fn(a, b, c);\n    }\n  };\n}","/**\n * Tests whether or not an object is an array.\n *\n * @private\n * @param {*} val The object to test.\n * @return {Boolean} `true` if `val` is an array, `false` otherwise.\n * @example\n *\n *      _isArray([]); //=> true\n *      _isArray(null); //=> false\n *      _isArray({}); //=> false\n */\nexport default Array.isArray || function _isArray(val) {\n  return val != null && val.length >= 0 && Object.prototype.toString.call(val) === '[object Array]';\n};","import _isArray from './_isArray';\nimport _isTransformer from './_isTransformer';\n\n/**\n * Returns a function that dispatches with different strategies based on the\n * object in list position (last argument). If it is an array, executes [fn].\n * Otherwise, if it has a function with one of the given method names, it will\n * execute that function (functor case). Otherwise, if it is a transformer,\n * uses transducer [xf] to return a new transformer (transducer case).\n * Otherwise, it will default to executing [fn].\n *\n * @private\n * @param {Array} methodNames properties to check for a custom implementation\n * @param {Function} xf transducer to initialize if object is transformer\n * @param {Function} fn default ramda implementation\n * @return {Function} A function that dispatches on object in list position\n */\nexport default function _dispatchable(methodNames, xf, fn) {\n  return function () {\n    if (arguments.length === 0) {\n      return fn();\n    }\n    var args = Array.prototype.slice.call(arguments, 0);\n    var obj = args.pop();\n    if (!_isArray(obj)) {\n      var idx = 0;\n      while (idx < methodNames.length) {\n        if (typeof obj[methodNames[idx]] === 'function') {\n          return obj[methodNames[idx]].apply(obj, args);\n        }\n        idx += 1;\n      }\n      if (_isTransformer(obj)) {\n        var transducer = xf.apply(null, args);\n        return transducer(obj);\n      }\n    }\n    return fn.apply(this, arguments);\n  };\n}","export default function _isTransformer(obj) {\n  return typeof obj['@@transducer/step'] === 'function';\n}","export default {\n  init: function () {\n    return this.xf['@@transducer/init']();\n  },\n  result: function (result) {\n    return this.xf['@@transducer/result'](result);\n  }\n};","import _curry2 from './internal/_curry2';\n\n/**\n * Returns the larger of its two arguments.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Relation\n * @sig Ord a => a -> a -> a\n * @param {*} a\n * @param {*} b\n * @return {*}\n * @see R.maxBy, R.min\n * @example\n *\n *      R.max(789, 123); //=> 789\n *      R.max('a', 'b'); //=> 'b'\n */\nvar max = /*#__PURE__*/_curry2(function max(a, b) {\n  return b > a ? b : a;\n});\nexport default max;","export default function _map(fn, functor) {\n  var idx = 0;\n  var len = functor.length;\n  var result = Array(len);\n  while (idx < len) {\n    result[idx] = fn(functor[idx]);\n    idx += 1;\n  }\n  return result;\n}","export default function _isString(x) {\n  return Object.prototype.toString.call(x) === '[object String]';\n}","import _curry1 from './_curry1';\nimport _isArray from './_isArray';\nimport _isString from './_isString';\n\n/**\n * Tests whether or not an object is similar to an array.\n *\n * @private\n * @category Type\n * @category List\n * @sig * -> Boolean\n * @param {*} x The object to test.\n * @return {Boolean} `true` if `x` has a numeric length property and extreme indices defined; `false` otherwise.\n * @example\n *\n *      _isArrayLike([]); //=> true\n *      _isArrayLike(true); //=> false\n *      _isArrayLike({}); //=> false\n *      _isArrayLike({length: 10}); //=> false\n *      _isArrayLike({0: 'zero', 9: 'nine', length: 10}); //=> true\n */\nvar _isArrayLike = /*#__PURE__*/_curry1(function isArrayLike(x) {\n  if (_isArray(x)) {\n    return true;\n  }\n  if (!x) {\n    return false;\n  }\n  if (typeof x !== 'object') {\n    return false;\n  }\n  if (_isString(x)) {\n    return false;\n  }\n  if (x.nodeType === 1) {\n    return !!x.length;\n  }\n  if (x.length === 0) {\n    return true;\n  }\n  if (x.length > 0) {\n    return x.hasOwnProperty(0) && x.hasOwnProperty(x.length - 1);\n  }\n  return false;\n});\nexport default _isArrayLike;","var XWrap = /*#__PURE__*/function () {\n  function XWrap(fn) {\n    this.f = fn;\n  }\n  XWrap.prototype['@@transducer/init'] = function () {\n    throw new Error('init not implemented on XWrap');\n  };\n  XWrap.prototype['@@transducer/result'] = function (acc) {\n    return acc;\n  };\n  XWrap.prototype['@@transducer/step'] = function (acc, x) {\n    return this.f(acc, x);\n  };\n\n  return XWrap;\n}();\n\nexport default function _xwrap(fn) {\n  return new XWrap(fn);\n}","import _arity from './internal/_arity';\nimport _curry2 from './internal/_curry2';\n\n/**\n * Creates a function that is bound to a context.\n * Note: `R.bind` does not provide the additional argument-binding capabilities of\n * [Function.prototype.bind](https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Function/bind).\n *\n * @func\n * @memberOf R\n * @since v0.6.0\n * @category Function\n * @category Object\n * @sig (* -> *) -> {*} -> (* -> *)\n * @param {Function} fn The function to bind to context\n * @param {Object} thisObj The context to bind `fn` to\n * @return {Function} A function that will execute in the context of `thisObj`.\n * @see R.partial\n * @example\n *\n *      var log = R.bind(console.log, console);\n *      R.pipe(R.assoc('a', 2), R.tap(log), R.assoc('a', 3))({a: 1}); //=> {a: 3}\n *      // logs {a: 2}\n * @symb R.bind(f, o)(a, b) = f.call(o, a, b)\n */\nvar bind = /*#__PURE__*/_curry2(function bind(fn, thisObj) {\n  return _arity(fn.length, function () {\n    return fn.apply(thisObj, arguments);\n  });\n});\nexport default bind;","import _isArrayLike from './_isArrayLike';\nimport _xwrap from './_xwrap';\nimport bind from '../bind';\n\nfunction _arrayReduce(xf, acc, list) {\n  var idx = 0;\n  var len = list.length;\n  while (idx < len) {\n    acc = xf['@@transducer/step'](acc, list[idx]);\n    if (acc && acc['@@transducer/reduced']) {\n      acc = acc['@@transducer/value'];\n      break;\n    }\n    idx += 1;\n  }\n  return xf['@@transducer/result'](acc);\n}\n\nfunction _iterableReduce(xf, acc, iter) {\n  var step = iter.next();\n  while (!step.done) {\n    acc = xf['@@transducer/step'](acc, step.value);\n    if (acc && acc['@@transducer/reduced']) {\n      acc = acc['@@transducer/value'];\n      break;\n    }\n    step = iter.next();\n  }\n  return xf['@@transducer/result'](acc);\n}\n\nfunction _methodReduce(xf, acc, obj, methodName) {\n  return xf['@@transducer/result'](obj[methodName](bind(xf['@@transducer/step'], xf), acc));\n}\n\nvar symIterator = typeof Symbol !== 'undefined' ? Symbol.iterator : '@@iterator';\n\nexport default function _reduce(fn, acc, list) {\n  if (typeof fn === 'function') {\n    fn = _xwrap(fn);\n  }\n  if (_isArrayLike(list)) {\n    return _arrayReduce(fn, acc, list);\n  }\n  if (typeof list['fantasy-land/reduce'] === 'function') {\n    return _methodReduce(fn, acc, list, 'fantasy-land/reduce');\n  }\n  if (list[symIterator] != null) {\n    return _iterableReduce(fn, acc, list[symIterator]());\n  }\n  if (typeof list.next === 'function') {\n    return _iterableReduce(fn, acc, list);\n  }\n  if (typeof list.reduce === 'function') {\n    return _methodReduce(fn, acc, list, 'reduce');\n  }\n\n  throw new TypeError('reduce: list must be array or iterable');\n}","import _curry2 from './_curry2';\nimport _xfBase from './_xfBase';\n\nvar XMap = /*#__PURE__*/function () {\n  function XMap(f, xf) {\n    this.xf = xf;\n    this.f = f;\n  }\n  XMap.prototype['@@transducer/init'] = _xfBase.init;\n  XMap.prototype['@@transducer/result'] = _xfBase.result;\n  XMap.prototype['@@transducer/step'] = function (result, input) {\n    return this.xf['@@transducer/step'](result, this.f(input));\n  };\n\n  return XMap;\n}();\n\nvar _xmap = /*#__PURE__*/_curry2(function _xmap(f, xf) {\n  return new XMap(f, xf);\n});\nexport default _xmap;","export default function _has(prop, obj) {\n  return Object.prototype.hasOwnProperty.call(obj, prop);\n}","import _has from './_has';\n\nvar toString = Object.prototype.toString;\nvar _isArguments = function () {\n  return toString.call(arguments) === '[object Arguments]' ? function _isArguments(x) {\n    return toString.call(x) === '[object Arguments]';\n  } : function _isArguments(x) {\n    return _has('callee', x);\n  };\n};\n\nexport default _isArguments;","import _curry1 from './internal/_curry1';\nimport _has from './internal/_has';\nimport _isArguments from './internal/_isArguments';\n\n// cover IE < 9 keys issues\nvar hasEnumBug = ! /*#__PURE__*/{ toString: null }.propertyIsEnumerable('toString');\nvar nonEnumerableProps = ['constructor', 'valueOf', 'isPrototypeOf', 'toString', 'propertyIsEnumerable', 'hasOwnProperty', 'toLocaleString'];\n// Safari bug\nvar hasArgsEnumBug = /*#__PURE__*/function () {\n  'use strict';\n\n  return arguments.propertyIsEnumerable('length');\n}();\n\nvar contains = function contains(list, item) {\n  var idx = 0;\n  while (idx < list.length) {\n    if (list[idx] === item) {\n      return true;\n    }\n    idx += 1;\n  }\n  return false;\n};\n\n/**\n * Returns a list containing the names of all the enumerable own properties of\n * the supplied object.\n * Note that the order of the output array is not guaranteed to be consistent\n * across different JS platforms.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Object\n * @sig {k: v} -> [k]\n * @param {Object} obj The object to extract properties from\n * @return {Array} An array of the object's own properties.\n * @see R.keysIn, R.values\n * @example\n *\n *      R.keys({a: 1, b: 2, c: 3}); //=> ['a', 'b', 'c']\n */\nvar _keys = typeof Object.keys === 'function' && !hasArgsEnumBug ? function keys(obj) {\n  return Object(obj) !== obj ? [] : Object.keys(obj);\n} : function keys(obj) {\n  if (Object(obj) !== obj) {\n    return [];\n  }\n  var prop, nIdx;\n  var ks = [];\n  var checkArgsLength = hasArgsEnumBug && _isArguments(obj);\n  for (prop in obj) {\n    if (_has(prop, obj) && (!checkArgsLength || prop !== 'length')) {\n      ks[ks.length] = prop;\n    }\n  }\n  if (hasEnumBug) {\n    nIdx = nonEnumerableProps.length - 1;\n    while (nIdx >= 0) {\n      prop = nonEnumerableProps[nIdx];\n      if (_has(prop, obj) && !contains(ks, prop)) {\n        ks[ks.length] = prop;\n      }\n      nIdx -= 1;\n    }\n  }\n  return ks;\n};\nvar keys = /*#__PURE__*/_curry1(_keys);\nexport default keys;","import _curry2 from './internal/_curry2';\nimport _dispatchable from './internal/_dispatchable';\nimport _map from './internal/_map';\nimport _reduce from './internal/_reduce';\nimport _xmap from './internal/_xmap';\nimport curryN from './curryN';\nimport keys from './keys';\n\n/**\n * Takes a function and\n * a [functor](https://github.com/fantasyland/fantasy-land#functor),\n * applies the function to each of the functor's values, and returns\n * a functor of the same shape.\n *\n * Ramda provides suitable `map` implementations for `Array` and `Object`,\n * so this function may be applied to `[1, 2, 3]` or `{x: 1, y: 2, z: 3}`.\n *\n * Dispatches to the `map` method of the second argument, if present.\n *\n * Acts as a transducer if a transformer is given in list position.\n *\n * Also treats functions as functors and will compose them together.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig Functor f => (a -> b) -> f a -> f b\n * @param {Function} fn The function to be called on every element of the input `list`.\n * @param {Array} list The list to be iterated over.\n * @return {Array} The new list.\n * @see R.transduce, R.addIndex\n * @example\n *\n *      var double = x => x * 2;\n *\n *      R.map(double, [1, 2, 3]); //=> [2, 4, 6]\n *\n *      R.map(double, {x: 1, y: 2, z: 3}); //=> {x: 2, y: 4, z: 6}\n * @symb R.map(f, [a, b]) = [f(a), f(b)]\n * @symb R.map(f, { x: a, y: b }) = { x: f(a), y: f(b) }\n * @symb R.map(f, functor_o) = functor_o.map(f)\n */\nvar map = /*#__PURE__*/_curry2( /*#__PURE__*/_dispatchable(['fantasy-land/map', 'map'], _xmap, function map(fn, functor) {\n  switch (Object.prototype.toString.call(functor)) {\n    case '[object Function]':\n      return curryN(functor.length, function () {\n        return fn.call(this, functor.apply(this, arguments));\n      });\n    case '[object Object]':\n      return _reduce(function (acc, key) {\n        acc[key] = fn(functor[key]);\n        return acc;\n      }, {}, keys(functor));\n    default:\n      return _map(fn, functor);\n  }\n}));\nexport default map;","import _curry2 from './internal/_curry2';\n\n/**\n * Retrieve the value at a given path.\n *\n * @func\n * @memberOf R\n * @since v0.2.0\n * @category Object\n * @typedefn Idx = String | Int\n * @sig [Idx] -> {a} -> a | Undefined\n * @param {Array} path The path to use.\n * @param {Object} obj The object to retrieve the nested property from.\n * @return {*} The data at `path`.\n * @see R.prop\n * @example\n *\n *      R.path(['a', 'b'], {a: {b: 2}}); //=> 2\n *      R.path(['a', 'b'], {c: {b: 2}}); //=> undefined\n */\nvar path = /*#__PURE__*/_curry2(function path(paths, obj) {\n  var val = obj;\n  var idx = 0;\n  while (idx < paths.length) {\n    if (val == null) {\n      return;\n    }\n    val = val[paths[idx]];\n    idx += 1;\n  }\n  return val;\n});\nexport default path;","import _curry2 from './internal/_curry2';\nimport path from './path';\n\n/**\n * Returns a function that when supplied an object returns the indicated\n * property of that object, if it exists.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Object\n * @sig s -> {s: a} -> a | Undefined\n * @param {String} p The property name\n * @param {Object} obj The object to query\n * @return {*} The value at `obj.p`.\n * @see R.path\n * @example\n *\n *      R.prop('x', {x: 100}); //=> 100\n *      R.prop('x', {}); //=> undefined\n */\n\nvar prop = /*#__PURE__*/_curry2(function prop(p, obj) {\n  return path([p], obj);\n});\nexport default prop;","import _curry3 from './internal/_curry3';\nimport _reduce from './internal/_reduce';\n\n/**\n * Returns a single item by iterating through the list, successively calling\n * the iterator function and passing it an accumulator value and the current\n * value from the array, and then passing the result to the next call.\n *\n * The iterator function receives two values: *(acc, value)*. It may use\n * [`R.reduced`](#reduced) to shortcut the iteration.\n *\n * The arguments' order of [`reduceRight`](#reduceRight)'s iterator function\n * is *(value, acc)*.\n *\n * Note: `R.reduce` does not skip deleted or unassigned indices (sparse\n * arrays), unlike the native `Array.prototype.reduce` method. For more details\n * on this behavior, see:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/reduce#Description\n *\n * Dispatches to the `reduce` method of the third argument, if present. When\n * doing so, it is up to the user to handle the [`R.reduced`](#reduced)\n * shortcuting, as this is not implemented by `reduce`.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig ((a, b) -> a) -> a -> [b] -> a\n * @param {Function} fn The iterator function. Receives two values, the accumulator and the\n *        current element from the array.\n * @param {*} acc The accumulator value.\n * @param {Array} list The list to iterate over.\n * @return {*} The final, accumulated value.\n * @see R.reduced, R.addIndex, R.reduceRight\n * @example\n *\n *      R.reduce(R.subtract, 0, [1, 2, 3, 4]) // => ((((0 - 1) - 2) - 3) - 4) = -10\n *      //          -               -10\n *      //         / \\              / \\\n *      //        -   4           -6   4\n *      //       / \\              / \\\n *      //      -   3   ==>     -3   3\n *      //     / \\              / \\\n *      //    -   2           -1   2\n *      //   / \\              / \\\n *      //  0   1            0   1\n *\n * @symb R.reduce(f, a, [b, c, d]) = f(f(f(a, b), c), d)\n */\nvar reduce = /*#__PURE__*/_curry3(_reduce);\nexport default reduce;","import _concat from './internal/_concat';\nimport _curry2 from './internal/_curry2';\n\n/**\n * Returns a new list containing the contents of the given list, followed by\n * the given element.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig a -> [a] -> [a]\n * @param {*} el The element to add to the end of the new list.\n * @param {Array} list The list of elements to add a new item to.\n *        list.\n * @return {Array} A new list containing the elements of the old list followed by `el`.\n * @see R.prepend\n * @example\n *\n *      R.append('tests', ['write', 'more']); //=> ['write', 'more', 'tests']\n *      R.append('tests', []); //=> ['tests']\n *      R.append(['tests'], ['write', 'more']); //=> ['write', 'more', ['tests']]\n */\nvar append = /*#__PURE__*/_curry2(function append(el, list) {\n  return _concat(list, [el]);\n});\nexport default append;","import _curry1 from './internal/_curry1';\nimport keys from './keys';\n\n/**\n * Returns a list of all the enumerable own properties of the supplied object.\n * Note that the order of the output array is not guaranteed across different\n * JS platforms.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Object\n * @sig {k: v} -> [v]\n * @param {Object} obj The object to extract values from\n * @return {Array} An array of the values of the object's own properties.\n * @see R.valuesIn, R.keys\n * @example\n *\n *      R.values({a: 1, b: 2, c: 3}); //=> [1, 2, 3]\n */\nvar values = /*#__PURE__*/_curry1(function values(obj) {\n  var props = keys(obj);\n  var len = props.length;\n  var vals = [];\n  var idx = 0;\n  while (idx < len) {\n    vals[idx] = obj[props[idx]];\n    idx += 1;\n  }\n  return vals;\n});\nexport default values;","import _curry1 from './internal/_curry1';\n\n/**\n * Gives a single-word string description of the (native) type of a value,\n * returning such answers as 'Object', 'Number', 'Array', or 'Null'. Does not\n * attempt to distinguish user Object types any further, reporting them all as\n * 'Object'.\n *\n * @func\n * @memberOf R\n * @since v0.8.0\n * @category Type\n * @sig (* -> {*}) -> String\n * @param {*} val The value to test\n * @return {String}\n * @example\n *\n *      R.type({}); //=> \"Object\"\n *      R.type(1); //=> \"Number\"\n *      R.type(false); //=> \"Boolean\"\n *      R.type('s'); //=> \"String\"\n *      R.type(null); //=> \"Null\"\n *      R.type([]); //=> \"Array\"\n *      R.type(/[A-z]/); //=> \"RegExp\"\n *      R.type(() => {}); //=> \"Function\"\n *      R.type(undefined); //=> \"Undefined\"\n */\nvar type = /*#__PURE__*/_curry1(function type(val) {\n  return val === null ? 'Null' : val === undefined ? 'Undefined' : Object.prototype.toString.call(val).slice(8, -1);\n});\nexport default type;","export default function _pipe(f, g) {\n  return function () {\n    return g.call(this, f.apply(this, arguments));\n  };\n}","import _isArray from './_isArray';\n\n/**\n * This checks whether a function has a [methodname] function. If it isn't an\n * array it will execute that function otherwise it will default to the ramda\n * implementation.\n *\n * @private\n * @param {Function} fn ramda implemtation\n * @param {String} methodname property to check for a custom implementation\n * @return {Object} Whatever the return value of the method is.\n */\nexport default function _checkForMethod(methodname, fn) {\n  return function () {\n    var length = arguments.length;\n    if (length === 0) {\n      return fn();\n    }\n    var obj = arguments[length - 1];\n    return _isArray(obj) || typeof obj[methodname] !== 'function' ? fn.apply(this, arguments) : obj[methodname].apply(obj, Array.prototype.slice.call(arguments, 0, length - 1));\n  };\n}","import _checkForMethod from './internal/_checkForMethod';\nimport _curry3 from './internal/_curry3';\n\n/**\n * Returns the elements of the given list or string (or object with a `slice`\n * method) from `fromIndex` (inclusive) to `toIndex` (exclusive).\n *\n * Dispatches to the `slice` method of the third argument, if present.\n *\n * @func\n * @memberOf R\n * @since v0.1.4\n * @category List\n * @sig Number -> Number -> [a] -> [a]\n * @sig Number -> Number -> String -> String\n * @param {Number} fromIndex The start index (inclusive).\n * @param {Number} toIndex The end index (exclusive).\n * @param {*} list\n * @return {*}\n * @example\n *\n *      R.slice(1, 3, ['a', 'b', 'c', 'd']);        //=> ['b', 'c']\n *      R.slice(1, Infinity, ['a', 'b', 'c', 'd']); //=> ['b', 'c', 'd']\n *      R.slice(0, -1, ['a', 'b', 'c', 'd']);       //=> ['a', 'b', 'c']\n *      R.slice(-3, -1, ['a', 'b', 'c', 'd']);      //=> ['b', 'c']\n *      R.slice(0, 3, 'ramda');                     //=> 'ram'\n */\nvar slice = /*#__PURE__*/_curry3( /*#__PURE__*/_checkForMethod('slice', function slice(fromIndex, toIndex, list) {\n  return Array.prototype.slice.call(list, fromIndex, toIndex);\n}));\nexport default slice;","import _checkForMethod from './internal/_checkForMethod';\nimport _curry1 from './internal/_curry1';\nimport slice from './slice';\n\n/**\n * Returns all but the first element of the given list or string (or object\n * with a `tail` method).\n *\n * Dispatches to the `slice` method of the first argument, if present.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig [a] -> [a]\n * @sig String -> String\n * @param {*} list\n * @return {*}\n * @see R.head, R.init, R.last\n * @example\n *\n *      R.tail([1, 2, 3]);  //=> [2, 3]\n *      R.tail([1, 2]);     //=> [2]\n *      R.tail([1]);        //=> []\n *      R.tail([]);         //=> []\n *\n *      R.tail('abc');  //=> 'bc'\n *      R.tail('ab');   //=> 'b'\n *      R.tail('a');    //=> ''\n *      R.tail('');     //=> ''\n */\nvar tail = /*#__PURE__*/_curry1( /*#__PURE__*/_checkForMethod('tail', /*#__PURE__*/slice(1, Infinity)));\nexport default tail;","import _arity from './internal/_arity';\nimport _pipe from './internal/_pipe';\nimport reduce from './reduce';\nimport tail from './tail';\n\n/**\n * Performs left-to-right function composition. The leftmost function may have\n * any arity; the remaining functions must be unary.\n *\n * In some libraries this function is named `sequence`.\n *\n * **Note:** The result of pipe is not automatically curried.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig (((a, b, ..., n) -> o), (o -> p), ..., (x -> y), (y -> z)) -> ((a, b, ..., n) -> z)\n * @param {...Function} functions\n * @return {Function}\n * @see R.compose\n * @example\n *\n *      var f = R.pipe(Math.pow, R.negate, R.inc);\n *\n *      f(3, 4); // -(3^4) + 1\n * @symb R.pipe(f, g, h)(a, b) = h(g(f(a, b)))\n */\nexport default function pipe() {\n  if (arguments.length === 0) {\n    throw new Error('pipe requires at least one argument');\n  }\n  return _arity(arguments[0].length, reduce(_pipe, arguments[0], tail(arguments)));\n}","import _curry1 from './internal/_curry1';\nimport _isString from './internal/_isString';\n\n/**\n * Returns a new list or string with the elements or characters in reverse\n * order.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig [a] -> [a]\n * @sig String -> String\n * @param {Array|String} list\n * @return {Array|String}\n * @example\n *\n *      R.reverse([1, 2, 3]);  //=> [3, 2, 1]\n *      R.reverse([1, 2]);     //=> [2, 1]\n *      R.reverse([1]);        //=> [1]\n *      R.reverse([]);         //=> []\n *\n *      R.reverse('abc');      //=> 'cba'\n *      R.reverse('ab');       //=> 'ba'\n *      R.reverse('a');        //=> 'a'\n *      R.reverse('');         //=> ''\n */\nvar reverse = /*#__PURE__*/_curry1(function reverse(list) {\n  return _isString(list) ? list.split('').reverse().join('') : Array.prototype.slice.call(list, 0).reverse();\n});\nexport default reverse;","import pipe from './pipe';\nimport reverse from './reverse';\n\n/**\n * Performs right-to-left function composition. The rightmost function may have\n * any arity; the remaining functions must be unary.\n *\n * **Note:** The result of compose is not automatically curried.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig ((y -> z), (x -> y), ..., (o -> p), ((a, b, ..., n) -> o)) -> ((a, b, ..., n) -> z)\n * @param {...Function} ...functions The functions to compose\n * @return {Function}\n * @see R.pipe\n * @example\n *\n *      var classyGreeting = (firstName, lastName) => \"The name's \" + lastName + \", \" + firstName + \" \" + lastName\n *      var yellGreeting = R.compose(R.toUpper, classyGreeting);\n *      yellGreeting('James', 'Bond'); //=> \"THE NAME'S BOND, JAMES BOND\"\n *\n *      R.compose(Math.abs, R.add(1), R.multiply(2))(-4) //=> 7\n *\n * @symb R.compose(f, g, h)(a, b) = f(g(h(a, b)))\n */\nexport default function compose() {\n  if (arguments.length === 0) {\n    throw new Error('compose requires at least one argument');\n  }\n  return pipe.apply(this, reverse(arguments));\n}","export default function _arrayFromIterator(iter) {\n  var list = [];\n  var next;\n  while (!(next = iter.next()).done) {\n    list.push(next.value);\n  }\n  return list;\n}","export default function _containsWith(pred, x, list) {\n  var idx = 0;\n  var len = list.length;\n\n  while (idx < len) {\n    if (pred(x, list[idx])) {\n      return true;\n    }\n    idx += 1;\n  }\n  return false;\n}","import _curry2 from './internal/_curry2';\n\n/**\n * Returns true if its arguments are identical, false otherwise. Values are\n * identical if they reference the same memory. `NaN` is identical to `NaN`;\n * `0` and `-0` are not identical.\n *\n * @func\n * @memberOf R\n * @since v0.15.0\n * @category Relation\n * @sig a -> a -> Boolean\n * @param {*} a\n * @param {*} b\n * @return {Boolean}\n * @example\n *\n *      var o = {};\n *      R.identical(o, o); //=> true\n *      R.identical(1, 1); //=> true\n *      R.identical(1, '1'); //=> false\n *      R.identical([], []); //=> false\n *      R.identical(0, -0); //=> false\n *      R.identical(NaN, NaN); //=> true\n */\nvar identical = /*#__PURE__*/_curry2(function identical(a, b) {\n  // SameValue algorithm\n  if (a === b) {\n    // Steps 1-5, 7-10\n    // Steps 6.b-6.e: +0 != -0\n    return a !== 0 || 1 / a === 1 / b;\n  } else {\n    // Step 6.a: NaN == NaN\n    return a !== a && b !== b;\n  }\n});\nexport default identical;","import _arrayFromIterator from './_arrayFromIterator';\nimport _containsWith from './_containsWith';\nimport _functionName from './_functionName';\nimport _has from './_has';\nimport identical from '../identical';\nimport keys from '../keys';\nimport type from '../type';\n\n/**\n * private _uniqContentEquals function.\n * That function is checking equality of 2 iterator contents with 2 assumptions\n * - iterators lengths are the same\n * - iterators values are unique\n *\n * false-positive result will be returned for comparision of, e.g.\n * - [1,2,3] and [1,2,3,4]\n * - [1,1,1] and [1,2,3]\n * */\n\nfunction _uniqContentEquals(aIterator, bIterator, stackA, stackB) {\n  var a = _arrayFromIterator(aIterator);\n  var b = _arrayFromIterator(bIterator);\n\n  function eq(_a, _b) {\n    return _equals(_a, _b, stackA.slice(), stackB.slice());\n  }\n\n  // if *a* array contains any element that is not included in *b*\n  return !_containsWith(function (b, aItem) {\n    return !_containsWith(eq, aItem, b);\n  }, b, a);\n}\n\nexport default function _equals(a, b, stackA, stackB) {\n  if (identical(a, b)) {\n    return true;\n  }\n\n  var typeA = type(a);\n\n  if (typeA !== type(b)) {\n    return false;\n  }\n\n  if (a == null || b == null) {\n    return false;\n  }\n\n  if (typeof a['fantasy-land/equals'] === 'function' || typeof b['fantasy-land/equals'] === 'function') {\n    return typeof a['fantasy-land/equals'] === 'function' && a['fantasy-land/equals'](b) && typeof b['fantasy-land/equals'] === 'function' && b['fantasy-land/equals'](a);\n  }\n\n  if (typeof a.equals === 'function' || typeof b.equals === 'function') {\n    return typeof a.equals === 'function' && a.equals(b) && typeof b.equals === 'function' && b.equals(a);\n  }\n\n  switch (typeA) {\n    case 'Arguments':\n    case 'Array':\n    case 'Object':\n      if (typeof a.constructor === 'function' && _functionName(a.constructor) === 'Promise') {\n        return a === b;\n      }\n      break;\n    case 'Boolean':\n    case 'Number':\n    case 'String':\n      if (!(typeof a === typeof b && identical(a.valueOf(), b.valueOf()))) {\n        return false;\n      }\n      break;\n    case 'Date':\n      if (!identical(a.valueOf(), b.valueOf())) {\n        return false;\n      }\n      break;\n    case 'Error':\n      return a.name === b.name && a.message === b.message;\n    case 'RegExp':\n      if (!(a.source === b.source && a.global === b.global && a.ignoreCase === b.ignoreCase && a.multiline === b.multiline && a.sticky === b.sticky && a.unicode === b.unicode)) {\n        return false;\n      }\n      break;\n  }\n\n  var idx = stackA.length - 1;\n  while (idx >= 0) {\n    if (stackA[idx] === a) {\n      return stackB[idx] === b;\n    }\n    idx -= 1;\n  }\n\n  switch (typeA) {\n    case 'Map':\n      if (a.size !== b.size) {\n        return false;\n      }\n\n      return _uniqContentEquals(a.entries(), b.entries(), stackA.concat([a]), stackB.concat([b]));\n    case 'Set':\n      if (a.size !== b.size) {\n        return false;\n      }\n\n      return _uniqContentEquals(a.values(), b.values(), stackA.concat([a]), stackB.concat([b]));\n    case 'Arguments':\n    case 'Array':\n    case 'Object':\n    case 'Boolean':\n    case 'Number':\n    case 'String':\n    case 'Date':\n    case 'Error':\n    case 'RegExp':\n    case 'Int8Array':\n    case 'Uint8Array':\n    case 'Uint8ClampedArray':\n    case 'Int16Array':\n    case 'Uint16Array':\n    case 'Int32Array':\n    case 'Uint32Array':\n    case 'Float32Array':\n    case 'Float64Array':\n    case 'ArrayBuffer':\n      break;\n    default:\n      // Values of other types are only equal if identical.\n      return false;\n  }\n\n  var keysA = keys(a);\n  if (keysA.length !== keys(b).length) {\n    return false;\n  }\n\n  var extendedStackA = stackA.concat([a]);\n  var extendedStackB = stackB.concat([b]);\n\n  idx = keysA.length - 1;\n  while (idx >= 0) {\n    var key = keysA[idx];\n    if (!(_has(key, b) && _equals(b[key], a[key], extendedStackA, extendedStackB))) {\n      return false;\n    }\n    idx -= 1;\n  }\n  return true;\n}","export default function _functionName(f) {\n  // String(x => x) evaluates to \"x => x\", so the pattern may not match.\n  var match = String(f).match(/^function (\\w*)/);\n  return match == null ? '' : match[1];\n}","import _curry2 from './internal/_curry2';\nimport _equals from './internal/_equals';\n\n/**\n * Returns `true` if its arguments are equivalent, `false` otherwise. Handles\n * cyclical data structures.\n *\n * Dispatches symmetrically to the `equals` methods of both arguments, if\n * present.\n *\n * @func\n * @memberOf R\n * @since v0.15.0\n * @category Relation\n * @sig a -> b -> Boolean\n * @param {*} a\n * @param {*} b\n * @return {Boolean}\n * @example\n *\n *      R.equals(1, 1); //=> true\n *      R.equals(1, '1'); //=> false\n *      R.equals([1, 2, 3], [1, 2, 3]); //=> true\n *\n *      var a = {}; a.v = a;\n *      var b = {}; b.v = b;\n *      R.equals(a, b); //=> true\n */\nvar equals = /*#__PURE__*/_curry2(function equals(a, b) {\n  return _equals(a, b, [], []);\n});\nexport default equals;","import _indexOf from './_indexOf';\n\nexport default function _contains(a, list) {\n  return _indexOf(list, a, 0) >= 0;\n}","import equals from '../equals';\n\nexport default function _indexOf(list, a, idx) {\n  var inf, item;\n  // Array.prototype.indexOf doesn't exist below IE9\n  if (typeof list.indexOf === 'function') {\n    switch (typeof a) {\n      case 'number':\n        if (a === 0) {\n          // manually crawl the list to distinguish between +0 and -0\n          inf = 1 / a;\n          while (idx < list.length) {\n            item = list[idx];\n            if (item === 0 && 1 / item === inf) {\n              return idx;\n            }\n            idx += 1;\n          }\n          return -1;\n        } else if (a !== a) {\n          // NaN\n          while (idx < list.length) {\n            item = list[idx];\n            if (typeof item === 'number' && item !== item) {\n              return idx;\n            }\n            idx += 1;\n          }\n          return -1;\n        }\n        // non-zero numbers can utilise Set\n        return list.indexOf(a, idx);\n\n      // all these types can utilise Set\n      case 'string':\n      case 'boolean':\n      case 'function':\n      case 'undefined':\n        return list.indexOf(a, idx);\n\n      case 'object':\n        if (a === null) {\n          // null can utilise Set\n          return list.indexOf(a, idx);\n        }\n    }\n  }\n  // anything else not covered above, defer to R.equals\n  while (idx < list.length) {\n    if (equals(list[idx], a)) {\n      return idx;\n    }\n    idx += 1;\n  }\n  return -1;\n}","export default function _quote(s) {\n  var escaped = s.replace(/\\\\/g, '\\\\\\\\').replace(/[\\b]/g, '\\\\b') // \\b matches word boundary; [\\b] matches backspace\n  .replace(/\\f/g, '\\\\f').replace(/\\n/g, '\\\\n').replace(/\\r/g, '\\\\r').replace(/\\t/g, '\\\\t').replace(/\\v/g, '\\\\v').replace(/\\0/g, '\\\\0');\n\n  return '\"' + escaped.replace(/\"/g, '\\\\\"') + '\"';\n}","/**\n * Polyfill from <https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/toISOString>.\n */\nvar pad = function pad(n) {\n  return (n < 10 ? '0' : '') + n;\n};\n\nvar _toISOString = typeof Date.prototype.toISOString === 'function' ? function _toISOString(d) {\n  return d.toISOString();\n} : function _toISOString(d) {\n  return d.getUTCFullYear() + '-' + pad(d.getUTCMonth() + 1) + '-' + pad(d.getUTCDate()) + 'T' + pad(d.getUTCHours()) + ':' + pad(d.getUTCMinutes()) + ':' + pad(d.getUTCSeconds()) + '.' + (d.getUTCMilliseconds() / 1000).toFixed(3).slice(2, 5) + 'Z';\n};\n\nexport default _toISOString;","import _curry2 from './_curry2';\nimport _xfBase from './_xfBase';\n\nvar XFilter = /*#__PURE__*/function () {\n  function XFilter(f, xf) {\n    this.xf = xf;\n    this.f = f;\n  }\n  XFilter.prototype['@@transducer/init'] = _xfBase.init;\n  XFilter.prototype['@@transducer/result'] = _xfBase.result;\n  XFilter.prototype['@@transducer/step'] = function (result, input) {\n    return this.f(input) ? this.xf['@@transducer/step'](result, input) : result;\n  };\n\n  return XFilter;\n}();\n\nvar _xfilter = /*#__PURE__*/_curry2(function _xfilter(f, xf) {\n  return new XFilter(f, xf);\n});\nexport default _xfilter;","import _curry2 from './internal/_curry2';\nimport _dispatchable from './internal/_dispatchable';\nimport _filter from './internal/_filter';\nimport _isObject from './internal/_isObject';\nimport _reduce from './internal/_reduce';\nimport _xfilter from './internal/_xfilter';\nimport keys from './keys';\n\n/**\n * Takes a predicate and a `Filterable`, and returns a new filterable of the\n * same type containing the members of the given filterable which satisfy the\n * given predicate. Filterable objects include plain objects or any object\n * that has a filter method such as `Array`.\n *\n * Dispatches to the `filter` method of the second argument, if present.\n *\n * Acts as a transducer if a transformer is given in list position.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig Filterable f => (a -> Boolean) -> f a -> f a\n * @param {Function} pred\n * @param {Array} filterable\n * @return {Array} Filterable\n * @see R.reject, R.transduce, R.addIndex\n * @example\n *\n *      var isEven = n => n % 2 === 0;\n *\n *      R.filter(isEven, [1, 2, 3, 4]); //=> [2, 4]\n *\n *      R.filter(isEven, {a: 1, b: 2, c: 3, d: 4}); //=> {b: 2, d: 4}\n */\nvar filter = /*#__PURE__*/_curry2( /*#__PURE__*/_dispatchable(['filter'], _xfilter, function (pred, filterable) {\n  return _isObject(filterable) ? _reduce(function (acc, key) {\n    if (pred(filterable[key])) {\n      acc[key] = filterable[key];\n    }\n    return acc;\n  }, {}, keys(filterable)) :\n  // else\n  _filter(pred, filterable);\n}));\nexport default filter;","export default function _isObject(x) {\n  return Object.prototype.toString.call(x) === '[object Object]';\n}","export default function _filter(fn, list) {\n  var idx = 0;\n  var len = list.length;\n  var result = [];\n\n  while (idx < len) {\n    if (fn(list[idx])) {\n      result[result.length] = list[idx];\n    }\n    idx += 1;\n  }\n  return result;\n}","import _complement from './internal/_complement';\nimport _curry2 from './internal/_curry2';\nimport filter from './filter';\n\n/**\n * The complement of [`filter`](#filter).\n *\n * Acts as a transducer if a transformer is given in list position. Filterable\n * objects include plain objects or any object that has a filter method such\n * as `Array`.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig Filterable f => (a -> Boolean) -> f a -> f a\n * @param {Function} pred\n * @param {Array} filterable\n * @return {Array}\n * @see R.filter, R.transduce, R.addIndex\n * @example\n *\n *      var isOdd = (n) => n % 2 === 1;\n *\n *      R.reject(isOdd, [1, 2, 3, 4]); //=> [2, 4]\n *\n *      R.reject(isOdd, {a: 1, b: 2, c: 3, d: 4}); //=> {b: 2, d: 4}\n */\nvar reject = /*#__PURE__*/_curry2(function reject(pred, filterable) {\n  return filter(_complement(pred), filterable);\n});\nexport default reject;","export default function _complement(f) {\n  return function () {\n    return !f.apply(this, arguments);\n  };\n}","import _curry1 from './internal/_curry1';\nimport _toString from './internal/_toString';\n\n/**\n * Returns the string representation of the given value. `eval`'ing the output\n * should result in a value equivalent to the input value. Many of the built-in\n * `toString` methods do not satisfy this requirement.\n *\n * If the given value is an `[object Object]` with a `toString` method other\n * than `Object.prototype.toString`, this method is invoked with no arguments\n * to produce the return value. This means user-defined constructor functions\n * can provide a suitable `toString` method. For example:\n *\n *     function Point(x, y) {\n *       this.x = x;\n *       this.y = y;\n *     }\n *\n *     Point.prototype.toString = function() {\n *       return 'new Point(' + this.x + ', ' + this.y + ')';\n *     };\n *\n *     R.toString(new Point(1, 2)); //=> 'new Point(1, 2)'\n *\n * @func\n * @memberOf R\n * @since v0.14.0\n * @category String\n * @sig * -> String\n * @param {*} val\n * @return {String}\n * @example\n *\n *      R.toString(42); //=> '42'\n *      R.toString('abc'); //=> '\"abc\"'\n *      R.toString([1, 2, 3]); //=> '[1, 2, 3]'\n *      R.toString({foo: 1, bar: 2, baz: 3}); //=> '{\"bar\": 2, \"baz\": 3, \"foo\": 1}'\n *      R.toString(new Date('2001-02-03T04:05:06Z')); //=> 'new Date(\"2001-02-03T04:05:06.000Z\")'\n */\nvar toString = /*#__PURE__*/_curry1(function toString(val) {\n  return _toString(val, []);\n});\nexport default toString;","import _contains from './_contains';\nimport _map from './_map';\nimport _quote from './_quote';\nimport _toISOString from './_toISOString';\nimport keys from '../keys';\nimport reject from '../reject';\n\nexport default function _toString(x, seen) {\n  var recur = function recur(y) {\n    var xs = seen.concat([x]);\n    return _contains(y, xs) ? '<Circular>' : _toString(y, xs);\n  };\n\n  //  mapPairs :: (Object, [String]) -> [String]\n  var mapPairs = function (obj, keys) {\n    return _map(function (k) {\n      return _quote(k) + ': ' + recur(obj[k]);\n    }, keys.slice().sort());\n  };\n\n  switch (Object.prototype.toString.call(x)) {\n    case '[object Arguments]':\n      return '(function() { return arguments; }(' + _map(recur, x).join(', ') + '))';\n    case '[object Array]':\n      return '[' + _map(recur, x).concat(mapPairs(x, reject(function (k) {\n        return (/^\\d+$/.test(k)\n        );\n      }, keys(x)))).join(', ') + ']';\n    case '[object Boolean]':\n      return typeof x === 'object' ? 'new Boolean(' + recur(x.valueOf()) + ')' : x.toString();\n    case '[object Date]':\n      return 'new Date(' + (isNaN(x.valueOf()) ? recur(NaN) : _quote(_toISOString(x))) + ')';\n    case '[object Null]':\n      return 'null';\n    case '[object Number]':\n      return typeof x === 'object' ? 'new Number(' + recur(x.valueOf()) + ')' : 1 / x === -Infinity ? '-0' : x.toString(10);\n    case '[object String]':\n      return typeof x === 'object' ? 'new String(' + recur(x.valueOf()) + ')' : _quote(x);\n    case '[object Undefined]':\n      return 'undefined';\n    default:\n      if (typeof x.toString === 'function') {\n        var repr = x.toString();\n        if (repr !== '[object Object]') {\n          return repr;\n        }\n      }\n      return '{' + mapPairs(x, keys(x)).join(', ') + '}';\n  }\n}","import _contains from './internal/_contains';\nimport _curry2 from './internal/_curry2';\n\n/**\n * Returns `true` if the specified value is equal, in [`R.equals`](#equals)\n * terms, to at least one element of the given list; `false` otherwise.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig a -> [a] -> Boolean\n * @param {Object} a The item to compare against.\n * @param {Array} list The array to consider.\n * @return {Boolean} `true` if an equivalent item is in the list, `false` otherwise.\n * @see R.any\n * @example\n *\n *      R.contains(3, [1, 2, 3]); //=> true\n *      R.contains(4, [1, 2, 3]); //=> false\n *      R.contains({ name: 'Fred' }, [{ name: 'Fred' }]); //=> true\n *      R.contains([42], [[42]]); //=> true\n */\nvar contains = /*#__PURE__*/_curry2(_contains);\nexport default contains;","import _contains from './internal/_contains';\nimport _curry2 from './internal/_curry2';\n\n/**\n * Finds the set (i.e. no duplicates) of all elements in the first list not\n * contained in the second list. Objects and Arrays are compared in terms of\n * value equality, not reference equality.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Relation\n * @sig [*] -> [*] -> [*]\n * @param {Array} list1 The first list.\n * @param {Array} list2 The second list.\n * @return {Array} The elements in `list1` that are not in `list2`.\n * @see R.differenceWith, R.symmetricDifference, R.symmetricDifferenceWith, R.without\n * @example\n *\n *      R.difference([1,2,3,4], [7,6,5,4,3]); //=> [1,2]\n *      R.difference([7,6,5,4,3], [1,2,3,4]); //=> [7,6,5]\n *      R.difference([{a: 1}, {b: 2}], [{a: 1}, {c: 3}]) //=> [{b: 2}]\n */\nvar difference = /*#__PURE__*/_curry2(function difference(first, second) {\n  var out = [];\n  var idx = 0;\n  var firstLen = first.length;\n  while (idx < firstLen) {\n    if (!_contains(first[idx], second) && !_contains(first[idx], out)) {\n      out[out.length] = first[idx];\n    }\n    idx += 1;\n  }\n  return out;\n});\nexport default difference;","import _checkForMethod from './internal/_checkForMethod';\nimport _curry2 from './internal/_curry2';\n\n/**\n * Iterate over an input `list`, calling a provided function `fn` for each\n * element in the list.\n *\n * `fn` receives one argument: *(value)*.\n *\n * Note: `R.forEach` does not skip deleted or unassigned indices (sparse\n * arrays), unlike the native `Array.prototype.forEach` method. For more\n * details on this behavior, see:\n * https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Array/forEach#Description\n *\n * Also note that, unlike `Array.prototype.forEach`, Ramda's `forEach` returns\n * the original array. In some libraries this function is named `each`.\n *\n * Dispatches to the `forEach` method of the second argument, if present.\n *\n * @func\n * @memberOf R\n * @since v0.1.1\n * @category List\n * @sig (a -> *) -> [a] -> [a]\n * @param {Function} fn The function to invoke. Receives one argument, `value`.\n * @param {Array} list The list to iterate over.\n * @return {Array} The original list.\n * @see R.addIndex\n * @example\n *\n *      var printXPlusFive = x => console.log(x + 5);\n *      R.forEach(printXPlusFive, [1, 2, 3]); //=> [1, 2, 3]\n *      // logs 6\n *      // logs 7\n *      // logs 8\n * @symb R.forEach(f, [a, b, c]) = [a, b, c]\n */\nvar forEach = /*#__PURE__*/_curry2( /*#__PURE__*/_checkForMethod('forEach', function forEach(fn, list) {\n  var len = list.length;\n  var idx = 0;\n  while (idx < len) {\n    fn(list[idx]);\n    idx += 1;\n  }\n  return list;\n}));\nexport default forEach;","import _curry2 from './internal/_curry2';\nimport keys from './keys';\n\n/**\n * Iterate over an input `object`, calling a provided function `fn` for each\n * key and value in the object.\n *\n * `fn` receives three argument: *(value, key, obj)*.\n *\n * @func\n * @memberOf R\n * @since v0.23.0\n * @category Object\n * @sig ((a, String, StrMap a) -> Any) -> StrMap a -> StrMap a\n * @param {Function} fn The function to invoke. Receives three argument, `value`, `key`, `obj`.\n * @param {Object} obj The object to iterate over.\n * @return {Object} The original object.\n * @example\n *\n *      var printKeyConcatValue = (value, key) => console.log(key + ':' + value);\n *      R.forEachObjIndexed(printKeyConcatValue, {x: 1, y: 2}); //=> {x: 1, y: 2}\n *      // logs x:1\n *      // logs y:2\n * @symb R.forEachObjIndexed(f, {x: a, y: b}) = {x: a, y: b}\n */\nvar forEachObjIndexed = /*#__PURE__*/_curry2(function forEachObjIndexed(fn, obj) {\n  var keyList = keys(obj);\n  var idx = 0;\n  while (idx < keyList.length) {\n    var key = keyList[idx];\n    fn(obj[key], key, obj);\n    idx += 1;\n  }\n  return obj;\n});\nexport default forEachObjIndexed;","import _curry2 from './internal/_curry2';\nimport _has from './internal/_has';\n\n/**\n * Returns whether or not an object has an own property with the specified name\n *\n * @func\n * @memberOf R\n * @since v0.7.0\n * @category Object\n * @sig s -> {s: x} -> Boolean\n * @param {String} prop The name of the property to check for.\n * @param {Object} obj The object to query.\n * @return {Boolean} Whether the property exists.\n * @example\n *\n *      var hasName = R.has('name');\n *      hasName({name: 'alice'});   //=> true\n *      hasName({name: 'bob'});     //=> true\n *      hasName({});                //=> false\n *\n *      var point = {x: 0, y: 0};\n *      var pointHas = R.has(R.__, point);\n *      pointHas('x');  //=> true\n *      pointHas('y');  //=> true\n *      pointHas('z');  //=> false\n */\nvar has = /*#__PURE__*/_curry2(_has);\nexport default has;","export default function _identity(x) {\n  return x;\n}","import _curry1 from './internal/_curry1';\nimport _identity from './internal/_identity';\n\n/**\n * A function that does nothing but return the parameter supplied to it. Good\n * as a default or placeholder function.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig a -> a\n * @param {*} x The value to return.\n * @return {*} The input value, `x`.\n * @example\n *\n *      R.identity(1); //=> 1\n *\n *      var obj = {};\n *      R.identity(obj) === obj; //=> true\n * @symb R.identity(a) = a\n */\nvar identity = /*#__PURE__*/_curry1(_identity);\nexport default identity;","import _contains from './_contains';\n\nvar _Set = /*#__PURE__*/function () {\n  function _Set() {\n    /* globals Set */\n    this._nativeSet = typeof Set === 'function' ? new Set() : null;\n    this._items = {};\n  }\n\n  // until we figure out why jsdoc chokes on this\n  // @param item The item to add to the Set\n  // @returns {boolean} true if the item did not exist prior, otherwise false\n  //\n  _Set.prototype.add = function (item) {\n    return !hasOrAdd(item, true, this);\n  };\n\n  //\n  // @param item The item to check for existence in the Set\n  // @returns {boolean} true if the item exists in the Set, otherwise false\n  //\n  _Set.prototype.has = function (item) {\n    return hasOrAdd(item, false, this);\n  };\n\n  //\n  // Combines the logic for checking whether an item is a member of the set and\n  // for adding a new item to the set.\n  //\n  // @param item       The item to check or add to the Set instance.\n  // @param shouldAdd  If true, the item will be added to the set if it doesn't\n  //                   already exist.\n  // @param set        The set instance to check or add to.\n  // @return {boolean} true if the item already existed, otherwise false.\n  //\n  return _Set;\n}();\n\nfunction hasOrAdd(item, shouldAdd, set) {\n  var type = typeof item;\n  var prevSize, newSize;\n  switch (type) {\n    case 'string':\n    case 'number':\n      // distinguish between +0 and -0\n      if (item === 0 && 1 / item === -Infinity) {\n        if (set._items['-0']) {\n          return true;\n        } else {\n          if (shouldAdd) {\n            set._items['-0'] = true;\n          }\n          return false;\n        }\n      }\n      // these types can all utilise the native Set\n      if (set._nativeSet !== null) {\n        if (shouldAdd) {\n          prevSize = set._nativeSet.size;\n          set._nativeSet.add(item);\n          newSize = set._nativeSet.size;\n          return newSize === prevSize;\n        } else {\n          return set._nativeSet.has(item);\n        }\n      } else {\n        if (!(type in set._items)) {\n          if (shouldAdd) {\n            set._items[type] = {};\n            set._items[type][item] = true;\n          }\n          return false;\n        } else if (item in set._items[type]) {\n          return true;\n        } else {\n          if (shouldAdd) {\n            set._items[type][item] = true;\n          }\n          return false;\n        }\n      }\n\n    case 'boolean':\n      // set._items['boolean'] holds a two element array\n      // representing [ falseExists, trueExists ]\n      if (type in set._items) {\n        var bIdx = item ? 1 : 0;\n        if (set._items[type][bIdx]) {\n          return true;\n        } else {\n          if (shouldAdd) {\n            set._items[type][bIdx] = true;\n          }\n          return false;\n        }\n      } else {\n        if (shouldAdd) {\n          set._items[type] = item ? [false, true] : [true, false];\n        }\n        return false;\n      }\n\n    case 'function':\n      // compare functions for reference equality\n      if (set._nativeSet !== null) {\n        if (shouldAdd) {\n          prevSize = set._nativeSet.size;\n          set._nativeSet.add(item);\n          newSize = set._nativeSet.size;\n          return newSize === prevSize;\n        } else {\n          return set._nativeSet.has(item);\n        }\n      } else {\n        if (!(type in set._items)) {\n          if (shouldAdd) {\n            set._items[type] = [item];\n          }\n          return false;\n        }\n        if (!_contains(item, set._items[type])) {\n          if (shouldAdd) {\n            set._items[type].push(item);\n          }\n          return false;\n        }\n        return true;\n      }\n\n    case 'undefined':\n      if (set._items[type]) {\n        return true;\n      } else {\n        if (shouldAdd) {\n          set._items[type] = true;\n        }\n        return false;\n      }\n\n    case 'object':\n      if (item === null) {\n        if (!set._items['null']) {\n          if (shouldAdd) {\n            set._items['null'] = true;\n          }\n          return false;\n        }\n        return true;\n      }\n    /* falls through */\n    default:\n      // reduce the search size of heterogeneous sets by creating buckets\n      // for each type.\n      type = Object.prototype.toString.call(item);\n      if (!(type in set._items)) {\n        if (shouldAdd) {\n          set._items[type] = [item];\n        }\n        return false;\n      }\n      // scan through all previously applied items\n      if (!_contains(item, set._items[type])) {\n        if (shouldAdd) {\n          set._items[type].push(item);\n        }\n        return false;\n      }\n      return true;\n  }\n}\n\n// A simple Set type that honours R.equals semantics\nexport default _Set;","import _Set from './internal/_Set';\nimport _curry2 from './internal/_curry2';\n\n/**\n * Returns a new list containing only one copy of each element in the original\n * list, based upon the value returned by applying the supplied function to\n * each list element. Prefers the first item if the supplied function produces\n * the same value on two items. [`R.equals`](#equals) is used for comparison.\n *\n * @func\n * @memberOf R\n * @since v0.16.0\n * @category List\n * @sig (a -> b) -> [a] -> [a]\n * @param {Function} fn A function used to produce a value to use during comparisons.\n * @param {Array} list The array to consider.\n * @return {Array} The list of unique items.\n * @example\n *\n *      R.uniqBy(Math.abs, [-1, -5, 2, 10, 1, 2]); //=> [-1, -5, 2, 10]\n */\nvar uniqBy = /*#__PURE__*/_curry2(function uniqBy(fn, list) {\n  var set = new _Set();\n  var result = [];\n  var idx = 0;\n  var appliedItem, item;\n\n  while (idx < list.length) {\n    item = list[idx];\n    appliedItem = fn(item);\n    if (set.add(appliedItem)) {\n      result.push(item);\n    }\n    idx += 1;\n  }\n  return result;\n});\nexport default uniqBy;","import identity from './identity';\nimport uniqBy from './uniqBy';\n\n/**\n * Returns a new list containing only one copy of each element in the original\n * list. [`R.equals`](#equals) is used to determine equality.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig [a] -> [a]\n * @param {Array} list The array to consider.\n * @return {Array} The list of unique items.\n * @example\n *\n *      R.uniq([1, 1, 2, 1]); //=> [1, 2]\n *      R.uniq([1, '1']);     //=> [1, '1']\n *      R.uniq([[42], [42]]); //=> [[42]]\n */\nvar uniq = /*#__PURE__*/uniqBy(identity);\nexport default uniq;","import _curry2 from './internal/_curry2';\nimport _isFunction from './internal/_isFunction';\nimport curryN from './curryN';\nimport toString from './toString';\n\n/**\n * Turns a named method with a specified arity into a function that can be\n * called directly supplied with arguments and a target object.\n *\n * The returned function is curried and accepts `arity + 1` parameters where\n * the final parameter is the target object.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category Function\n * @sig Number -> String -> (a -> b -> ... -> n -> Object -> *)\n * @param {Number} arity Number of arguments the returned function should take\n *        before the target object.\n * @param {String} method Name of the method to call.\n * @return {Function} A new curried function.\n * @see R.construct\n * @example\n *\n *      var sliceFrom = R.invoker(1, 'slice');\n *      sliceFrom(6, 'abcdefghijklm'); //=> 'ghijklm'\n *      var sliceFrom6 = R.invoker(2, 'slice')(6);\n *      sliceFrom6(8, 'abcdefghijklm'); //=> 'gh'\n * @symb R.invoker(0, 'method')(o) = o['method']()\n * @symb R.invoker(1, 'method')(a, o) = o['method'](a)\n * @symb R.invoker(2, 'method')(a, b, o) = o['method'](a, b)\n */\nvar invoker = /*#__PURE__*/_curry2(function invoker(arity, method) {\n  return curryN(arity + 1, function () {\n    var target = arguments[arity];\n    if (target != null && _isFunction(target[method])) {\n      return target[method].apply(target, Array.prototype.slice.call(arguments, 0, arity));\n    }\n    throw new TypeError(toString(target) + ' does not have a method named \"' + method + '\"');\n  });\n});\nexport default invoker;","export default function _isFunction(x) {\n  return Object.prototype.toString.call(x) === '[object Function]';\n}","import invoker from './invoker';\n\n/**\n * Returns a string made by inserting the `separator` between each element and\n * concatenating all the elements into a single string.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig String -> [a] -> String\n * @param {Number|String} separator The string used to separate the elements.\n * @param {Array} xs The elements to join into a string.\n * @return {String} str The string made by concatenating `xs` with `separator`.\n * @see R.split\n * @example\n *\n *      var spacer = R.join(' ');\n *      spacer(['a', 2, 3.4]);   //=> 'a 2 3.4'\n *      R.join('|', [1, 2, 3]);    //=> '1|2|3'\n */\nvar join = /*#__PURE__*/invoker(1, 'join');\nexport default join;","import _concat from './internal/_concat';\nimport _createPartialApplicator from './internal/_createPartialApplicator';\nimport flip from './flip';\n\n/**\n * Takes a function `f` and a list of arguments, and returns a function `g`.\n * When applied, `g` returns the result of applying `f` to the arguments\n * provided to `g` followed by the arguments provided initially.\n *\n * @func\n * @memberOf R\n * @since v0.10.0\n * @category Function\n * @sig ((a, b, c, ..., n) -> x) -> [d, e, f, ..., n] -> ((a, b, c, ...) -> x)\n * @param {Function} f\n * @param {Array} args\n * @return {Function}\n * @see R.partial\n * @example\n *\n *      var greet = (salutation, title, firstName, lastName) =>\n *        salutation + ', ' + title + ' ' + firstName + ' ' + lastName + '!';\n *\n *      var greetMsJaneJones = R.partialRight(greet, ['Ms.', 'Jane', 'Jones']);\n *\n *      greetMsJaneJones('Hello'); //=> 'Hello, Ms. Jane Jones!'\n * @symb R.partialRight(f, [a, b])(c, d) = f(c, d, a, b)\n */\nvar partialRight = /*#__PURE__*/_createPartialApplicator( /*#__PURE__*/flip(_concat));\nexport default partialRight;","import _curry2 from './internal/_curry2';\n\n/**\n * Returns a copy of the list, sorted according to the comparator function,\n * which should accept two values at a time and return a negative number if the\n * first value is smaller, a positive number if it's larger, and zero if they\n * are equal. Please note that this is a **copy** of the list. It does not\n * modify the original.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category List\n * @sig ((a, a) -> Number) -> [a] -> [a]\n * @param {Function} comparator A sorting function :: a -> b -> Int\n * @param {Array} list The list to sort\n * @return {Array} a new array with its elements sorted by the comparator function.\n * @example\n *\n *      var diff = function(a, b) { return a - b; };\n *      R.sort(diff, [4,2,7,5]); //=> [2, 4, 5, 7]\n */\nvar sort = /*#__PURE__*/_curry2(function sort(comparator, list) {\n  return Array.prototype.slice.call(list, 0).sort(comparator);\n});\nexport default sort;","import invoker from './invoker';\n\n/**\n * Splits a string into an array of strings based on the given\n * separator.\n *\n * @func\n * @memberOf R\n * @since v0.1.0\n * @category String\n * @sig (String | RegExp) -> String -> [String]\n * @param {String|RegExp} sep The pattern.\n * @param {String} str The string to separate into an array.\n * @return {Array} The array of strings from `str` separated by `str`.\n * @see R.join\n * @example\n *\n *      var pathComponents = R.split('/');\n *      R.tail(pathComponents('/usr/local/bin/node')); //=> ['usr', 'local', 'bin', 'node']\n *\n *      R.split('.', 'a.b.c.xyz.d'); //=> ['a', 'b', 'c', 'xyz', 'd']\n */\nvar split = /*#__PURE__*/invoker(1, 'split');\nexport default split;","import _curry1 from './internal/_curry1';\nimport _has from './internal/_has';\n\n/**\n * Converts an object into an array of key, value arrays. Only the object's\n * own properties are used.\n * Note that the order of the output array is not guaranteed to be consistent\n * across different JS platforms.\n *\n * @func\n * @memberOf R\n * @since v0.4.0\n * @category Object\n * @sig {String: *} -> [[String,*]]\n * @param {Object} obj The object to extract from\n * @return {Array} An array of key, value arrays from the object's own properties.\n * @see R.fromPairs\n * @example\n *\n *      R.toPairs({a: 1, b: 2, c: 3}); //=> [['a', 1], ['b', 2], ['c', 3]]\n */\nvar toPairs = /*#__PURE__*/_curry1(function toPairs(obj) {\n  var pairs = [];\n  for (var prop in obj) {\n    if (_has(prop, obj)) {\n      pairs[pairs.length] = [prop, obj[prop]];\n    }\n  }\n  return pairs;\n});\nexport default toPairs;","import _curry1 from './internal/_curry1';\n\nvar ws = '\\x09\\x0A\\x0B\\x0C\\x0D\\x20\\xA0\\u1680\\u180E\\u2000\\u2001\\u2002\\u2003' + '\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200A\\u202F\\u205F\\u3000\\u2028' + '\\u2029\\uFEFF';\nvar zeroWidth = '\\u200b';\nvar hasProtoTrim = typeof String.prototype.trim === 'function';\n/**\n * Removes (strips) whitespace from both ends of the string.\n *\n * @func\n * @memberOf R\n * @since v0.6.0\n * @category String\n * @sig String -> String\n * @param {String} str The string to trim.\n * @return {String} Trimmed version of `str`.\n * @example\n *\n *      R.trim('   xyz  '); //=> 'xyz'\n *      R.map(R.trim, R.split(',', 'x, y, z')); //=> ['x', 'y', 'z']\n */\nvar _trim = !hasProtoTrim || /*#__PURE__*/ws.trim() || ! /*#__PURE__*/zeroWidth.trim() ? function trim(str) {\n  var beginRx = new RegExp('^[' + ws + '][' + ws + ']*');\n  var endRx = new RegExp('[' + ws + '][' + ws + ']*$');\n  return str.replace(beginRx, '').replace(endRx, '');\n} : function trim(str) {\n  return str.trim();\n};\nvar trim = /*#__PURE__*/_curry1(_trim);\nexport default trim;","import {\n  contains,\n  filter,\n  forEachObjIndexed,\n  join,\n  map,\n  pipe,\n  toPairs,\n} from \"ramda\"\n\nexport const urlEncode = pipe(\n  filter(x => x !== undefined),\n  toPairs,\n  map(([k, v]) => `${k}=${encodeURIComponent(v)}`),\n  join(\"&\"),\n)\n\nexport const appendQueryParams = (queryParams, url) => {\n  const separator = contains(\"?\", url) ? \"&\" : \"?\"\n  return url + separator + urlEncode(queryParams)\n}\n\nexport const appendQueryParamsAsArray = (key, values, url) => {\n  const separator = contains(\"?\", url) ? \"\" : \"?\"\n  const encodedPairs = map(\n    v => `${encodeURIComponent(key)}=${encodeURIComponent(v)}`,\n    values,\n  )\n  return url + separator + join(\"&\", encodedPairs)\n}\n\nexport const typeCheck = (name, expectedType, value) => {\n  const type = typeof value\n  if (type !== expectedType) {\n    throw new TypeError(\n      `expected ${name} to be of type ${expectedType} but was of type ${type}`,\n    )\n  }\n}\n\n// checks that all of an arrays elements are of the given type\nexport const typeCheckArr = (name, expectedType, arr) => {\n  if (!Array.isArray(arr)) {\n    throw new TypeError(`expected ${name} to be an array`)\n  }\n  arr.forEach((value, i) => typeCheck(`${name}[${i}]`, expectedType, value))\n}\n\n// checks that all of an objects values are of the given type\nexport const typeCheckObj = (name, expectedType, obj) => {\n  typeCheck(name, \"object\", obj)\n  forEachObjIndexed(\n    (value, key) => typeCheck(`${name}.${key}`, expectedType, value),\n    obj,\n  )\n}\n\nexport const checkOneOf = (name, values, value) => {\n  if (!contains(value, values)) {\n    throw new TypeError(\n      `expected ${name} to be one of ${values} but was ${value}`,\n    )\n  }\n}\n\nexport const unixSeconds = () => Math.floor(Date.now() / 1000)\n","import { sendRawRequest } from \"@pusher/platform\"\n\nimport { appendQueryParams, typeCheck, unixSeconds, urlEncode } from \"./utils\"\n\nexport class TokenProvider {\n  constructor({ url, queryParams, headers } = {}) {\n    typeCheck(\"url\", \"string\", url)\n    queryParams && typeCheck(\"queryParams\", \"object\", queryParams)\n    headers && typeCheck(\"headers\", \"object\", headers)\n    this.url = url\n    this.queryParams = queryParams\n    this.headers = headers\n\n    this.fetchToken = this.fetchToken.bind(this)\n    this.fetchFreshToken = this.fetchFreshToken.bind(this)\n    this.cacheIsStale = this.cacheIsStale.bind(this)\n    this.cache = this.cache.bind(this)\n    this.clearCache = this.clearCache.bind(this)\n    this.setUserId = this.setUserId.bind(this)\n  }\n\n  fetchToken() {\n    return !this.cacheIsStale()\n      ? Promise.resolve(this.cachedToken)\n      : (this.req || this.fetchFreshToken()).then(({ token, expiresIn }) => {\n          this.cache(token, expiresIn)\n          return token\n        })\n  }\n\n  fetchFreshToken() {\n    this.req = sendRawRequest({\n      method: \"POST\",\n      url: appendQueryParams(\n        { user_id: this.userId, ...this.queryParams },\n        this.url,\n      ),\n      body: urlEncode({ grant_type: \"client_credentials\" }),\n      headers: {\n        \"content-type\": \"application/x-www-form-urlencoded\",\n        ...this.headers,\n      },\n    })\n      .then(res => {\n        const { access_token: token, expires_in: expiresIn } = JSON.parse(res)\n        delete this.req\n        return { token, expiresIn }\n      })\n      .catch(err => {\n        delete this.req\n        throw err\n      })\n    return this.req\n  }\n\n  cacheIsStale() {\n    return !this.cachedToken || unixSeconds() > this.cacheExpiresAt\n  }\n\n  cache(token, expiresIn) {\n    this.cachedToken = token\n    this.cacheExpiresAt = unixSeconds() + expiresIn\n  }\n\n  clearCache() {\n    this.cachedToken = undefined\n    this.cacheExpiresAt = undefined\n  }\n\n  // To allow ChatManager to feed the userId to the TokenProvider. Not set\n  // directly so as not to mess with a custom TokenProvider implementation.\n  setUserId(userId) {\n    this.clearCache()\n    this.userId = userId\n  }\n}\n","export const parseBasicRoom = data => ({\n  createdAt: data.created_at,\n  createdByUserId: data.created_by_id,\n  id: data.id,\n  isPrivate: data.private,\n  name: data.name,\n  updatedAt: data.updated_at,\n  customData: data.custom_data,\n  deletedAt: data.deleted_at,\n})\n\nexport const parseBasicUser = data => ({\n  avatarURL: data.avatar_url,\n  createdAt: data.created_at,\n  customData: data.custom_data,\n  id: data.id,\n  name: data.name,\n  updatedAt: data.updated_at,\n})\n\nexport const parsePresence = data => ({\n  state: [\"online\", \"offline\"].includes(data.state) ? data.state : \"unknown\",\n})\n\nexport const parseBasicMessage = data => {\n  const roomId = data.room_id\n\n  const basicMessage = {\n    roomId,\n    id: data.id,\n    senderId: data.user_id,\n    createdAt: data.created_at,\n    updatedAt: data.updated_at,\n  }\n\n  if (data.parts) {\n    // v3 message\n    basicMessage.parts = data.parts.map(p => parseMessagePart(p))\n  } else {\n    // v2 message\n    basicMessage.text = data.text\n    if (data.attachment) {\n      basicMessage.attachment = parseMessageAttachment(data.attachment)\n    }\n  }\n\n  return basicMessage\n}\n\nexport const parseBasicCursor = data => ({\n  position: data.position,\n  updatedAt: data.updated_at,\n  userId: data.user_id,\n  roomId: data.room_id,\n  type: data.cursor_type,\n})\n\nconst parseMessageAttachment = data => ({\n  link: data.resource_link,\n  type: data.type,\n  name: data.name,\n})\n\nconst parseMessagePart = data => {\n  if (data.content) {\n    return {\n      partType: \"inline\",\n      payload: {\n        type: data.type,\n        content: data.content,\n      },\n    }\n  } else if (data.url) {\n    return {\n      partType: \"url\",\n      payload: {\n        type: data.type,\n        url: data.url,\n      },\n    }\n  } else if (data.attachment) {\n    return {\n      partType: \"attachment\",\n      payload: {\n        type: data.type,\n        name: data.attachment.name,\n        size: data.attachment.size,\n        customData: data.attachment.custom_data,\n        _id: data.attachment.id,\n        _downloadURL: data.attachment.download_url,\n        _expiration: new Date(data.attachment.expiration),\n      },\n    }\n  } else {\n    throw new TypeError(\"failed to parse message part\")\n  }\n}\n","export class User {\n  constructor(basicUser, presenceStore) {\n    this.avatarURL = basicUser.avatarURL\n    this.createdAt = basicUser.createdAt\n    this.customData = basicUser.customData\n    this.id = basicUser.id\n    this.name = basicUser.name\n    this.updatedAt = basicUser.updatedAt\n    this.presenceStore = presenceStore\n  }\n\n  get presence() {\n    return {\n      state: this.presenceStore[this.id] || \"unknown\",\n    }\n  }\n}\n","import { difference } from \"ramda\"\n\nimport { appendQueryParamsAsArray } from \"./utils\"\nimport { parseBasicUser } from \"./parsers\"\nimport { User } from \"./user\"\n\nexport class UserStore {\n  constructor({ instance, presenceStore, logger }) {\n    this.instance = instance\n    this.presenceStore = presenceStore\n    this.logger = logger\n    this.reqs = {} // ongoing requests by userId\n    this.onSetHooks = [] // hooks called when a new user is added to the store\n    this.users = {}\n\n    this.set = this.set.bind(this)\n    this.get = this.get.bind(this)\n    this.fetchMissingUsers = this.fetchMissingUsers.bind(this)\n    this.fetchBasicUsers = this.fetchBasicUsers.bind(this)\n    this.snapshot = this.snapshot.bind(this)\n    this.getSync = this.getSync.bind(this)\n    this.decorate = this.decorate.bind(this)\n  }\n\n  set(basicUser) {\n    this.users[basicUser.id] = this.decorate(basicUser)\n    this.onSetHooks.forEach(hook => hook(basicUser.id))\n    return Promise.resolve(this.users[basicUser.id])\n  }\n\n  get(userId) {\n    return this.fetchMissingUsers([userId]).then(() => this.users[userId])\n  }\n\n  fetchMissingUsers(userIds) {\n    const missing = difference(\n      userIds,\n      Object.values(this.users).map(u => u.id),\n    )\n    const missingNotInProgress = difference(missing, Object.keys(this.reqs))\n    if (missingNotInProgress.length > 0) {\n      this.fetchBasicUsers(missingNotInProgress)\n    }\n    return Promise.all(userIds.map(userId => this.reqs[userId]))\n  }\n\n  fetchBasicUsers(userIds) {\n    const req = this.instance\n      .request({\n        method: \"GET\",\n        path: appendQueryParamsAsArray(\"id\", userIds, \"/users_by_ids\"),\n      })\n      .then(res => {\n        const basicUsers = JSON.parse(res).map(u => parseBasicUser(u))\n        basicUsers.forEach(user => this.set(user))\n        userIds.forEach(userId => {\n          delete this.reqs[userId]\n        })\n      })\n      .catch(err => {\n        this.logger.warn(\"error fetching missing users:\", err)\n        throw err\n      })\n    userIds.forEach(userId => {\n      this.reqs[userId] = req\n    })\n  }\n\n  snapshot() {\n    return this.users\n  }\n\n  getSync(userId) {\n    return this.users[userId]\n  }\n\n  decorate(basicUser) {\n    return basicUser ? new User(basicUser, this.presenceStore) : undefined\n  }\n}\n","import { contains, filter, values } from \"ramda\"\n\nexport class Room {\n  constructor({ basicRoom, userStore, isSubscribedTo, logger }) {\n    this.createdAt = basicRoom.createdAt\n    this.createdByUserId = basicRoom.createdByUserId\n    this.deletedAt = basicRoom.deletedAt\n    this.id = basicRoom.id\n    this.isPrivate = basicRoom.isPrivate\n    this.name = basicRoom.name\n    this.updatedAt = basicRoom.updatedAt\n    this.customData = basicRoom.customData\n    this.userIds = []\n    this.userStore = userStore\n    this.isSubscribedTo = isSubscribedTo\n    this.logger = logger\n\n    this.eq = this.eq.bind(this)\n  }\n\n  get users() {\n    if (!this.isSubscribedTo(this.id)) {\n      const err = new Error(\n        `Must be subscribed to room ${this.id} to access users property`,\n      )\n      this.logger.error(err)\n      throw err\n    }\n    return filter(\n      user => contains(user.id, this.userIds),\n      values(this.userStore.snapshot()),\n    )\n  }\n\n  eq(other) {\n    return (\n      this.createdAt === other.createdAt &&\n      this.createdByUserId === other.createdByUserId &&\n      this.deletedAt === other.deletedAt &&\n      this.id === other.id &&\n      this.isPrivate === other.isPrivate &&\n      this.name === other.name &&\n      this.updatedAt === other.updatedAt &&\n      JSON.stringify(this.customData) === JSON.stringify(other.customData)\n    )\n  }\n}\n","import { append, uniq, pipe } from \"ramda\"\n\nimport { parseBasicRoom } from \"./parsers\"\nimport { Room } from \"./room\"\n\nexport class RoomStore {\n  constructor(options) {\n    this.instance = options.instance\n    this.userStore = options.userStore\n    this.isSubscribedTo = options.isSubscribedTo\n    this.logger = options.logger\n    this.rooms = {}\n\n    this.setSync = this.setSync.bind(this)\n    this.set = this.set.bind(this)\n    this.get = this.get.bind(this)\n    this.popSync = this.popSync.bind(this)\n    this.pop = this.pop.bind(this)\n    this.addUserToRoom = this.addUserToRoom.bind(this)\n    this.removeUserFromRoom = this.removeUserFromRoom.bind(this)\n    this.updateSync = this.updateSync.bind(this)\n    this.update = this.update.bind(this)\n    this.fetchBasicRoom = this.fetchBasicRoom.bind(this)\n    this.snapshot = this.snapshot.bind(this)\n    this.getSync = this.getSync.bind(this)\n    this.decorate = this.decorate.bind(this)\n  }\n\n  setSync(basicRoom) {\n    if (!this.rooms[basicRoom.id]) {\n      this.rooms[basicRoom.id] = this.decorate(basicRoom)\n    }\n    return this.rooms[basicRoom.id]\n  }\n\n  set(basicRoom) {\n    return Promise.resolve(this.setSync(basicRoom))\n  }\n\n  get(roomId) {\n    return Promise.resolve(this.rooms[roomId]).then(\n      room =>\n        room ||\n        this.fetchBasicRoom(roomId).then(basicRoom =>\n          this.set(roomId, basicRoom),\n        ),\n    )\n  }\n\n  popSync(roomId) {\n    const room = this.rooms[roomId]\n    delete this.rooms[roomId]\n    return room\n  }\n\n  pop(roomId) {\n    return Promise.resolve(this.popSync(roomId))\n  }\n\n  addUserToRoom(roomId, userId) {\n    return Promise.all([\n      this.get(roomId).then(room => {\n        room.userIds = uniq(append(userId, room.userIds))\n        return room\n      }),\n      this.userStore.fetchMissingUsers([userId]),\n    ]).then(([room]) => room)\n  }\n\n  removeUserFromRoom(roomId, userId) {\n    return this.get(roomId).then(room => {\n      room.userIds = room.userIds.filter(id => id !== userId)\n      return room\n    })\n  }\n\n  updateSync(roomId, updates) {\n    const room = this.getSync(roomId)\n    for (const k in updates) {\n      room[k] = updates[k]\n    }\n    return room\n  }\n\n  update(roomId, updates) {\n    return Promise.all([\n      this.get(roomId).then(() => this.updateSync(roomId, updates)),\n      this.userStore.fetchMissingUsers(updates.userIds || []),\n    ]).then(([room]) => room)\n  }\n\n  fetchBasicRoom(roomId) {\n    return this.instance\n      .request({\n        method: \"GET\",\n        path: `/rooms/${encodeURIComponent(roomId)}`,\n      })\n      .then(\n        pipe(\n          JSON.parse,\n          parseBasicRoom,\n        ),\n      )\n      .catch(err => {\n        this.logger.warn(`error fetching details for room ${roomId}:`, err)\n      })\n  }\n\n  snapshot() {\n    return this.rooms\n  }\n\n  getSync(roomId) {\n    return this.rooms[roomId]\n  }\n\n  decorate(basicRoom) {\n    return basicRoom\n      ? new Room({\n          basicRoom,\n          userStore: this.userStore,\n          isSubscribedTo: this.isSubscribedTo,\n          logger: this.logger,\n        })\n      : undefined\n  }\n}\n","export class Cursor {\n  constructor(basicCursor, userStore, roomStore) {\n    this.position = basicCursor.position\n    this.updatedAt = basicCursor.updatedAt\n    this.userId = basicCursor.userId\n    this.roomId = basicCursor.roomId\n    this.type = basicCursor.type\n    this.userStore = userStore\n    this.roomStore = roomStore\n  }\n\n  get user() {\n    return this.userStore.getSync(this.userId)\n  }\n\n  get room() {\n    return this.roomStore.getSync(this.roomId)\n  }\n}\n","import { Cursor } from \"./cursor\"\nimport { parseBasicCursor } from \"./parsers\"\n\nexport class CursorStore {\n  constructor({ instance, userStore, roomStore, logger }) {\n    this.instance = instance\n    this.userStore = userStore\n    this.roomStore = roomStore\n    this.logger = logger\n    this.cursors = {}\n\n    this.set = this.set.bind(this)\n    this.get = this.get.bind(this)\n    this.getSync = this.getSync.bind(this)\n    this.fetchBasicCursor = this.fetchBasicCursor.bind(this)\n    this.decorate = this.decorate.bind(this)\n  }\n\n  set(basicCursor) {\n    const k = key(basicCursor.userId, basicCursor.roomId)\n    this.cursors[k] = this.decorate(basicCursor)\n    return this.userStore\n      .fetchMissingUsers([basicCursor.userId])\n      .then(() => this.cursors[k])\n  }\n\n  get(userId, roomId) {\n    const k = key(userId, roomId)\n    if (this.cursors[k]) {\n      return Promise.resolve(this.cursors[k])\n    }\n    return this.fetchBasicCursor(userId, roomId).then(basicCursor =>\n      this.set(basicCursor),\n    )\n  }\n\n  getSync(userId, roomId) {\n    return this.cursors[key(userId, roomId)]\n  }\n\n  fetchBasicCursor(userId, roomId) {\n    return this.instance\n      .request({\n        method: \"GET\",\n        path: `/cursors/0/rooms/${encodeURIComponent(\n          roomId,\n        )}/users/${encodeURIComponent(userId)}`,\n      })\n      .then(res => {\n        const data = JSON.parse(res)\n        if (data) {\n          return parseBasicCursor(data)\n        }\n        return undefined\n      })\n      .catch(err => {\n        this.logger.warn(\"error fetching cursor:\", err)\n        throw err\n      })\n  }\n\n  decorate(basicCursor) {\n    return basicCursor\n      ? new Cursor(basicCursor, this.userStore, this.roomStore)\n      : undefined\n  }\n}\n\nconst key = (userId, roomId) =>\n  `${encodeURIComponent(userId)}/${encodeURIComponent(roomId)}`\n","export const TYPING_INDICATOR_TTL = 1500\nexport const TYPING_INDICATOR_LEEWAY = 500\nexport const SET_CURSOR_WAIT = 500\nexport const DEFAULT_CONNECTION_TIMEOUT = 20 * 1000\n","import { TYPING_INDICATOR_TTL, TYPING_INDICATOR_LEEWAY } from \"./constants\"\n\nexport class TypingIndicators {\n  constructor({ hooks, instance, logger }) {\n    this.hooks = hooks\n    this.instance = instance\n    this.logger = logger\n    this.lastSentRequests = {}\n    this.timers = {}\n\n    this.sendThrottledRequest = this.sendThrottledRequest.bind(this)\n    this.onIsTyping = this.onIsTyping.bind(this)\n    this.onStarted = this.onStarted.bind(this)\n    this.onStopped = this.onStopped.bind(this)\n  }\n\n  sendThrottledRequest(roomId) {\n    const now = Date.now()\n    const sent = this.lastSentRequests[roomId]\n    if (sent && now - sent < TYPING_INDICATOR_TTL - TYPING_INDICATOR_LEEWAY) {\n      return Promise.resolve()\n    }\n    this.lastSentRequests[roomId] = now\n    return this.instance\n      .request({\n        method: \"POST\",\n        path: `/rooms/${encodeURIComponent(roomId)}/typing_indicators`,\n      })\n      .catch(err => {\n        delete this.typingRequestSent[roomId]\n        this.logger.warn(\n          `Error sending typing indicator in room ${roomId}`,\n          err,\n        )\n        throw err\n      })\n  }\n\n  onIsTyping(room, user) {\n    if (!this.timers[room.id]) {\n      this.timers[room.id] = {}\n    }\n    if (this.timers[room.id][user.id]) {\n      clearTimeout(this.timers[room.id][user.id])\n    } else {\n      this.onStarted(room, user)\n    }\n    this.timers[room.id][user.id] = setTimeout(() => {\n      this.onStopped(room, user)\n      delete this.timers[room.id][user.id]\n    }, TYPING_INDICATOR_TTL)\n  }\n\n  onStarted(room, user) {\n    if (this.hooks.global.onUserStartedTyping) {\n      this.hooks.global.onUserStartedTyping(room, user)\n    }\n    if (\n      this.hooks.rooms[room.id] &&\n      this.hooks.rooms[room.id].onUserStartedTyping\n    ) {\n      this.hooks.rooms[room.id].onUserStartedTyping(user)\n    }\n  }\n\n  onStopped(room, user) {\n    if (this.hooks.global.onUserStoppedTyping) {\n      this.hooks.global.onUserStoppedTyping(room, user)\n    }\n    if (\n      this.hooks.rooms[room.id] &&\n      this.hooks.rooms[room.id].onUserStoppedTyping\n    ) {\n      this.hooks.rooms[room.id].onUserStoppedTyping(user)\n    }\n  }\n}\n","import { parseBasicRoom, parseBasicUser } from \"./parsers\"\nimport { handleUserSubReconnection } from \"./reconnection-handlers\"\n\nexport class UserSubscription {\n  constructor(options) {\n    this.userId = options.userId\n    this.hooks = options.hooks\n    this.instance = options.instance\n    this.roomStore = options.roomStore\n    this.roomSubscriptions = options.roomSubscriptions\n    this.logger = options.logger\n    this.connectionTimeout = options.connectionTimeout\n    this.currentUser = options.currentUser\n\n    this.connect = this.connect.bind(this)\n    this.cancel = this.cancel.bind(this)\n    this.onEvent = this.onEvent.bind(this)\n    this.onInitialState = this.onInitialState.bind(this)\n    this.onAddedToRoom = this.onAddedToRoom.bind(this)\n    this.onRemovedFromRoom = this.onRemovedFromRoom.bind(this)\n    this.onRoomUpdated = this.onRoomUpdated.bind(this)\n    this.onRoomDeleted = this.onRoomDeleted.bind(this)\n  }\n\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.timeout = setTimeout(() => {\n        reject(new Error(\"user subscription timed out\"))\n      }, this.connectionTimeout)\n      this.onSubscriptionEstablished = initialState => {\n        clearTimeout(this.timeout)\n        resolve(initialState)\n      }\n      this.sub = this.instance.subscribeNonResuming({\n        path: \"/users\",\n        listeners: {\n          onError: err => {\n            clearTimeout(this.timeout)\n            reject(err)\n          },\n          onEvent: this.onEvent,\n        },\n      })\n    })\n  }\n\n  cancel() {\n    clearTimeout(this.timeout)\n    try {\n      this.sub && this.sub.unsubscribe()\n    } catch (err) {\n      this.logger.debug(\"error when cancelling user subscription\", err)\n    }\n  }\n\n  onEvent({ body }) {\n    switch (body.event_name) {\n      case \"initial_state\":\n        this.onInitialState(body.data)\n        break\n      case \"added_to_room\":\n        this.onAddedToRoom(body.data)\n        break\n      case \"removed_from_room\":\n        this.onRemovedFromRoom(body.data)\n        break\n      case \"room_updated\":\n        this.onRoomUpdated(body.data)\n        break\n      case \"room_deleted\":\n        this.onRoomDeleted(body.data)\n        break\n    }\n  }\n\n  onInitialState({ current_user: userData, rooms: roomsData }) {\n    const basicUser = parseBasicUser(userData)\n    const basicRooms = roomsData.map(d => parseBasicRoom(d))\n    if (!this.established) {\n      this.established = true\n      this.onSubscriptionEstablished({ basicUser, basicRooms })\n    } else {\n      handleUserSubReconnection({\n        basicUser,\n        basicRooms,\n        currentUser: this.currentUser,\n        roomStore: this.roomStore,\n        hooks: this.hooks,\n      })\n    }\n  }\n\n  onAddedToRoom({ room: roomData }) {\n    this.roomStore.set(parseBasicRoom(roomData)).then(room => {\n      if (this.hooks.global.onAddedToRoom) {\n        this.hooks.global.onAddedToRoom(room)\n      }\n    })\n  }\n\n  onRemovedFromRoom({ room_id: roomId }) {\n    this.roomStore.pop(roomId).then(room => {\n      if (room && this.hooks.global.onRemovedFromRoom) {\n        this.hooks.global.onRemovedFromRoom(room)\n      }\n    })\n  }\n\n  onRoomUpdated({ room: roomData }) {\n    const updates = parseBasicRoom(roomData)\n    this.roomStore.update(updates.id, updates).then(room => {\n      if (this.hooks.global.onRoomUpdated) {\n        this.hooks.global.onRoomUpdated(room)\n      }\n    })\n  }\n\n  onRoomDeleted({ room_id: roomId }) {\n    this.roomStore.pop(roomId).then(room => {\n      if (room && this.hooks.global.onRoomDeleted) {\n        this.hooks.global.onRoomDeleted(room)\n      }\n    })\n  }\n}\n","export function handleUserSubReconnection({\n  basicUser,\n  basicRooms,\n  currentUser,\n  roomStore,\n  hooks,\n}) {\n  currentUser.setPropertiesFromBasicUser(basicUser)\n\n  for (const basicRoom of basicRooms) {\n    const existingRoom = roomStore.getSync(basicRoom.id)\n\n    if (!existingRoom) {\n      const room = roomStore.setSync(basicRoom)\n      if (hooks.global.onAddedToRoom) {\n        hooks.global.onAddedToRoom(room)\n      }\n    }\n\n    if (existingRoom && !existingRoom.eq(basicRoom)) {\n      roomStore.updateSync(basicRoom.id, basicRoom)\n      if (hooks.global.onRoomUpdated) {\n        hooks.global.onRoomUpdated(existingRoom)\n      }\n    }\n  }\n\n  for (const roomId in roomStore.snapshot()) {\n    if (!basicRooms.some(r => r.id === roomId)) {\n      const room = roomStore.popSync(roomId)\n      if (hooks.global.onRemovedFromRoom) {\n        hooks.global.onRemovedFromRoom(room)\n      }\n    }\n  }\n}\n\nexport function handleMembershipSubReconnection({\n  userIds,\n  roomId,\n  roomStore,\n  userStore,\n  onUserJoinedRoomHook,\n  onUserLeftRoomHook,\n}) {\n  return userStore.fetchMissingUsers(userIds).then(() => {\n    const room = roomStore.getSync(roomId)\n\n    userIds\n      .filter(userId => !room.userIds.includes(userId))\n      .forEach(userId =>\n        userStore.get(userId).then(user => onUserJoinedRoomHook(room, user)),\n      )\n\n    room.userIds\n      .filter(userId => !userIds.includes(userId))\n      .forEach(userId =>\n        userStore.get(userId).then(user => onUserLeftRoomHook(room, user)),\n      )\n\n    return roomStore.update(roomId, { userIds })\n  })\n}\n\nexport function handleCursorSubReconnection({\n  basicCursors,\n  cursorStore,\n  onNewCursorHook,\n}) {\n  return Promise.all(\n    basicCursors.map(basicCursor => {\n      const existingCursor = cursorStore.getSync(\n        basicCursor.userId,\n        basicCursor.roomId,\n      )\n\n      if (!existingCursor || existingCursor.position !== basicCursor.position) {\n        return cursorStore\n          .set(basicCursor)\n          .then(cursor => onNewCursorHook(cursor))\n      }\n    }),\n  )\n}\n","export class PresenceSubscription {\n  constructor(options) {\n    this.userId = options.userId\n    this.instance = options.instance\n    this.logger = options.logger\n    this.connectionTimeout = options.connectionTimeout\n  }\n\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.timeout = setTimeout(() => {\n        reject(new Error(\"presence subscription timed out\"))\n      }, this.connectionTimeout)\n      this.sub = this.instance.subscribeNonResuming({\n        path: `/users/${encodeURIComponent(this.userId)}/register`,\n        listeners: {\n          onOpen: () => {\n            clearTimeout(this.timeout)\n            resolve()\n          },\n          onError: err => {\n            clearTimeout(this.timeout)\n            reject(err)\n          },\n        },\n      })\n    })\n  }\n\n  cancel() {\n    clearTimeout(this.timeout)\n    try {\n      this.sub && this.sub.unsubscribe()\n    } catch (err) {\n      this.logger.debug(\"error when cancelling presence subscription\", err)\n    }\n  }\n}\n","import { contains, compose, forEach, filter, toPairs } from \"ramda\"\n\nimport { parsePresence } from \"./parsers\"\n\nexport class UserPresenceSubscription {\n  constructor(options) {\n    this.userId = options.userId\n    this.hooks = options.hooks\n    this.instance = options.instance\n    this.userStore = options.userStore\n    this.roomStore = options.roomStore\n    this.presenceStore = options.presenceStore\n    this.logger = options.logger\n    this.connectionTimeout = options.connectionTimeout\n\n    this.connect = this.connect.bind(this)\n    this.cancel = this.cancel.bind(this)\n    this.onEvent = this.onEvent.bind(this)\n    this.onPresenceState = this.onPresenceState.bind(this)\n  }\n\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.timeout = setTimeout(() => {\n        reject(new Error(\"user presence subscription timed out\"))\n      }, this.connectionTimeout)\n      this.onSubscriptionEstablished = () => {\n        clearTimeout(this.timeout)\n        resolve()\n      }\n      this.sub = this.instance.subscribeNonResuming({\n        path: `/users/${encodeURIComponent(this.userId)}`,\n        listeners: {\n          onError: err => {\n            clearTimeout(this.timeout)\n            reject(err)\n          },\n          onEvent: this.onEvent,\n        },\n      })\n    })\n  }\n\n  cancel() {\n    clearTimeout(this.timeout)\n    try {\n      this.sub && this.sub.unsubscribe()\n    } catch (err) {\n      this.logger.debug(\"error when cancelling user presence subscription\", err)\n    }\n  }\n\n  onEvent({ body }) {\n    switch (body.event_name) {\n      case \"presence_state\":\n        this.onPresenceState(body.data)\n        break\n    }\n  }\n\n  onPresenceState(data) {\n    this.onSubscriptionEstablished()\n    const previous = this.presenceStore[this.userId] || \"unknown\"\n    const current = parsePresence(data).state\n    if (current === previous) {\n      return\n    }\n    this.presenceStore[this.userId] = current\n    this.userStore.get(this.userId).then(user => {\n      if (this.hooks.global.onPresenceChanged) {\n        this.hooks.global.onPresenceChanged({ current, previous }, user)\n      }\n      compose(\n        forEach(([roomId, hooks]) =>\n          this.roomStore.get(roomId).then(room => {\n            if (contains(user.id, room.userIds)) {\n              hooks.onPresenceChanged({ current, previous }, user)\n            }\n          }),\n        ),\n        filter(pair => pair[1].onPresenceChanged !== undefined),\n        toPairs,\n      )(this.hooks.rooms)\n    })\n  }\n}\n","import { parseBasicCursor } from \"./parsers\"\nimport { handleCursorSubReconnection } from \"./reconnection-handlers\"\n\nexport class CursorSubscription {\n  constructor(options) {\n    this.onNewCursorHook = options.onNewCursorHook\n    this.path = options.path\n    this.cursorStore = options.cursorStore\n    this.instance = options.instance\n    this.logger = options.logger\n    this.connectionTimeout = options.connectionTimeout\n\n    this.connect = this.connect.bind(this)\n    this.cancel = this.cancel.bind(this)\n    this.onEvent = this.onEvent.bind(this)\n    this.onInitialState = this.onInitialState.bind(this)\n    this.onNewCursor = this.onNewCursor.bind(this)\n  }\n\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.timeout = setTimeout(() => {\n        reject(new Error(\"cursor subscription timed out\"))\n      }, this.connectionTimeout)\n      this.onSubscriptionEstablished = initialState => {\n        clearTimeout(this.timeout)\n        resolve(initialState)\n      }\n      this.sub = this.instance.subscribeNonResuming({\n        path: this.path,\n        listeners: {\n          onError: err => {\n            clearTimeout(this.timeout)\n            reject(err)\n          },\n          onEvent: this.onEvent,\n        },\n      })\n    })\n  }\n\n  cancel() {\n    clearTimeout(this.timeout)\n    try {\n      this.sub && this.sub.unsubscribe()\n    } catch (err) {\n      this.logger.debug(\"error when cancelling cursor subscription\", err)\n    }\n  }\n\n  onEvent({ body }) {\n    switch (body.event_name) {\n      case \"initial_state\":\n        this.onInitialState(body.data)\n        break\n      case \"new_cursor\":\n        this.onNewCursor(body.data)\n        break\n    }\n  }\n\n  onInitialState({ cursors }) {\n    const basicCursors = cursors.map(c => parseBasicCursor(c))\n\n    if (!this.established) {\n      this.established = true\n      Promise.all(basicCursors.map(c => this.cursorStore.set(c))).then(\n        this.onSubscriptionEstablished,\n      )\n    } else {\n      handleCursorSubReconnection({\n        basicCursors,\n        cursorStore: this.cursorStore,\n        onNewCursorHook: this.onNewCursorHook,\n      })\n    }\n  }\n\n  onNewCursor(data) {\n    return this.cursorStore\n      .set(parseBasicCursor(data))\n      .then(cursor => this.onNewCursorHook(cursor))\n  }\n}\n","export class Attachment {\n  constructor(basicAttachment, roomId, instance) {\n    this.type = basicAttachment.type\n    this.name = basicAttachment.name\n    this.size = basicAttachment.size\n\n    if (basicAttachment.customData) {\n      this.customData = basicAttachment.customData\n    }\n\n    this._id = basicAttachment.id\n    this._downloadURL = basicAttachment.downloadURL\n    this._expiration = basicAttachment.expiration\n\n    this._roomId = roomId\n    this._instance = instance\n\n    this.url = this.url.bind(this)\n    this.urlExpiry = this.urlExpiry.bind(this)\n    this._fetchNewDownloadURL = this._fetchNewDownloadURL.bind(this)\n  }\n\n  url() {\n    return this.urlExpiry().getTime() - Date.now() < 1000 * 60 * 30\n      ? this._fetchNewDownloadURL()\n      : Promise.resolve(this._downloadURL)\n  }\n\n  urlExpiry() {\n    return this._expiration\n  }\n\n  _fetchNewDownloadURL() {\n    this._instance\n      .request({\n        method: \"GET\",\n        path: `rooms/${encodeURIComponent(this._roomId)}/attachments/${\n          this._id\n        }`,\n      })\n      .then(res => {\n        this._downloadURL = res.download_url\n        this._expiration = new Date(res.expiration)\n        return this._downloadURL\n      })\n  }\n}\n","import { Attachment } from \"./attachment\"\n\nexport class Message {\n  constructor(basicMessage, userStore, roomStore, instance) {\n    this.id = basicMessage.id\n    this.senderId = basicMessage.senderId\n    this.roomId = basicMessage.roomId\n    this.createdAt = basicMessage.createdAt\n    this.updatedAt = basicMessage.updatedAt\n\n    if (basicMessage.parts) {\n      // v3 message\n      this.parts = basicMessage.parts.map(\n        ({ partType, payload }) =>\n          partType === \"attachment\"\n            ? {\n                partType,\n                payload: new Attachment(payload, this.roomId, instance),\n              }\n            : { partType, payload },\n      )\n    } else {\n      // v2 message\n      this.text = basicMessage.text\n      if (basicMessage.attachment) {\n        this.attachment = basicMessage.attachment\n      }\n    }\n\n    this.userStore = userStore\n    this.roomStore = roomStore\n  }\n\n  get sender() {\n    return this.userStore.getSync(this.senderId)\n  }\n\n  get room() {\n    return this.roomStore.getSync(this.roomId)\n  }\n}\n","import { parseBasicMessage } from \"./parsers\"\nimport { urlEncode } from \"./utils\"\nimport { Message } from \"./message\"\n\nexport class MessageSubscription {\n  constructor(options) {\n    this.roomId = options.roomId\n    this.messageLimit = options.messageLimit\n    this.userId = options.userId\n    this.instance = options.instance\n    this.userStore = options.userStore\n    this.roomStore = options.roomStore\n    this.typingIndicators = options.typingIndicators\n    this.messageBuffer = [] // { message, ready }\n    this.logger = options.logger\n    this.connectionTimeout = options.connectionTimeout\n    this.onMessageHook = options.onMessageHook\n\n    this.connect = this.connect.bind(this)\n    this.cancel = this.cancel.bind(this)\n    this.onEvent = this.onEvent.bind(this)\n    this.onMessage = this.onMessage.bind(this)\n    this.flushBuffer = this.flushBuffer.bind(this)\n    this.onIsTyping = this.onIsTyping.bind(this)\n  }\n\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.timeout = setTimeout(() => {\n        reject(new Error(\"message subscription timed out\"))\n      }, this.connectionTimeout)\n      this.sub = this.instance.subscribeResuming({\n        path: `/rooms/${encodeURIComponent(this.roomId)}?${urlEncode({\n          message_limit: this.messageLimit,\n        })}`,\n        listeners: {\n          onOpen: () => {\n            clearTimeout(this.timeout)\n            resolve()\n          },\n          onError: err => {\n            clearTimeout(this.timeout)\n            reject(err)\n          },\n          onEvent: this.onEvent,\n        },\n      })\n    })\n  }\n\n  cancel() {\n    clearTimeout(this.timeout)\n    try {\n      this.sub && this.sub.unsubscribe()\n    } catch (err) {\n      this.logger.debug(\"error when cancelling message subscription\", err)\n    }\n  }\n\n  onEvent({ body }) {\n    switch (body.event_name) {\n      case \"new_message\":\n        this.onMessage(body.data)\n        break\n      case \"is_typing\":\n        this.onIsTyping(body.data)\n        break\n    }\n  }\n\n  onMessage(data) {\n    const pending = {\n      message: new Message(\n        parseBasicMessage(data),\n        this.userStore,\n        this.roomStore,\n        this.instance,\n      ),\n      ready: false,\n    }\n    this.messageBuffer.push(pending)\n    this.userStore\n      .fetchMissingUsers([pending.message.senderId])\n      .catch(err => {\n        this.logger.error(\"error fetching missing user information:\", err)\n      })\n      .then(() => {\n        pending.ready = true\n        this.flushBuffer()\n      })\n  }\n\n  flushBuffer() {\n    while (this.messageBuffer.length > 0 && this.messageBuffer[0].ready) {\n      this.onMessageHook(this.messageBuffer.shift().message)\n    }\n  }\n\n  onIsTyping({ user_id: userId }) {\n    if (userId !== this.userId) {\n      Promise.all([\n        this.roomStore.get(this.roomId),\n        this.userStore.get(userId),\n      ]).then(([room, user]) => this.typingIndicators.onIsTyping(room, user))\n    }\n  }\n}\n","import { handleMembershipSubReconnection } from \"./reconnection-handlers\"\n\nexport class MembershipSubscription {\n  constructor(options) {\n    this.roomId = options.roomId\n    this.instance = options.instance\n    this.userStore = options.userStore\n    this.roomStore = options.roomStore\n    this.logger = options.logger\n    this.connectionTimeout = options.connectionTimeout\n    this.onUserJoinedRoomHook = options.onUserJoinedRoomHook\n    this.onUserLeftRoomHook = options.onUserLeftRoomHook\n\n    this.connect = this.connect.bind(this)\n    this.cancel = this.cancel.bind(this)\n    this.onEvent = this.onEvent.bind(this)\n    this.onInitialState = this.onInitialState.bind(this)\n    this.onUserJoined = this.onUserJoined.bind(this)\n    this.onUserLeft = this.onUserLeft.bind(this)\n  }\n\n  connect() {\n    return new Promise((resolve, reject) => {\n      this.timeout = setTimeout(() => {\n        reject(new Error(\"membership subscription timed out\"))\n      }, this.connectionTimeout)\n      this.onSubscriptionEstablished = initialState => {\n        clearTimeout(this.timeout)\n        resolve(initialState)\n      }\n      this.sub = this.instance.subscribeNonResuming({\n        path: `/rooms/${encodeURIComponent(this.roomId)}/memberships`,\n        listeners: {\n          onError: err => {\n            clearTimeout(this.timeout)\n            reject(err)\n          },\n          onEvent: this.onEvent,\n        },\n      })\n    })\n  }\n\n  cancel() {\n    clearTimeout(this.timeout)\n    try {\n      this.sub && this.sub.unsubscribe()\n    } catch (err) {\n      this.logger.debug(\"error when cancelling membership subscription\", err)\n    }\n  }\n\n  onEvent({ body }) {\n    switch (body.event_name) {\n      case \"initial_state\":\n        this.onInitialState(body.data)\n        break\n      case \"user_joined\":\n        this.onUserJoined(body.data)\n        break\n      case \"user_left\":\n        this.onUserLeft(body.data)\n        break\n    }\n  }\n\n  onInitialState({ user_ids: userIds }) {\n    if (!this.established) {\n      this.established = true\n      this.roomStore.update(this.roomId, { userIds }).then(() => {\n        this.onSubscriptionEstablished()\n      })\n    } else {\n      handleMembershipSubReconnection({\n        userIds,\n        roomId: this.roomId,\n        roomStore: this.roomStore,\n        userStore: this.userStore,\n        onUserJoinedRoomHook: this.onUserJoinedRoomHook,\n        onUserLeftRoomHook: this.onUserLeftRoomHook,\n      })\n    }\n  }\n\n  onUserJoined({ user_id: userId }) {\n    this.roomStore\n      .addUserToRoom(this.roomId, userId)\n      .then(room =>\n        this.userStore\n          .get(userId)\n          .then(user => this.onUserJoinedRoomHook(room, user)),\n      )\n  }\n\n  onUserLeft({ user_id: userId }) {\n    this.roomStore\n      .removeUserFromRoom(this.roomId, userId)\n      .then(room =>\n        this.userStore\n          .get(userId)\n          .then(user => this.onUserLeftRoomHook(room, user)),\n      )\n  }\n}\n","import { CursorSubscription } from \"./cursor-subscription\"\nimport { MessageSubscription } from \"./message-subscription\"\nimport { MembershipSubscription } from \"./membership-subscription\"\n\nexport class RoomSubscription {\n  constructor(options) {\n    this.buffer = []\n\n    this.messageSub = new MessageSubscription({\n      roomId: options.roomId,\n      messageLimit: options.messageLimit,\n      userId: options.userId,\n      instance: options.serverInstance,\n      userStore: options.userStore,\n      roomStore: options.roomStore,\n      typingIndicators: options.typingIndicators,\n      logger: options.logger,\n      connectionTimeout: options.connectionTimeout,\n      onMessageHook: this.bufferWhileConnecting(message => {\n        if (\n          options.hooks.rooms[options.roomId] &&\n          options.hooks.rooms[options.roomId].onMessage\n        ) {\n          options.hooks.rooms[options.roomId].onMessage(message)\n        }\n      }),\n    })\n\n    this.cursorSub = new CursorSubscription({\n      path: `/cursors/0/rooms/${encodeURIComponent(options.roomId)}`,\n      cursorStore: options.cursorStore,\n      instance: options.cursorsInstance,\n      logger: options.logger,\n      connectionTimeout: options.connectionTimeout,\n      onNewCursorHook: this.bufferWhileConnecting(cursor => {\n        if (\n          options.hooks.rooms[options.roomId] &&\n          options.hooks.rooms[options.roomId].onNewReadCursor &&\n          cursor.type === 0 &&\n          cursor.userId !== options.userId\n        ) {\n          options.hooks.rooms[options.roomId].onNewReadCursor(cursor)\n        }\n      }),\n    })\n\n    this.membershipSub = new MembershipSubscription({\n      roomId: options.roomId,\n      instance: options.serverInstance,\n      userStore: options.userStore,\n      roomStore: options.roomStore,\n      logger: options.logger,\n      connectionTimeout: options.connectionTimeout,\n      onUserJoinedRoomHook: this.bufferWhileConnecting((room, user) => {\n        if (options.hooks.global.onUserJoinedRoom) {\n          options.hooks.global.onUserJoinedRoom(room, user)\n        }\n        if (\n          options.hooks.rooms[room.id] &&\n          options.hooks.rooms[room.id].onUserJoined\n        ) {\n          options.hooks.rooms[room.id].onUserJoined(user)\n        }\n      }),\n      onUserLeftRoomHook: this.bufferWhileConnecting((room, user) => {\n        if (options.hooks.global.onUserLeftRoom) {\n          options.hooks.global.onUserLeftRoom(room, user)\n        }\n        if (\n          options.hooks.rooms[room.id] &&\n          options.hooks.rooms[room.id].onUserLeft\n        ) {\n          options.hooks.rooms[room.id].onUserLeft(user)\n        }\n      }),\n    })\n  }\n\n  connect() {\n    if (this.cancelled) {\n      return Promise.reject(\n        new Error(\"attempt to connect a cancelled room subscription\"),\n      )\n    }\n    return Promise.all([\n      this.messageSub.connect(),\n      this.cursorSub.connect(),\n      this.membershipSub.connect(),\n    ]).then(() => this.flushBuffer())\n  }\n\n  cancel() {\n    this.cancelled = true\n    this.messageSub.cancel()\n    this.cursorSub.cancel()\n    this.membershipSub.cancel()\n  }\n\n  bufferWhileConnecting(f) {\n    return (...args) => {\n      if (this.connected) {\n        f(...args)\n      } else {\n        this.buffer.push(f.bind(this, ...args))\n      }\n    }\n  }\n\n  flushBuffer() {\n    this.connected = true\n    this.buffer.forEach(f => f())\n    delete this.buffer\n  }\n}\n","import {\n  contains,\n  has,\n  map,\n  forEachObjIndexed,\n  max,\n  pipe,\n  prop,\n  sort,\n  uniq,\n  values,\n} from \"ramda\"\n\nimport {\n  checkOneOf,\n  typeCheck,\n  typeCheckArr,\n  typeCheckObj,\n  urlEncode,\n} from \"./utils\"\nimport { parseBasicMessage, parseBasicRoom } from \"./parsers\"\nimport { UserStore } from \"./user-store\"\nimport { RoomStore } from \"./room-store\"\nimport { CursorStore } from \"./cursor-store\"\nimport { TypingIndicators } from \"./typing-indicators\"\nimport { UserSubscription } from \"./user-subscription\"\nimport { PresenceSubscription } from \"./presence-subscription\"\nimport { UserPresenceSubscription } from \"./user-presence-subscription\"\nimport { CursorSubscription } from \"./cursor-subscription\"\nimport { RoomSubscription } from \"./room-subscription\"\nimport { Message } from \"./message\"\nimport { SET_CURSOR_WAIT } from \"./constants\"\n\nexport class CurrentUser {\n  constructor({\n    serverInstanceV2,\n    serverInstanceV3,\n    connectionTimeout,\n    cursorsInstance,\n    filesInstance,\n    hooks,\n    id,\n    presenceInstance,\n  }) {\n    this.hooks = {\n      global: hooks,\n      rooms: {},\n    }\n    this.id = id\n    this.encodedId = encodeURIComponent(this.id)\n    this.serverInstanceV2 = serverInstanceV2\n    this.serverInstanceV3 = serverInstanceV3\n    this.filesInstance = filesInstance\n    this.cursorsInstance = cursorsInstance\n    this.connectionTimeout = connectionTimeout\n    this.presenceInstance = presenceInstance\n    this.logger = serverInstanceV3.logger\n    this.presenceStore = {}\n    this.userStore = new UserStore({\n      instance: this.serverInstanceV3,\n      presenceStore: this.presenceStore,\n      logger: this.logger,\n    })\n    this.roomStore = new RoomStore({\n      instance: this.serverInstanceV3,\n      userStore: this.userStore,\n      isSubscribedTo: userId => this.isSubscribedTo(userId),\n      logger: this.logger,\n    })\n    this.cursorStore = new CursorStore({\n      instance: this.cursorsInstance,\n      userStore: this.userStore,\n      roomStore: this.roomStore,\n      logger: this.logger,\n    })\n    this.typingIndicators = new TypingIndicators({\n      hooks: this.hooks,\n      instance: this.serverInstanceV3,\n      logger: this.logger,\n    })\n    this.userStore.onSetHooks.push(userId =>\n      this.subscribeToUserPresence(userId),\n    )\n    this.roomSubscriptions = {}\n    this.readCursorBuffer = {} // roomId -> { position, [{ resolve, reject }] }\n    this.userPresenceSubscriptions = {}\n\n    this.setReadCursor = this.setReadCursor.bind(this)\n    this.readCursor = this.readCursor.bind(this)\n    this.isTypingIn = this.isTypingIn.bind(this)\n    this.createRoom = this.createRoom.bind(this)\n    this.getJoinableRooms = this.getJoinableRooms.bind(this)\n    this.joinRoom = this.joinRoom.bind(this)\n    this.leaveRoom = this.leaveRoom.bind(this)\n    this.addUserToRoom = this.addUserToRoom.bind(this)\n    this.removeUserFromRoom = this.removeUserFromRoom.bind(this)\n    this.sendMessage = this.sendMessage.bind(this)\n    this.sendSimpleMessage = this.sendSimpleMessage.bind(this)\n    this.sendMultipartMessage = this.sendMultipartMessage.bind(this)\n    this.fetchMessages = this.fetchMessages.bind(this)\n    this.subscribeToRoom = this.subscribeToRoom.bind(this)\n    this.subscribeToRoomMultipart = this.subscribeToRoomMultipart.bind(this)\n    this.updateRoom = this.updateRoom.bind(this)\n    this.deleteRoom = this.deleteRoom.bind(this)\n    this.setReadCursorRequest = this.setReadCursorRequest.bind(this)\n    this.uploadDataAttachment = this.uploadDataAttachment.bind(this)\n    this.isMemberOf = this.isMemberOf.bind(this)\n    this.isSubscribedTo = this.isSubscribedTo.bind(this)\n    this.decorateMessage = this.decorateMessage.bind(this)\n    this.setPropertiesFromBasicUser = this.setPropertiesFromBasicUser.bind(this)\n    this.establishUserSubscription = this.establishUserSubscription.bind(this)\n    this.establishCursorSubscription = this.establishCursorSubscription.bind(\n      this,\n    )\n    this.establishPresenceSubscription = this.establishPresenceSubscription.bind(\n      this,\n    )\n    this.subscribeToUserPresence = this.subscribeToUserPresence.bind(this)\n    this.disconnect = this.disconnect.bind(this)\n  }\n\n  /* public */\n\n  get rooms() {\n    return values(this.roomStore.snapshot())\n  }\n\n  get users() {\n    return values(this.userStore.snapshot())\n  }\n\n  setReadCursor({ roomId, position } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    typeCheck(\"position\", \"number\", position)\n    return new Promise((resolve, reject) => {\n      if (this.readCursorBuffer[roomId] !== undefined) {\n        this.readCursorBuffer[roomId].position = max(\n          this.readCursorBuffer[roomId].position,\n          position,\n        )\n        this.readCursorBuffer[roomId].callbacks.push({ resolve, reject })\n      } else {\n        this.readCursorBuffer[roomId] = {\n          position,\n          callbacks: [{ resolve, reject }],\n        }\n        setTimeout(() => {\n          this.setReadCursorRequest({\n            roomId,\n            ...this.readCursorBuffer[roomId],\n          })\n          delete this.readCursorBuffer[roomId]\n        }, SET_CURSOR_WAIT)\n      }\n    })\n  }\n\n  readCursor({ roomId, userId = this.id } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    typeCheck(\"userId\", \"string\", userId)\n    if (userId !== this.id && !this.isSubscribedTo(roomId)) {\n      const err = new Error(\n        `Must be subscribed to room ${roomId} to access member's read cursors`,\n      )\n      this.logger.error(err)\n      throw err\n    }\n    return this.cursorStore.getSync(userId, roomId)\n  }\n\n  isTypingIn({ roomId } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    return this.typingIndicators.sendThrottledRequest(roomId)\n  }\n\n  createRoom({ name, addUserIds, customData, ...rest } = {}) {\n    name && typeCheck(\"name\", \"string\", name)\n    addUserIds && typeCheckArr(\"addUserIds\", \"string\", addUserIds)\n    customData && typeCheck(\"customData\", \"object\", customData)\n    return this.serverInstanceV3\n      .request({\n        method: \"POST\",\n        path: \"/rooms\",\n        json: {\n          created_by_id: this.id,\n          name,\n          private: !!rest.private, // private is a reserved word in strict mode!\n          user_ids: addUserIds,\n          custom_data: customData,\n        },\n      })\n      .then(res => this.roomStore.set(parseBasicRoom(JSON.parse(res))))\n      .catch(err => {\n        this.logger.warn(\"error creating room:\", err)\n        throw err\n      })\n  }\n\n  getJoinableRooms() {\n    return this.serverInstanceV3\n      .request({\n        method: \"GET\",\n        path: `/users/${this.encodedId}/rooms?joinable=true`,\n      })\n      .then(\n        pipe(\n          JSON.parse,\n          map(parseBasicRoom),\n        ),\n      )\n      .catch(err => {\n        this.logger.warn(\"error getting joinable rooms:\", err)\n        throw err\n      })\n  }\n\n  joinRoom({ roomId } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    if (this.isMemberOf(roomId)) {\n      return this.roomStore.get(roomId)\n    }\n    return this.serverInstanceV3\n      .request({\n        method: \"POST\",\n        path: `/users/${this.encodedId}/rooms/${encodeURIComponent(\n          roomId,\n        )}/join`,\n      })\n      .then(res => this.roomStore.set(parseBasicRoom(JSON.parse(res))))\n      .catch(err => {\n        this.logger.warn(`error joining room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  leaveRoom({ roomId } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    return this.roomStore\n      .get(roomId)\n      .then(room =>\n        this.serverInstanceV3\n          .request({\n            method: \"POST\",\n            path: `/users/${this.encodedId}/rooms/${encodeURIComponent(\n              roomId,\n            )}/leave`,\n          })\n          .then(() => room),\n      )\n      .catch(err => {\n        this.logger.warn(`error leaving room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  addUserToRoom({ userId, roomId } = {}) {\n    typeCheck(\"userId\", \"string\", userId)\n    typeCheck(\"roomId\", \"string\", roomId)\n    return this.serverInstanceV3\n      .request({\n        method: \"PUT\",\n        path: `/rooms/${encodeURIComponent(roomId)}/users/add`,\n        json: {\n          user_ids: [userId],\n        },\n      })\n      .then(() => this.roomStore.addUserToRoom(roomId, userId))\n      .catch(err => {\n        this.logger.warn(`error adding user ${userId} to room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  removeUserFromRoom({ userId, roomId } = {}) {\n    typeCheck(\"userId\", \"string\", userId)\n    typeCheck(\"roomId\", \"string\", roomId)\n    return this.serverInstanceV3\n      .request({\n        method: \"PUT\",\n        path: `/rooms/${encodeURIComponent(roomId)}/users/remove`,\n        json: {\n          user_ids: [userId],\n        },\n      })\n      .then(() => this.roomStore.removeUserFromRoom(roomId, userId))\n      .catch(err => {\n        this.logger.warn(\n          `error removing user ${userId} from room ${roomId}:`,\n          err,\n        )\n        throw err\n      })\n  }\n\n  sendMessage({ text, roomId, attachment } = {}) {\n    typeCheck(\"text\", \"string\", text)\n    typeCheck(\"roomId\", \"string\", roomId)\n    return new Promise((resolve, reject) => {\n      if (attachment !== undefined && isDataAttachment(attachment)) {\n        resolve(this.uploadDataAttachment(roomId, attachment))\n      } else if (attachment !== undefined && isLinkAttachment(attachment)) {\n        resolve({ resource_link: attachment.link, type: attachment.type })\n      } else if (attachment !== undefined) {\n        reject(new TypeError(\"attachment was malformed\"))\n      } else {\n        resolve()\n      }\n    })\n      .then(attachment =>\n        this.serverInstanceV2.request({\n          method: \"POST\",\n          path: `/rooms/${encodeURIComponent(roomId)}/messages`,\n          json: { text, attachment },\n        }),\n      )\n      .then(\n        pipe(\n          JSON.parse,\n          prop(\"message_id\"),\n        ),\n      )\n      .catch(err => {\n        this.logger.warn(`error sending message to room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  sendSimpleMessage({ roomId, text } = {}) {\n    return this.sendMultipartMessage({\n      roomId,\n      parts: [{ type: \"text/plain\", content: text }],\n    })\n  }\n\n  // TODO handle attachment parts\n  sendMultipartMessage({ roomId, parts } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    typeCheckArr(\"parts\", \"object\", parts)\n    if (parts.length === 0) {\n      return Promise.reject(\n        new TypeError(\"message must contain at least one part\"),\n      )\n    }\n    parts.forEach(part => {\n      typeCheck(\"part.type\", \"string\", part.type)\n      part.content && typeCheck(\"part.content\", \"string\", part.content)\n      part.url && typeCheck(\"part.url\", \"string\", part.url)\n    })\n    return this.serverInstanceV3\n      .request({\n        method: \"POST\",\n        path: `/rooms/${encodeURIComponent(roomId)}/messages`,\n        json: {\n          parts: parts.map(({ type, content, url }) => ({\n            type,\n            content,\n            url,\n          })),\n        },\n      })\n      .then(res => JSON.parse(res).message_id)\n      .catch(err => {\n        this.logger.warn(`error sending message to room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  fetchMessages({ roomId, initialId, limit, direction } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    initialId && typeCheck(\"initialId\", \"number\", initialId)\n    limit && typeCheck(\"limit\", \"number\", limit)\n    direction && checkOneOf(\"direction\", [\"older\", \"newer\"], direction)\n    return this.serverInstanceV2\n      .request({\n        method: \"GET\",\n        path: `/rooms/${encodeURIComponent(roomId)}/messages?${urlEncode({\n          initial_id: initialId,\n          limit,\n          direction,\n        })}`,\n      })\n      .then(res => {\n        const messages = JSON.parse(res).map(m =>\n          this.decorateMessage(parseBasicMessage(m, this.serverInstanceV3)),\n        )\n        return this.userStore\n          .fetchMissingUsers(uniq(map(prop(\"senderId\"), messages)))\n          .then(() => sort((x, y) => x.id - y.id, messages))\n      })\n      .catch(err => {\n        this.logger.warn(`error fetching messages from room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  subscribeToRoom({ roomId, hooks = {}, messageLimit, serverInstance } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    typeCheckObj(\"hooks\", \"function\", hooks)\n    messageLimit && typeCheck(\"messageLimit\", \"number\", messageLimit)\n    if (this.roomSubscriptions[roomId]) {\n      this.roomSubscriptions[roomId].cancel()\n    }\n    this.hooks.rooms[roomId] = hooks\n    const roomSubscription = new RoomSubscription({\n      serverInstance: serverInstance || this.serverInstanceV2,\n      connectionTimeout: this.connectionTimeout,\n      cursorStore: this.cursorStore,\n      cursorsInstance: this.cursorsInstance,\n      hooks: this.hooks,\n      logger: this.logger,\n      messageLimit,\n      roomId,\n      roomStore: this.roomStore,\n      typingIndicators: this.typingIndicators,\n      userId: this.id,\n      userStore: this.userStore,\n    })\n    this.roomSubscriptions[roomId] = roomSubscription\n    return this.joinRoom({ roomId })\n      .then(room => roomSubscription.connect().then(() => room))\n      .catch(err => {\n        this.logger.warn(`error subscribing to room ${roomId}:`, err)\n        throw err\n      })\n  }\n\n  subscribeToRoomMultipart(options = {}) {\n    return this.subscribeToRoom({\n      ...options,\n      serverInstance: this.serverInstanceV3,\n    })\n  }\n\n  updateRoom({ roomId, name, customData, ...rest } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    name && typeCheck(\"name\", \"string\", name)\n    rest.private && typeCheck(\"private\", \"boolean\", rest.private)\n    customData && typeCheck(\"customData\", \"object\", customData)\n    return this.serverInstanceV3\n      .request({\n        method: \"PUT\",\n        path: `/rooms/${encodeURIComponent(roomId)}`,\n        json: {\n          name,\n          private: rest.private, // private is a reserved word in strict mode!\n          custom_data: customData,\n        },\n      })\n      .then(() => {})\n      .catch(err => {\n        this.logger.warn(\"error updating room:\", err)\n        throw err\n      })\n  }\n\n  deleteRoom({ roomId } = {}) {\n    typeCheck(\"roomId\", \"string\", roomId)\n    return this.serverInstanceV3\n      .request({\n        method: \"DELETE\",\n        path: `/rooms/${encodeURIComponent(roomId)}`,\n      })\n      .then(() => {})\n      .catch(err => {\n        this.logger.warn(\"error deleting room:\", err)\n        throw err\n      })\n  }\n\n  /* internal */\n\n  setReadCursorRequest({ roomId, position, callbacks }) {\n    return this.cursorsInstance\n      .request({\n        method: \"PUT\",\n        path: `/cursors/0/rooms/${encodeURIComponent(roomId)}/users/${\n          this.encodedId\n        }`,\n        json: { position },\n      })\n      .then(() => map(x => x.resolve(), callbacks))\n      .catch(err => {\n        this.logger.warn(\"error setting cursor:\", err)\n        map(x => x.reject(err), callbacks)\n      })\n  }\n\n  uploadDataAttachment(roomId, { file, name }) {\n    // TODO polyfill FormData?\n    const body = new FormData() // eslint-disable-line no-undef\n    body.append(\"file\", file, name)\n    return this.filesInstance\n      .request({\n        method: \"POST\",\n        path: `/rooms/${encodeURIComponent(roomId)}/users/${\n          this.encodedId\n        }/files/${encodeURIComponent(name)}`,\n        body,\n      })\n      .then(JSON.parse)\n  }\n\n  isMemberOf(roomId) {\n    return contains(roomId, map(prop(\"id\"), this.rooms))\n  }\n\n  isSubscribedTo(roomId) {\n    return has(roomId, this.roomSubscriptions)\n  }\n\n  decorateMessage(basicMessage) {\n    return new Message(\n      basicMessage,\n      this.userStore,\n      this.roomStore,\n      this.serverInstanceV3,\n    )\n  }\n\n  setPropertiesFromBasicUser(basicUser) {\n    this.avatarURL = basicUser.avatarURL\n    this.createdAt = basicUser.createdAt\n    this.customData = basicUser.customData\n    this.name = basicUser.name\n    this.updatedAt = basicUser.updatedAt\n  }\n\n  establishUserSubscription() {\n    this.userSubscription = new UserSubscription({\n      hooks: this.hooks,\n      userId: this.id,\n      instance: this.serverInstanceV3,\n      roomStore: this.roomStore,\n      typingIndicators: this.typingIndicators,\n      logger: this.logger,\n      connectionTimeout: this.connectionTimeout,\n      currentUser: this,\n    })\n    return this.userSubscription\n      .connect()\n      .then(({ basicUser, basicRooms }) => {\n        this.setPropertiesFromBasicUser(basicUser)\n        return Promise.all(\n          basicRooms.map(basicRoom => this.roomStore.set(basicRoom)),\n        )\n      })\n      .catch(err => {\n        this.logger.error(\"error establishing user subscription:\", err)\n        throw err\n      })\n  }\n\n  establishCursorSubscription() {\n    this.cursorSubscription = new CursorSubscription({\n      onNewCursorHook: cursor => {\n        if (\n          this.hooks.global.onNewReadCursor &&\n          cursor.type === 0 &&\n          this.isMemberOf(cursor.roomId)\n        ) {\n          this.hooks.global.onNewReadCursor(cursor)\n        }\n      },\n      path: `/cursors/0/users/${this.encodedId}`,\n      cursorStore: this.cursorStore,\n      instance: this.cursorsInstance,\n      logger: this.logger,\n      connectionTimeout: this.connectionTimeout,\n    })\n    return this.cursorSubscription.connect().catch(err => {\n      this.logger.error(\"error establishing cursor subscription:\", err)\n      throw err\n    })\n  }\n\n  establishPresenceSubscription() {\n    this.presenceSubscription = new PresenceSubscription({\n      userId: this.id,\n      instance: this.presenceInstance,\n      logger: this.logger,\n      connectionTimeout: this.connectionTimeout,\n    })\n\n    return Promise.all([\n      this.userStore.fetchBasicUsers([this.id]),\n      this.subscribeToUserPresence(this.id),\n      this.presenceSubscription.connect().catch(err => {\n        this.logger.warn(\"error establishing presence subscription:\", err)\n        throw err\n      }),\n    ])\n  }\n\n  subscribeToUserPresence(userId) {\n    if (this.userPresenceSubscriptions[userId]) {\n      return Promise.resolve()\n    }\n\n    const userPresenceSub = new UserPresenceSubscription({\n      hooks: this.hooks,\n      userId: userId,\n      instance: this.presenceInstance,\n      userStore: this.userStore,\n      roomStore: this.roomStore,\n      presenceStore: this.presenceStore,\n      logger: this.logger,\n      connectionTimeout: this.connectionTimeout,\n    })\n\n    this.userPresenceSubscriptions[userId] = userPresenceSub\n    return userPresenceSub.connect()\n  }\n\n  disconnect() {\n    this.userSubscription.cancel()\n    this.presenceSubscription.cancel()\n    this.cursorSubscription.cancel()\n    forEachObjIndexed(sub => sub.cancel(), this.roomSubscriptions)\n    forEachObjIndexed(sub => sub.cancel(), this.userPresenceSubscriptions)\n  }\n}\n\nconst isDataAttachment = ({ file, name }) => {\n  if (file === undefined || name === undefined) {\n    return false\n  }\n  typeCheck(\"attachment.file\", \"object\", file)\n  typeCheck(\"attachment.name\", \"string\", name)\n  return true\n}\n\nconst isLinkAttachment = ({ link, type }) => {\n  if (link === undefined || type === undefined) {\n    return false\n  }\n  typeCheck(\"attachment.link\", \"string\", link)\n  typeCheck(\"attachment.type\", \"string\", type)\n  return true\n}\n","import { TokenProvider } from \"./token-provider\"\nimport { ChatManager } from \"./chat-manager\"\n\nexport default { TokenProvider, ChatManager }\n","import { BaseClient, HOST_BASE, Instance } from \"@pusher/platform\"\nimport { split } from \"ramda\"\n\nimport { CurrentUser } from \"./current-user\"\nimport { typeCheck, typeCheckObj } from \"./utils\"\nimport { DEFAULT_CONNECTION_TIMEOUT } from \"./constants\"\n\nimport { version } from \"../package.json\"\n\nexport class ChatManager {\n  constructor({ instanceLocator, tokenProvider, userId, ...options } = {}) {\n    typeCheck(\"instanceLocator\", \"string\", instanceLocator)\n    typeCheck(\"tokenProvider\", \"object\", tokenProvider)\n    typeCheck(\"tokenProvider.fetchToken\", \"function\", tokenProvider.fetchToken)\n    typeCheck(\"userId\", \"string\", userId)\n    const cluster = split(\":\", instanceLocator)[1]\n    if (cluster === undefined) {\n      throw new TypeError(\n        `expected instanceLocator to be of the format x:y:z, but was ${instanceLocator}`,\n      )\n    }\n    const baseClient =\n      options.baseClient ||\n      new BaseClient({\n        host: `${cluster}.${HOST_BASE}`,\n        logger: options.logger,\n        sdkProduct: \"chatkit\",\n        sdkVersion: version,\n      })\n    if (typeof tokenProvider.setUserId === \"function\") {\n      tokenProvider.setUserId(userId)\n    }\n    const instanceOptions = {\n      client: baseClient,\n      locator: instanceLocator,\n      logger: options.logger,\n      tokenProvider,\n    }\n    this.serverInstanceV2 = new Instance({\n      serviceName: \"chatkit\",\n      serviceVersion: \"v2\",\n      ...instanceOptions,\n    })\n    this.serverInstanceV3 = new Instance({\n      serviceName: \"chatkit\",\n      serviceVersion: \"v3\",\n      ...instanceOptions,\n    })\n    this.filesInstance = new Instance({\n      serviceName: \"chatkit_files\",\n      serviceVersion: \"v1\",\n      ...instanceOptions,\n    })\n    this.cursorsInstance = new Instance({\n      serviceName: \"chatkit_cursors\",\n      serviceVersion: \"v2\",\n      ...instanceOptions,\n    })\n    this.presenceInstance = new Instance({\n      serviceName: \"chatkit_presence\",\n      serviceVersion: \"v2\",\n      ...instanceOptions,\n    })\n    this.userId = userId\n    this.connectionTimeout =\n      options.connectionTimeout || DEFAULT_CONNECTION_TIMEOUT\n\n    this.connect = this.connect.bind(this)\n    this.disconnect = this.disconnect.bind(this)\n  }\n\n  connect(hooks = {}) {\n    typeCheckObj(\"hooks\", \"function\", hooks)\n    const currentUser = new CurrentUser({\n      hooks,\n      id: this.userId,\n      serverInstanceV2: this.serverInstanceV2,\n      serverInstanceV3: this.serverInstanceV3,\n      filesInstance: this.filesInstance,\n      cursorsInstance: this.cursorsInstance,\n      presenceInstance: this.presenceInstance,\n      connectionTimeout: this.connectionTimeout,\n    })\n    return Promise.all([\n      currentUser.establishUserSubscription(),\n      currentUser.establishCursorSubscription(),\n      currentUser.establishPresenceSubscription(),\n    ]).then(() => {\n      this.currentUser = currentUser\n      return currentUser\n    })\n  }\n\n  disconnect() {\n    if (this.currentUser) this.currentUser.disconnect()\n  }\n}\n"],"names":["factory","self","modules","installedModules","__webpack_require__","moduleId","exports","module","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","responseToHeadersObject","headerStr","headers","_i","headerPairs_1","split","length","headerPair","index","indexOf","key","substring","val","value","ErrorResponse","statusCode","info","this","fromXHR","xhr","errorInfo","responseText","JSON","parse","e","status","getAllResponseHeaders","NetworkError","error","ProtocolError","XhrReadyState","LogLevel","ConsoleLogger","threshold","groups","Array","hr","window","console","group","label","push","log","groupEnd","pop","verbose","items","arguments","VERBOSE","debug","DEBUG","INFO","warn","WARNING","ERROR","logFunction","level","_this","loggerSignature_1","forEach","item","errorAwareLog","loggerSignature","error_uri","errorDesc","error_description","EmptyLogger","network_1","createRetryStrategyOptionsOrDefault","options","initialTimeoutMillis","maxTimeoutMillis","limit","undefined","increaseTimeout","currentTimeout","Retry","waitTimeMillis","DoNotRetry","RetryResolution","logger","retryUnsafeRequests","currentRetryCount","increaseTimeoutFunction","currentBackoffMillis","attemptRetry","constructor","calculateMillisToRetry","parseInt","requestMethod","method","toUpperCase","__assign","assign","t","logger_1","request_1","resuming_subscription_1","retrying_subscription_1","subscribe_strategy_1","subscription_1","token_providing_subscription_1","http_1","websocket_1","transports_1","BaseClient","host","replace","websocketTransport","default","httpTransport","encrypted","sdkProduct","sdkVersion","sdkPlatform","navigator","product","request","tokenParams","tokenProvider","fetchToken","then","token","_a","optionsWithToken","makeRequest","subscribeResuming","path","listeners","retryStrategyOptions","initialEventId","completeListeners","replaceMissingListenersWithNoOps","subscribeStrategyListeners","subscribeStrategyListenersFromSubscriptionListeners","opened","createResumingStrategy","createTokenProvidingStrategy","createTransportStrategy","subscriptionStrategy","onEnd","onError","onEvent","onOpen","subHeaders","onSubscribe","onRetrying","infoHeaders","subscribeNonResuming","createRetryingStrategy","X-SDK-Language","X-SDK-Platform","X-SDK-Product","X-SDK-Version","executeNetworkRequest","catch","attachOnReadyStateChangeHandler","resolve","reject","onreadystatechange","readyState","response","createXhr","Promise","json","send","stringify","body","sendBody","sendRawRequest","XMLHttpRequest","open","url","setRequestHeader","retry_strategy_1","retryOptions","nextSubscribeStrategy","completeRetryOptions","retryResolution","ResumingSubscription","unsubscribe","state","onTransition","newState","OpeningSubscriptionState","lastEventId","underlyingSubscription","EndedSubscriptionState","ResumingSubscriptionState","event","eventId","OpenSubscriptionState","EndingSubscriptionState","timeout","executeSubscriptionOnce","subError","subLastEventId","errToResolve","errorResolution","setTimeout","executeNextSubscribeStrategy","FailedSubscriptionState","endError","openHeaders","clearTimeout","Error","enrichedRetryOptions","RetryingSubscription","RetryingSubscriptionState","TokenProvidingSubscription","InactiveState","ActiveState","subscribe","existingListeners","isTokenExpiredError","clearToken","putTokenIntoHeader","transport","HOST_BASE","base_client_1","host_base_1","instance_1","Instance","subListeners","HttpTransportState","HttpSubscription","gotEOS","lastNewlineIndex","UNOPENED","UNSENT","OPENED","HEADERS_RECEIVED","assertStateIsIn","OPENING","LOADING","onLoading","DONE","onDone","ENDED","abort","OPEN","ENDING","err","onChunk","newlineIndex","lastIndexOf","rawEvents","slice","rawEvents_1","rawEvent","data","onMessage","validStates","some","validState","expectedStates","map","join","actualState","message","verifyMessage","onEventMessage","onEOSMessage","eventMessage","id","isArray","eosMessage","HttpTransport","baseURL","requestOptions","createXHR","endpoint","setJSONHeaderIfAppropriate","jwt","WSReadyState","WsSubscriptions","subscriptions","add","subID","has","isEmpty","keys","remove","getAll","getAllAsArray","removeAll","WsSubscription","wsTransport","WebSocketTransport","webSocketPath","forcedClose","closedError","lastSentPingID","lastSubscriptionID","pendingSubscriptions","connect","tryReconnectIfNeeded","socket","Open","sendMessage","getMessage","subscription","WebSocket","onopen","subscribePending","pingInterval","setInterval","pongTimeout","now","Date","getTime","lastMessageReceivedTimestamp","close","onmessage","receiveMessage","onerror","onclose","allSubscriptions","concat","sub","onClose","bind","Closed","messageType","nonValidMessageError","validateMessage","shift","onPongMessage","onPingMessage","onCloseMessage","onOpenMessage","subscriptionListeners","closeMessage","receviedPongID","receviedPingID","locator","splitInstanceLocator","serviceName","serviceVersion","platformVersion","cluster","client","absPath","relativePath","_isPlaceholder","a","_curry1","fn","f1","apply","_curry2","f2","b","_b","_concat","set1","set2","idx","len1","len2","result","_arity","a0","a1","a2","a3","a4","a5","a6","a7","a8","a9","_curryN","received","combined","argsIdx","left","combinedIdx","curryN","_curry3","f3","_c","toString","_dispatchable","methodNames","xf","args","obj","_isArray","_isTransformer","transducer","init","max","_map","functor","len","_isString","x","_isArrayLike","nodeType","XWrap","f","acc","_xwrap","thisObj","_iterableReduce","iter","step","next","done","_methodReduce","methodName","symIterator","Symbol","iterator","_reduce","list","_arrayReduce","reduce","TypeError","XMap","_xfBase","input","_xmap","_has","prop","hasEnumBug","propertyIsEnumerable","nonEnumerableProps","hasArgsEnumBug","contains","nIdx","ks","checkArgsLength","_isArguments","paths","append","el","values","props","vals","type","_pipe","g","_checkForMethod","methodname","fromIndex","toIndex","tail","Infinity","pipe","reverse","compose","_arrayFromIterator","_containsWith","pred","identical","_uniqContentEquals","aIterator","bIterator","stackA","stackB","eq","_equals","aItem","match","typeA","equals","String","valueOf","source","global","ignoreCase","multiline","sticky","unicode","size","entries","keysA","extendedStackA","extendedStackB","_contains","inf","_indexOf","_quote","pad","_toISOString","toISOString","getUTCFullYear","getUTCMonth","getUTCDate","getUTCHours","getUTCMinutes","getUTCSeconds","getUTCMilliseconds","toFixed","XFilter","filter","filterable","_filter","_toString","seen","recur","y","xs","mapPairs","k","sort","test","isNaN","NaN","repr","difference","first","second","out","firstLen","forEachObjIndexed","keyList","_identity","identity","_Set","_nativeSet","Set","_items","hasOrAdd","shouldAdd","set","prevSize","bIdx","uniq","appliedItem","uniqBy","invoker","arity","target","comparator","toPairs","pairs","ws","trim","urlEncode","v","encodeURIComponent","typeCheck","expectedType","typeCheckArr","arr","typeCheckObj","unixSeconds","Math","floor","TokenProvider","queryParams","fetchFreshToken","cacheIsStale","cache","clearCache","setUserId","req","expiresIn","cachedToken","user_id","userId","grant_type","res","access_token","expires_in","_this2","cacheExpiresAt","parseBasicRoom","created_at","created_by_id","private","updated_at","custom_data","deleted_at","parseBasicUser","avatar_url","parseBasicMessage","basicMessage","room_id","parts","parseMessagePart","text","attachment","parseMessageAttachment","parseBasicCursor","position","cursor_type","resource_link","content","download_url","expiration","User","basicUser","presenceStore","avatarURL","createdAt","customData","updatedAt","UserStore","instance","reqs","onSetHooks","users","fetchMissingUsers","fetchBasicUsers","snapshot","getSync","decorate","hook","userIds","missing","u","missingNotInProgress","all","separator","encodedPairs","_this3","user","Room","basicRoom","userStore","isSubscribedTo","createdByUserId","deletedAt","isPrivate","other","RoomStore","rooms","setSync","popSync","addUserToRoom","removeUserFromRoom","updateSync","update","fetchBasicRoom","roomId","room","updates","Cursor","basicCursor","roomStore","CursorStore","cursors","fetchBasicCursor","DEFAULT_CONNECTION_TIMEOUT","TypingIndicators","hooks","lastSentRequests","timers","sendThrottledRequest","onIsTyping","onStarted","onStopped","sent","TYPING_INDICATOR_TTL","typingRequestSent","onUserStartedTyping","onUserStoppedTyping","UserSubscription","roomSubscriptions","connectionTimeout","currentUser","cancel","onInitialState","onAddedToRoom","onRemovedFromRoom","onRoomUpdated","onRoomDeleted","onSubscriptionEstablished","initialState","event_name","userData","current_user","roomsData","basicRooms","established","setPropertiesFromBasicUser","existingRoom","r","roomData","_this4","_this5","PresenceSubscription","UserPresenceSubscription","onPresenceState","previous","current","includes","parsePresence","onPresenceChanged","pair","CursorSubscription","onNewCursorHook","cursorStore","onNewCursor","basicCursors","existingCursor","cursor","Attachment","basicAttachment","_id","_downloadURL","downloadURL","_expiration","_roomId","_instance","urlExpiry","_fetchNewDownloadURL","Message","senderId","partType","payload","MessageSubscription","messageLimit","typingIndicators","messageBuffer","onMessageHook","flushBuffer","pending","ready","MembershipSubscription","onUserJoinedRoomHook","onUserLeftRoomHook","onUserJoined","onUserLeft","user_ids","RoomSubscription","buffer","messageSub","serverInstance","bufferWhileConnecting","cursorSub","cursorsInstance","onNewReadCursor","membershipSub","onUserJoinedRoom","onUserLeftRoom","cancelled","connected","CurrentUser","serverInstanceV2","serverInstanceV3","filesInstance","presenceInstance","encodedId","subscribeToUserPresence","readCursorBuffer","userPresenceSubscriptions","setReadCursor","readCursor","isTypingIn","createRoom","getJoinableRooms","joinRoom","leaveRoom","sendSimpleMessage","sendMultipartMessage","fetchMessages","subscribeToRoom","subscribeToRoomMultipart","updateRoom","deleteRoom","setReadCursorRequest","uploadDataAttachment","isMemberOf","decorateMessage","establishUserSubscription","establishCursorSubscription","establishPresenceSubscription","disconnect","callbacks","addUserIds","rest","_this6","_this7","_this8","isDataAttachment","_this9","isLinkAttachment","link","part","message_id","initialId","direction","checkOneOf","messages","_this11","roomSubscription","file","FormData","userSubscription","_this16","cursorSubscription","_this17","presenceSubscription","userPresenceSub","ChatManager","instanceLocator","baseClient","version","instanceOptions"],"mappings":"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"}